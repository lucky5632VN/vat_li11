{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/ui/sci-fi-lab.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Activity, Power, Settings, Cpu } from 'lucide-react';\r\n\r\n// --- 1. GLOBAL LAYOUT (NỀN PHÒNG THÍ NGHIỆM) ---\r\nexport const LabLayout = ({ children }: { children: React.ReactNode }) => {\r\n  return (\r\n    <div className=\"min-h-screen bg-[#02040a] text-cyan-50 font-sans selection:bg-cyan-500/30 selection:text-cyan-200 overflow-x-hidden relative\">\r\n      \r\n      {/* Background Grid - Lưới tọa độ */}\r\n      <div className=\"fixed inset-0 z-0 pointer-events-none opacity-20\" \r\n           style={{\r\n             backgroundImage: 'linear-gradient(rgba(6, 182, 212, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(6, 182, 212, 0.1) 1px, transparent 1px)',\r\n             backgroundSize: '40px 40px',\r\n             maskImage: 'radial-gradient(circle at center, black 40%, transparent 100%)' \r\n           }}>\r\n      </div>\r\n      \r\n      {/* Ambient Glow - Ánh sáng môi trường */}\r\n      <div className=\"fixed top-[-20%] left-[-10%] w-[50%] h-[50%] bg-cyan-900/10 rounded-full blur-[120px] pointer-events-none\"></div>\r\n      <div className=\"fixed bottom-[-20%] right-[-10%] w-[50%] h-[50%] bg-blue-900/10 rounded-full blur-[120px] pointer-events-none\"></div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"relative z-10 max-w-[1800px] mx-auto p-4 md:p-6 flex flex-col h-screen\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// --- 2. HOLO CARD (KHUNG KÍNH MỜ) ---\r\nexport const HoloCard = ({ children, className = \"\", title, icon: Icon, active = false }: { children: React.ReactNode, className?: string, title?: string, icon?: any, active?: boolean }) => (\r\n  <div className={`\r\n    relative backdrop-blur-md rounded-xl border transition-all duration-300 group\r\n    ${active \r\n      ? 'bg-cyan-950/30 border-cyan-500/50 shadow-[0_0_15px_rgba(6,182,212,0.15)]' \r\n      : 'bg-[#0a0f1c]/60 border-slate-800/60 hover:border-cyan-500/30 hover:bg-[#0f1629]/60'}\r\n    ${className}\r\n  `}>\r\n    {/* Decorative Corners */}\r\n    <div className=\"absolute top-0 left-0 w-2 h-2 border-t border-l border-cyan-500/50 rounded-tl opacity-50\"></div>\r\n    <div className=\"absolute top-0 right-0 w-2 h-2 border-t border-r border-cyan-500/50 rounded-tr opacity-50\"></div>\r\n    <div className=\"absolute bottom-0 left-0 w-2 h-2 border-b border-l border-cyan-500/50 rounded-bl opacity-50\"></div>\r\n    <div className=\"absolute bottom-0 right-0 w-2 h-2 border-b border-r border-cyan-500/50 rounded-br opacity-50\"></div>\r\n\r\n    {title && (\r\n      <div className={`px-4 py-3 border-b flex items-center gap-2 ${active ? 'border-cyan-500/30 bg-cyan-900/20' : 'border-slate-800/50 bg-slate-900/20'}`}>\r\n        {Icon && <Icon size={16} className={active ? 'text-cyan-400' : 'text-slate-500'} />}\r\n        <span className={`text-xs font-bold uppercase tracking-widest ${active ? 'text-cyan-300' : 'text-slate-400'}`}>\r\n          {title}\r\n        </span>\r\n      </div>\r\n    )}\r\n    <div className=\"p-4\">\r\n      {children}\r\n    </div>\r\n  </div>\r\n);\r\n\r\n// --- 3. MONITOR SCREEN (MÀN HÌNH HIỂN THỊ) ---\r\n// Dùng cái này bao quanh <canvas>\r\nexport const MonitorScreen = ({ children, label = \"SIMULATION VIEW\" }: { children: React.ReactNode, label?: string }) => (\r\n  <div className=\"relative rounded-lg overflow-hidden border border-slate-700 bg-black shadow-inner\">\r\n    {/* Scanline Effect */}\r\n    <div className=\"absolute inset-0 z-10 pointer-events-none opacity-10 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_2px,3px_100%]\"></div>\r\n    \r\n    {/* Screen Glare (bóng kính) */}\r\n    <div className=\"absolute inset-0 z-20 pointer-events-none bg-gradient-to-br from-white/5 to-transparent opacity-30\"></div>\r\n\r\n    {/* Header nhỏ bên trong màn hình */}\r\n    <div className=\"absolute top-3 left-3 z-30 flex items-center gap-2 px-2 py-1 bg-black/60 backdrop-blur rounded border border-white/10\">\r\n      <div className=\"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse\"></div>\r\n      <span className=\"text-[10px] font-mono text-green-500 tracking-wider\">{label}</span>\r\n    </div>\r\n\r\n    {children}\r\n  </div>\r\n);\r\n\r\n// --- 4. NEON BUTTON ---\r\nexport const NeonButton = ({ children, onClick, active = false, variant = 'cyan', className=\"\" }: any) => {\r\n  const colors = {\r\n    cyan: active ? \"bg-cyan-500/20 text-cyan-300 border-cyan-500 shadow-[0_0_10px_rgba(6,182,212,0.3)]\" : \"border-slate-700 text-slate-400 hover:text-cyan-400 hover:border-cyan-500/50\",\r\n    amber: active ? \"bg-amber-500/20 text-amber-300 border-amber-500 shadow-[0_0_10px_rgba(245,158,11,0.3)]\" : \"border-slate-700 text-slate-400 hover:text-amber-400 hover:border-amber-500/50\",\r\n    red: active ? \"bg-red-500/20 text-red-300 border-red-500 shadow-[0_0_10px_rgba(239,68,68,0.3)]\" : \"border-slate-700 text-slate-400 hover:text-red-400 hover:border-red-500/50\",\r\n  };\r\n  \r\n  return (\r\n    <button \r\n      onClick={onClick}\r\n      className={`\r\n        relative px-4 py-2 rounded border font-mono text-sm font-bold uppercase tracking-wider transition-all duration-200\r\n        active:scale-95 flex items-center justify-center gap-2\r\n        ${colors[variant as keyof typeof colors]}\r\n        ${className}\r\n      `}\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n};\r\n\r\n// --- 5. DATA READOUT (HIỂN THỊ SỐ LIỆU) ---\r\nexport const DataReadout = ({ label, value, unit, color=\"text-cyan-400\" }: any) => (\r\n  <div className=\"flex flex-col border-l-2 border-slate-800 pl-3\">\r\n    <span className=\"text-[10px] text-slate-500 uppercase font-semibold mb-0.5\">{label}</span>\r\n    <div className=\"flex items-baseline gap-1\">\r\n      <span className={`text-xl font-mono font-bold leading-none ${color}`}>{value}</span>\r\n      <span className=\"text-xs text-slate-600 font-mono\">{unit}</span>\r\n    </div>\r\n  </div>\r\n);"],"names":[],"mappings":";;;;;;;;;;;;;;AAIO,MAAM,YAAY,CAAC,EAAE,QAAQ,EAAiC;IACnE,qBACE,8OAAC;QAAI,WAAU;;0BAGb,8OAAC;gBAAI,WAAU;gBACV,OAAO;oBACL,iBAAiB;oBACjB,gBAAgB;oBAChB,WAAW;gBACb;;;;;;0BAIL,8OAAC;gBAAI,WAAU;;;;;;0BACf,8OAAC;gBAAI,WAAU;;;;;;0BAGf,8OAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAIT;AAGO,MAAM,WAAW,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,MAAM,IAAI,EAAE,SAAS,KAAK,EAAmG,iBACvL,8OAAC;QAAI,WAAW,CAAC;;IAEf,EAAE,SACE,6EACA,qFAAqF;IACzF,EAAE,UAAU;EACd,CAAC;;0BAEC,8OAAC;gBAAI,WAAU;;;;;;0BACf,8OAAC;gBAAI,WAAU;;;;;;0BACf,8OAAC;gBAAI,WAAU;;;;;;0BACf,8OAAC;gBAAI,WAAU;;;;;;YAEd,uBACC,8OAAC;gBAAI,WAAW,CAAC,2CAA2C,EAAE,SAAS,sCAAsC,uCAAuC;;oBACjJ,sBAAQ,8OAAC;wBAAK,MAAM;wBAAI,WAAW,SAAS,kBAAkB;;;;;;kCAC/D,8OAAC;wBAAK,WAAW,CAAC,4CAA4C,EAAE,SAAS,kBAAkB,kBAAkB;kCAC1G;;;;;;;;;;;;0BAIP,8OAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAOA,MAAM,gBAAgB,CAAC,EAAE,QAAQ,EAAE,QAAQ,iBAAiB,EAAiD,iBAClH,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;;;;;0BAGf,8OAAC;gBAAI,WAAU;;;;;;0BAGf,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAK,WAAU;kCAAuD;;;;;;;;;;;;YAGxE;;;;;;;AAKE,MAAM,aAAa,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,UAAU,MAAM,EAAE,YAAU,EAAE,EAAO;IACnG,MAAM,SAAS;QACb,MAAM,SAAS,uFAAuF;QACtG,OAAO,SAAS,2FAA2F;QAC3G,KAAK,SAAS,oFAAoF;IACpG;IAEA,qBACE,8OAAC;QACC,SAAS;QACT,WAAW,CAAC;;;QAGV,EAAE,MAAM,CAAC,QAA+B,CAAC;QACzC,EAAE,UAAU;MACd,CAAC;kBAEA;;;;;;AAGP;AAGO,MAAM,cAAc,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,QAAM,eAAe,EAAO,iBAC5E,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAK,WAAU;0BAA6D;;;;;;0BAC7E,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAW,CAAC,yCAAyC,EAAE,OAAO;kCAAG;;;;;;kCACvE,8OAAC;wBAAK,WAAU;kCAAoC"}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/physics-intro.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useState, useEffect } from \"react\"\r\nimport {\r\n  Activity, Waves, Mic, Anchor, Aperture, Infinity, TrendingDown, Zap,\r\n  Database, Cpu, ArrowUpRight, Box, Trash2, Atom, Terminal, FileCode\r\n} from \"lucide-react\"\r\n// Sửa đường dẫn import cho đúng cấu trúc thư mục\r\nimport { HoloCard, NeonButton } from \"../ui/sci-fi-lab\"\r\n\r\nconst EXPERIMENTS = [\r\n  {\r\n    id: \"spring-oscillator\",\r\n    title: \"Con lắc lò xo\",\r\n    icon: Activity,\r\n    code: \"EXP-01\",\r\n    desc: \"Mô phỏng dao động điều hòa lò xo ngang/dọc.\"\r\n  },\r\n  {\r\n    id: \"simple-pendulum\",\r\n    title: \"Con lắc đơn\",\r\n    icon: Anchor,\r\n    code: \"EXP-02\",\r\n    desc: \"Khảo sát chu kỳ và quỹ đạo con lắc đơn.\"\r\n  },\r\n  {\r\n    id: \"damped-oscillation\",\r\n    title: \"Dao động tắt dần\",\r\n    icon: TrendingDown,\r\n    code: \"EXP-03\",\r\n    desc: \"Sự suy giảm năng lượng trong môi trường cản.\"\r\n  },\r\n  {\r\n    id: \"harmonic-oscillation\",\r\n    title: \"Dao động điều hòa\",\r\n    icon: Zap,\r\n    code: \"EXP-04\",\r\n    desc: \"Mối liên hệ chuyển động tròn đều.\"\r\n  },\r\n  {\r\n    id: \"mechanical-waves\",\r\n    title: \"Sóng cơ\",\r\n    icon: Waves,\r\n    code: \"EXP-05\",\r\n    desc: \"Truyền sóng ngang và dọc trong môi trường.\"\r\n  },\r\n  {\r\n    id: \"sound-waves\",\r\n    title: \"Sóng âm\",\r\n    icon: Mic,\r\n    code: \"EXP-06\",\r\n    desc: \"Phân tích tần số và biên độ âm thanh.\"\r\n  },\r\n  {\r\n    id: \"wave-interference\",\r\n    title: \"Giao thoa sóng\",\r\n    icon: Aperture,\r\n    code: \"EXP-07\",\r\n    desc: \"Hiện tượng giao thoa hai nguồn kết hợp.\"\r\n  },\r\n  {\r\n    id: \"standing-waves\",\r\n    title: \"Sóng dừng\",\r\n    icon: Infinity,\r\n    code: \"EXP-08\",\r\n    desc: \"Bụng sóng và nút sóng trên dây.\"\r\n  },\r\n  {\r\n    id: \"sound-speed\",\r\n    title: \"Đo tốc độ truyền âm\",\r\n    icon: Mic,\r\n    code: \"EXP-09\",\r\n    desc: \"Đo tốc độ âm bằng cột khí cộng hưởng.\"\r\n  }\r\n]\r\n\r\nexport default function PhysicsIntro({ onSelectExperiment }: { onSelectExperiment?: (id: string) => void }) {\r\n  const [customModules, setCustomModules] = useState<any[]>([])\r\n\r\n  useEffect(() => {\r\n    fetch('/api/modules')\r\n      .then(res => res.json())\r\n      .then(data => setCustomModules(data))\r\n      .catch(err => console.error(err))\r\n  }, [])\r\n\r\n  const handleDelete = async (e: React.MouseEvent, id: string) => {\r\n    e.stopPropagation()\r\n    if (!confirm(\"Bạn có chắc muốn xóa module này không?\")) return\r\n\r\n    try {\r\n      const res = await fetch('/api/modules', {\r\n        method: 'DELETE',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ id })\r\n      })\r\n      if (res.ok) {\r\n        setCustomModules(prev => prev.filter(m => m.id !== id))\r\n      } else {\r\n        alert(\"Xóa thất bại\")\r\n      }\r\n    } catch (err) {\r\n      console.error(err)\r\n      alert(\"Có lỗi xảy ra\")\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Hero Section */}\r\n      <div className=\"relative rounded-2xl overflow-hidden border border-slate-800 bg-slate-900/50 p-8 md:p-12\">\r\n        <div className=\"absolute top-0 right-0 p-4 opacity-20\">\r\n          <Cpu size={200} className=\"text-cyan-500\" />\r\n        </div>\r\n\r\n        <div className=\"relative z-10 max-w-2xl\">\r\n          <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-950/50 border border-cyan-800 text-cyan-400 text-xs font-bold uppercase tracking-wider mb-4\">\r\n            <span className=\"w-2 h-2 bg-cyan-400 rounded-full animate-pulse\"></span>\r\n            Phòng thí nghiệm ảo v2.0\r\n          </div>\r\n          <h1 className=\"text-4xl md:text-5xl font-bold text-white mb-4 tracking-tight\">\r\n            Chào mừng đến với <br />\r\n            <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500\">PHÒNG THÍ NGHIỆM VẬT LÝ</span>\r\n          </h1>\r\n          <p className=\"text-slate-400 text-lg mb-8 leading-relaxed\">\r\n            Hệ thống mô phỏng tương tác cao cấp dành cho Vật lý lớp 11. <br />\r\n            Truy cập dữ liệu thời gian thực, đồ thị năng lượng và các tham số vật lý chính xác.\r\n          </p>\r\n\r\n          <div className=\"flex gap-4\">\r\n            <NeonButton onClick={() => onSelectExperiment && onSelectExperiment('harmonic-oscillation')} active={true}>\r\n              Bắt đầu ngay\r\n            </NeonButton>\r\n            <NeonButton variant=\"amber\" onClick={() => window.open('https://github.com', '_blank')}>\r\n              Tài liệu hướng dẫn\r\n            </NeonButton>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Grid Dashboard */}\r\n      <div>\r\n        <div className=\"flex items-center gap-2 mb-6 border-b border-slate-800 pb-2\">\r\n          <Database size={20} className=\"text-cyan-500\" />\r\n          <h2 className=\"text-lg font-bold text-slate-200 uppercase tracking-widest\">Danh mục thí nghiệm</h2>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n          {EXPERIMENTS.map((exp) => (\r\n            <HoloCard key={exp.id} className=\"h-full flex flex-col hover:-translate-y-1 hover:shadow-lg transition-transform\">\r\n              <div className=\"flex justify-between items-start mb-4\">\r\n                <div className=\"p-3 rounded bg-slate-900/50 border border-slate-700 text-cyan-400 group-hover:text-cyan-300 group-hover:border-cyan-500/50 transition-colors\">\r\n                  <exp.icon size={24} />\r\n                </div>\r\n                <span className=\"text-[10px] font-mono text-slate-600 font-bold border border-slate-800 px-1.5 py-0.5 rounded group-hover:text-cyan-500 group-hover:border-cyan-900\">\r\n                  {exp.code}\r\n                </span>\r\n              </div>\r\n\r\n              <h3 className=\"text-lg font-bold text-slate-200 mb-2 group-hover:text-cyan-400\">{exp.title}</h3>\r\n              <p className=\"text-sm text-slate-500 leading-relaxed mb-6 flex-1\">{exp.desc}</p>\r\n\r\n              <button\r\n                onClick={() => onSelectExperiment && onSelectExperiment(exp.id)}\r\n                className=\"w-full py-2 rounded border border-slate-700 text-xs font-bold uppercase tracking-widest text-slate-400 hover:bg-cyan-500 hover:text-white hover:border-cyan-500 transition-all flex items-center justify-center gap-2 group-hover:bg-slate-800\"\r\n              >\r\n                Truy cập <ArrowUpRight size={14} />\r\n              </button>\r\n            </HoloCard>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Custom Modules Section */}\r\n\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 613, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/ui/control-panel.tsx"],"sourcesContent":["import type React from \"react\"\ninterface ControlPanelProps {\n  title: string\n  children: React.ReactNode\n}\n\nexport default function ControlPanel({ title, children }: ControlPanelProps) {\n  return (\n    <div className=\"bg-[#16213e] rounded-lg p-4 border border-cyan-900/50\">\n      <h3 className=\"text-cyan-400 font-semibold mb-3\">{title}</h3>\n      {children}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;;AAMe,SAAS,aAAa,EAAE,KAAK,EAAE,QAAQ,EAAqB;IACzE,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAAoC;;;;;;YACjD;;;;;;;AAGP"}},
    {"offset": {"line": 643, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/hooks/use-spring-physics.ts"],"sourcesContent":["import { useState, useRef, useCallback } from \"react\"\r\n\r\nexport interface SpringParams {\r\n    mass: number // kg\r\n    k: number // N/m spring constant\r\n    amplitude: number // cm (converted effectively to initial displacement)\r\n    phase: number // radians\r\n}\r\n\r\nexport interface PhysicsState {\r\n    t: number\r\n    x: number // cm\r\n    v: number // cm/s\r\n    a: number // cm/s^2\r\n    force: number // N\r\n    wd: number // Joules\r\n    wt: number // Joules\r\n    wTotal: number // Joules\r\n}\r\n\r\nexport const useSpringPhysics = (initialParams: SpringParams) => {\r\n    const [isPlaying, setIsPlaying] = useState(false)\r\n    const [params, setParams] = useState(initialParams)\r\n    const [time, setTime] = useState(0)\r\n\r\n    // Mutable refs for high-frequency updates without re-renders\r\n    const timeRef = useRef(0)\r\n    const historyRef = useRef<PhysicsState[]>([])\r\n\r\n    // Derived constants\r\n    const omega = Math.sqrt(params.k / params.mass)\r\n    const period = (2 * Math.PI) / omega\r\n    const frequency = omega / (2 * Math.PI)\r\n    const vmax = omega * params.amplitude\r\n    const amax = omega * omega * params.amplitude\r\n    const deltaL0 = (params.mass * 9.8) / params.k // Static extension (m)\r\n\r\n    const calculateState = useCallback(\r\n        (t: number): PhysicsState => {\r\n            // x = A cos(wt + phi)\r\n            const x = params.amplitude * Math.cos(omega * t + params.phase)\r\n            const v = -params.amplitude * omega * Math.sin(omega * t + params.phase)\r\n            const a = -params.amplitude * omega * omega * Math.cos(omega * t + params.phase)\r\n\r\n            // Force F = -kx (Hooke's law relative to equilibrium)\r\n            // Note: x is in cm, so we divide by 100 for Force calc (N)\r\n            const force = -params.k * (x / 100)\r\n\r\n            // Energy\r\n            const x_m = x / 100\r\n            const v_m = v / 100\r\n            const wt = 0.5 * params.k * x_m * x_m\r\n            const wd = 0.5 * params.mass * v_m * v_m\r\n            const wTotal = wt + wd\r\n\r\n            return { t, x, v, a, force, wt, wd, wTotal }\r\n        },\r\n        [params, omega]\r\n    )\r\n\r\n    const step = useCallback((dt: number) => {\r\n        timeRef.current += dt\r\n        // Prevent negative time\r\n        if (timeRef.current < 0) timeRef.current = 0\r\n\r\n        const state = calculateState(timeRef.current)\r\n\r\n        // Update history\r\n        historyRef.current.push(state)\r\n        if (historyRef.current.length > 500) historyRef.current.shift()\r\n\r\n        // Sync React state for low-frequency UI updates if needed\r\n        // (For high-perf canvas, we usually read refs directly, but we setTime to trigger animation effects if needed)\r\n        setTime(timeRef.current)\r\n\r\n        return state\r\n    }, [calculateState])\r\n\r\n    const reset = useCallback(() => {\r\n        setIsPlaying(false)\r\n        timeRef.current = 0\r\n        setTime(0)\r\n        historyRef.current = []\r\n    }, [])\r\n\r\n    return {\r\n        params,\r\n        setParams,\r\n        isPlaying,\r\n        setIsPlaying,\r\n        time,\r\n        timeRef,\r\n        historyRef,\r\n        calculateState,\r\n        step,\r\n        reset,\r\n        derived: {\r\n            omega,\r\n            period,\r\n            frequency,\r\n            vmax,\r\n            amax,\r\n            deltaL0\r\n        }\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAoBO,MAAM,mBAAmB,CAAC;IAC7B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,6DAA6D;IAC7D,MAAM,UAAU,IAAA,+MAAM,EAAC;IACvB,MAAM,aAAa,IAAA,+MAAM,EAAiB,EAAE;IAE5C,oBAAoB;IACpB,MAAM,QAAQ,KAAK,IAAI,CAAC,OAAO,CAAC,GAAG,OAAO,IAAI;IAC9C,MAAM,SAAS,AAAC,IAAI,KAAK,EAAE,GAAI;IAC/B,MAAM,YAAY,QAAQ,CAAC,IAAI,KAAK,EAAE;IACtC,MAAM,OAAO,QAAQ,OAAO,SAAS;IACrC,MAAM,OAAO,QAAQ,QAAQ,OAAO,SAAS;IAC7C,MAAM,UAAU,AAAC,OAAO,IAAI,GAAG,MAAO,OAAO,CAAC,CAAC,uBAAuB;;IAEtE,MAAM,iBAAiB,IAAA,oNAAW,EAC9B,CAAC;QACG,sBAAsB;QACtB,MAAM,IAAI,OAAO,SAAS,GAAG,KAAK,GAAG,CAAC,QAAQ,IAAI,OAAO,KAAK;QAC9D,MAAM,IAAI,CAAC,OAAO,SAAS,GAAG,QAAQ,KAAK,GAAG,CAAC,QAAQ,IAAI,OAAO,KAAK;QACvE,MAAM,IAAI,CAAC,OAAO,SAAS,GAAG,QAAQ,QAAQ,KAAK,GAAG,CAAC,QAAQ,IAAI,OAAO,KAAK;QAE/E,sDAAsD;QACtD,2DAA2D;QAC3D,MAAM,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG;QAElC,SAAS;QACT,MAAM,MAAM,IAAI;QAChB,MAAM,MAAM,IAAI;QAChB,MAAM,KAAK,MAAM,OAAO,CAAC,GAAG,MAAM;QAClC,MAAM,KAAK,MAAM,OAAO,IAAI,GAAG,MAAM;QACrC,MAAM,SAAS,KAAK;QAEpB,OAAO;YAAE;YAAG;YAAG;YAAG;YAAG;YAAO;YAAI;YAAI;QAAO;IAC/C,GACA;QAAC;QAAQ;KAAM;IAGnB,MAAM,OAAO,IAAA,oNAAW,EAAC,CAAC;QACtB,QAAQ,OAAO,IAAI;QACnB,wBAAwB;QACxB,IAAI,QAAQ,OAAO,GAAG,GAAG,QAAQ,OAAO,GAAG;QAE3C,MAAM,QAAQ,eAAe,QAAQ,OAAO;QAE5C,iBAAiB;QACjB,WAAW,OAAO,CAAC,IAAI,CAAC;QACxB,IAAI,WAAW,OAAO,CAAC,MAAM,GAAG,KAAK,WAAW,OAAO,CAAC,KAAK;QAE7D,0DAA0D;QAC1D,+GAA+G;QAC/G,QAAQ,QAAQ,OAAO;QAEvB,OAAO;IACX,GAAG;QAAC;KAAe;IAEnB,MAAM,QAAQ,IAAA,oNAAW,EAAC;QACtB,aAAa;QACb,QAAQ,OAAO,GAAG;QAClB,QAAQ;QACR,WAAW,OAAO,GAAG,EAAE;IAC3B,GAAG,EAAE;IAEL,OAAO;QACH;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,SAAS;YACL;YACA;YACA;YACA;YACA;YACA;QACJ;IACJ;AACJ"}},
    {"offset": {"line": 738, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/hooks/use-canvas-scale.ts"],"sourcesContent":["\r\nimport { useEffect, useState, RefObject } from \"react\"\r\n\r\nexport const useCanvasScale = (containerRef: RefObject<HTMLDivElement | null>) => {\r\n    const [size, setSize] = useState({ width: 0, height: 0 })\r\n    const [pixelRatio, setPixelRatio] = useState(1)\r\n\r\n    useEffect(() => {\r\n        // Check if we are in a browser environment\r\n        if (typeof window === \"undefined\" || !containerRef.current) return\r\n\r\n        const updateSize = () => {\r\n            if (containerRef.current) {\r\n                const { clientWidth, clientHeight } = containerRef.current\r\n                setSize({ width: clientWidth, height: clientHeight })\r\n                setPixelRatio(window.devicePixelRatio || 1)\r\n            }\r\n        }\r\n\r\n        // Initial size\r\n        updateSize()\r\n\r\n        const resizeObserver = new ResizeObserver(() => {\r\n            updateSize()\r\n        })\r\n\r\n        resizeObserver.observe(containerRef.current)\r\n\r\n        return () => {\r\n            resizeObserver.disconnect()\r\n        }\r\n    }, [containerRef])\r\n\r\n    return { width: size.width, height: size.height, pixelRatio }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;;AAEO,MAAM,iBAAiB,CAAC;IAC3B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;QAAE,OAAO;QAAG,QAAQ;IAAE;IACvD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,IAAA,kNAAS,EAAC;QACN,2CAA2C;QAC3C,wCAA4D;;;QAE5D,MAAM;QAWN,MAAM;IASV,GAAG;QAAC;KAAa;IAEjB,OAAO;QAAE,OAAO,KAAK,KAAK;QAAE,QAAQ,KAAK,MAAM;QAAE;IAAW;AAChE"}},
    {"offset": {"line": 770, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/lib/canvas-utils.ts"],"sourcesContent":["\r\nexport const drawSpring = (\r\n    ctx: CanvasRenderingContext2D,\r\n    startX: number,\r\n    startY: number,\r\n    endX: number,\r\n    endY: number,\r\n    coils = 12,\r\n    width = 20,\r\n    strokeStyle = \"#cbd5e1\",\r\n    lineWidth = 2\r\n) => {\r\n    const dx = endX - startX\r\n    const dy = endY - startY\r\n    const len = Math.sqrt(dx * dx + dy * dy)\r\n    const angle = Math.atan2(dy, dx)\r\n\r\n    ctx.save()\r\n    ctx.translate(startX, startY)\r\n    ctx.rotate(angle)\r\n\r\n    ctx.strokeStyle = strokeStyle\r\n    ctx.lineWidth = lineWidth\r\n    ctx.lineCap = \"round\"\r\n    ctx.lineJoin = \"round\"\r\n\r\n    ctx.beginPath()\r\n    ctx.moveTo(0, 0)\r\n    ctx.lineTo(10, 0)\r\n\r\n    const step = (len - 20) / coils\r\n    for (let i = 0; i < coils; i++) {\r\n        const x = 10 + i * step\r\n        ctx.lineTo(x + step * 0.25, width)\r\n        ctx.lineTo(x + step * 0.75, -width)\r\n    }\r\n\r\n    ctx.lineTo(len - 10, 0)\r\n    ctx.lineTo(len, 0)\r\n\r\n    ctx.stroke()\r\n    ctx.restore()\r\n}\r\n\r\nexport const drawArrow = (\r\n    ctx: CanvasRenderingContext2D,\r\n    x: number,\r\n    y: number,\r\n    len: number,\r\n    color: string,\r\n    label: string = \"\",\r\n    direction: \"horizontal\" | \"vertical\" = \"horizontal\"\r\n) => {\r\n    if (Math.abs(len) < 2) return // Don't draw tiny arrows\r\n\r\n    ctx.save()\r\n    ctx.strokeStyle = color\r\n    ctx.fillStyle = color\r\n    ctx.lineWidth = 2\r\n\r\n    // Calculate end points based on direction\r\n    const endX = x + (direction === \"horizontal\" ? len : 0)\r\n    const endY = y + (direction === \"vertical\" ? len : 0)\r\n\r\n    // Determine angle for the arrow head\r\n    let angle = 0\r\n    if (direction === \"horizontal\") {\r\n        angle = len > 0 ? 0 : Math.PI;\r\n    } else {\r\n        angle = len > 0 ? Math.PI / 2 : -Math.PI / 2;\r\n    }\r\n\r\n    ctx.beginPath()\r\n    ctx.moveTo(x, y)\r\n    ctx.lineTo(endX, endY)\r\n    ctx.stroke()\r\n\r\n    // Draw arrow head\r\n    const headLen = 6\r\n    ctx.save()\r\n    ctx.translate(endX, endY)\r\n    ctx.rotate(angle)\r\n    ctx.beginPath()\r\n    ctx.moveTo(0, 0)\r\n    ctx.lineTo(-headLen, -headLen / 2)\r\n    ctx.lineTo(-headLen, headLen / 2)\r\n    ctx.lineTo(0, 0)\r\n    ctx.fill()\r\n    ctx.restore()\r\n\r\n    // Draw label\r\n    if (label) {\r\n        ctx.font = \"bold 12px sans-serif\"\r\n        ctx.textAlign = \"center\"\r\n        ctx.textBaseline = \"middle\"\r\n\r\n        let labelX = endX\r\n        let labelY = endY\r\n\r\n        if (direction === \"horizontal\") {\r\n            labelX += len > 0 ? 15 : -15\r\n        } else {\r\n            labelY += len > 0 ? 15 : -15\r\n        }\r\n\r\n        ctx.fillStyle = color\r\n        ctx.fillText(label, labelX, labelY)\r\n    }\r\n\r\n    ctx.restore()\r\n}\r\n\r\nexport const drawGrid = (ctx: CanvasRenderingContext2D, width: number, height: number, step = 40, color = \"#1e293b\") => {\r\n    ctx.save()\r\n    ctx.strokeStyle = color\r\n    ctx.lineWidth = 1\r\n    ctx.beginPath()\r\n    for (let i = 0; i < width; i += step) {\r\n        ctx.moveTo(i, 0)\r\n        ctx.lineTo(i, height)\r\n    }\r\n    for (let i = 0; i < height; i += step) {\r\n        ctx.moveTo(0, i)\r\n        ctx.lineTo(width, i)\r\n    }\r\n    ctx.stroke()\r\n    ctx.restore()\r\n}\r\n\r\nexport const clearCanvas = (ctx: CanvasRenderingContext2D) => {\r\n    const { width, height } = ctx.canvas;\r\n    ctx.clearRect(0, 0, width, height);\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 879, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/oscillator-view.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useRef, useEffect, useState, useCallback } from \"react\"\r\nimport { useCanvasScale } from \"@/hooks/use-canvas-scale\"\r\nimport { drawSpring, drawArrow } from \"@/lib/canvas-utils\"\r\nimport { SpringParams, PhysicsState } from \"@/hooks/use-spring-physics\"\r\n\r\ninterface OscillatorViewProps {\r\n    sysId: string\r\n    params: SpringParams\r\n    state: PhysicsState\r\n    derived: {\r\n        omega: number\r\n        period: number\r\n        frequency: number\r\n        vmax: number\r\n        amax: number\r\n        deltaL0: number\r\n    }\r\n    layout: \"horizontal\" | \"vertical\"\r\n    onParameterChange: (newParams: Partial<SpringParams>) => void\r\n    onInteractionStart: () => void\r\n    onInteractionEnd: () => void\r\n    label?: string\r\n    colorTheme?: string\r\n}\r\n\r\nexport default function OscillatorView({\r\n    sysId,\r\n    params,\r\n    state,\r\n    derived,\r\n    layout,\r\n    onParameterChange,\r\n    onInteractionStart,\r\n    onInteractionEnd,\r\n    label,\r\n    colorTheme = \"blue\"\r\n}: OscillatorViewProps) {\r\n    const containerRef = useRef<HTMLDivElement>(null)\r\n    const canvasRef = useRef<HTMLCanvasElement>(null)\r\n\r\n    const [isDragging, setIsDragging] = useState(false)\r\n    const [localTime, setLocalTime] = useState(0)\r\n\r\n    // Responsive Hooks\r\n    const { width, height, pixelRatio } = useCanvasScale(containerRef)\r\n\r\n    // Interaction Check\r\n    const checkInteraction = useCallback((clientX: number, clientY: number) => {\r\n        if (!canvasRef.current || !width || !height) return null\r\n\r\n        const rect = canvasRef.current.getBoundingClientRect()\r\n        const x = clientX - rect.left\r\n        const y = clientY - rect.top\r\n\r\n        let massX, massY\r\n\r\n        if (layout === \"horizontal\") {\r\n            massX = (width / 2) + state.x\r\n            massY = height / 2\r\n        } else {\r\n            massX = width / 2\r\n            massY = (height / 2) + state.x\r\n        }\r\n\r\n        const dist = Math.sqrt(Math.pow(x - massX, 2) + Math.pow(y - massY, 2))\r\n        if (dist < 40) return true\r\n        return false\r\n    }, [layout, width, height, state.x])\r\n\r\n    const handlePointerDown = (e: React.PointerEvent) => {\r\n        if (checkInteraction(e.clientX, e.clientY)) {\r\n            setIsDragging(true)\r\n            onInteractionStart() // Pause parent\r\n            e.currentTarget.setPointerCapture(e.pointerId)\r\n        }\r\n    }\r\n\r\n    const handlePointerMove = (e: React.PointerEvent) => {\r\n        if (!isDragging || !width || !height) return\r\n\r\n        const rect = canvasRef.current!.getBoundingClientRect()\r\n        const x = e.clientX - rect.left\r\n        const y = e.clientY - rect.top\r\n\r\n        let delta = 0\r\n        if (layout === \"horizontal\") {\r\n            const equilibriumX = width / 2\r\n            delta = x - equilibriumX\r\n        } else {\r\n            const equilibriumY = height / 2\r\n            delta = y - equilibriumY\r\n        }\r\n\r\n        const newAmp = Math.abs(delta)\r\n        const newPhase = delta >= 0 ? 0 : Math.PI\r\n\r\n        const maxAmp = layout === \"horizontal\" ? width / 2 - 20 : height / 2 - 20\r\n        const clampedAmp = Math.min(Math.max(newAmp, 0), maxAmp)\r\n\r\n        onParameterChange({ amplitude: clampedAmp, phase: newPhase })\r\n    }\r\n\r\n    const handlePointerUp = (e: React.PointerEvent) => {\r\n        setIsDragging(false)\r\n        onInteractionEnd()\r\n        e.currentTarget.releasePointerCapture(e.pointerId)\r\n    }\r\n\r\n    const draw = useCallback(\r\n        (ctx: CanvasRenderingContext2D) => {\r\n            const currWidth = width\r\n            const currHeight = height\r\n\r\n            ctx.clearRect(0, 0, currWidth, currHeight)\r\n\r\n            // Grid\r\n            ctx.strokeStyle = \"#1e293b\"\r\n            ctx.lineWidth = 1\r\n            ctx.beginPath()\r\n            for (let i = 0; i < currWidth; i += 40) {\r\n                ctx.moveTo(i, 0)\r\n                ctx.lineTo(i, currHeight)\r\n            }\r\n            for (let i = 0; i < currHeight; i += 40) {\r\n                ctx.moveTo(0, i)\r\n                ctx.lineTo(currWidth, i)\r\n            }\r\n            ctx.stroke()\r\n\r\n            const primaryColor = colorTheme === \"blue\" ? \"#3b82f6\" : \"#f97316\" // Orange for sys2\r\n            const strokeColor = colorTheme === \"blue\" ? \"#60a5fa\" : \"#fb923c\"\r\n\r\n            if (layout === \"horizontal\") {\r\n                const centerY = currHeight / 2\r\n                const wallX = 60\r\n                const equilibriumX = currWidth / 2\r\n                const massX = equilibriumX + state.x\r\n\r\n                // Wall\r\n                ctx.fillStyle = \"#64748b\"\r\n                ctx.fillRect(wallX - 10, centerY - 50, 10, 100)\r\n                ctx.strokeStyle = \"#475569\"\r\n                ctx.beginPath()\r\n                ctx.moveTo(wallX, centerY + 30)\r\n                ctx.lineTo(currWidth, centerY + 30)\r\n                ctx.stroke()\r\n\r\n                // Limits -A, +A\r\n                ctx.strokeStyle = \"rgba(250, 204, 21, 0.3)\"\r\n                ctx.setLineDash([5, 5])\r\n                ctx.beginPath()\r\n                ctx.moveTo(equilibriumX - params.amplitude, centerY - 60)\r\n                ctx.lineTo(equilibriumX - params.amplitude, centerY + 60)\r\n                ctx.moveTo(equilibriumX + params.amplitude, centerY - 60)\r\n                ctx.lineTo(equilibriumX + params.amplitude, centerY + 60)\r\n                ctx.stroke()\r\n                ctx.setLineDash([])\r\n\r\n                ctx.fillStyle = \"rgba(250, 204, 21, 0.7)\"\r\n                ctx.font = \"10px monospace\"\r\n                ctx.textAlign = \"left\"\r\n                ctx.fillText(\"-A\", equilibriumX - params.amplitude - 15, centerY - 65)\r\n                ctx.fillText(\"+A\", equilibriumX + params.amplitude - 5, centerY - 65)\r\n\r\n                // Equilibrium Line\r\n                ctx.strokeStyle = \"#4ade80\"\r\n                ctx.setLineDash([5, 5])\r\n                ctx.beginPath()\r\n                ctx.moveTo(equilibriumX, centerY - 70)\r\n                ctx.lineTo(equilibriumX, centerY + 70)\r\n                ctx.stroke()\r\n                ctx.setLineDash([])\r\n                ctx.fillStyle = \"#4ade80\"\r\n                ctx.textAlign = \"right\"\r\n                ctx.fillText(\"VTCB (O)\", equilibriumX - 10, centerY - 75)\r\n\r\n                // Draw Spring\r\n                ctx.strokeStyle = \"#cbd5e1\"\r\n                drawSpring(ctx, wallX, centerY, massX - 25, centerY, 15, 15)\r\n\r\n                // Draw Mass\r\n                ctx.fillStyle = isDragging ? strokeColor : primaryColor\r\n                ctx.fillRect(massX - 25, centerY - 25, 50, 50)\r\n                ctx.strokeStyle = strokeColor\r\n                ctx.lineWidth = isDragging ? 3 : 1\r\n                ctx.strokeRect(massX - 25, centerY - 25, 50, 50)\r\n\r\n                // Vectors\r\n                if (!isDragging) {\r\n                    drawArrow(ctx, massX, centerY, state.v * 0.5, \"#22c55e\", \"v\")\r\n                    drawArrow(ctx, massX, centerY + 35, state.force * 5, \"#ef4444\", \"F_kv\")\r\n                }\r\n\r\n            } else {\r\n                // Vertical Layout\r\n                const centerX = currWidth / 2\r\n                const ceilingY = 40\r\n                const equilibriumY = currHeight / 2\r\n\r\n                const deltaL_px = derived.deltaL0 * 100 * 1.5\r\n                const naturalY = equilibriumY - deltaL_px\r\n                const massY = equilibriumY + state.x\r\n\r\n                // Ceiling\r\n                ctx.fillStyle = \"#64748b\"\r\n                ctx.fillRect(centerX - 50, ceilingY - 10, 100, 10)\r\n\r\n                // Natural Length Line\r\n                ctx.strokeStyle = \"#fbbf24\"\r\n                ctx.setLineDash([4, 4])\r\n                ctx.beginPath()\r\n                ctx.moveTo(centerX - 120, naturalY)\r\n                ctx.lineTo(centerX + 120, naturalY)\r\n                ctx.stroke()\r\n                ctx.fillStyle = \"#fbbf24\"\r\n                ctx.textAlign = \"right\"\r\n                ctx.fillText(\"Lò xo không giãn (L0)\", centerX - 130, naturalY + 4)\r\n\r\n                // Equilibrium Line\r\n                ctx.strokeStyle = \"#4ade80\"\r\n                ctx.beginPath()\r\n                ctx.moveTo(centerX - 120, equilibriumY)\r\n                ctx.lineTo(centerX + 120, equilibriumY)\r\n                ctx.stroke()\r\n                ctx.fillStyle = \"#4ade80\"\r\n                ctx.textAlign = \"right\"\r\n                ctx.fillText(\"VTCB (O)\", centerX - 130, equilibriumY + 4)\r\n                ctx.setLineDash([])\r\n\r\n                // Delta L\r\n                if (deltaL_px > 10) {\r\n                    const measureX = centerX + 100\r\n                    ctx.strokeStyle = \"#94a3b8\"\r\n                    ctx.beginPath()\r\n                    ctx.moveTo(measureX, naturalY)\r\n                    ctx.lineTo(measureX + 10, naturalY)\r\n                    ctx.moveTo(measureX, equilibriumY)\r\n                    ctx.lineTo(measureX + 10, equilibriumY)\r\n                    ctx.moveTo(measureX + 5, naturalY)\r\n                    ctx.lineTo(measureX + 5, equilibriumY)\r\n                    ctx.stroke()\r\n\r\n                    ctx.fillStyle = \"#f8fafc\"\r\n                    ctx.textAlign = \"left\"\r\n                    ctx.fillText(`Δl₀ = ${(derived.deltaL0 * 100).toFixed(1)} cm`, measureX + 15, naturalY + deltaL_px / 2)\r\n                }\r\n\r\n                // Limits\r\n                ctx.strokeStyle = \"rgba(250, 204, 21, 0.2)\"\r\n                ctx.setLineDash([2, 2])\r\n                ctx.beginPath()\r\n                ctx.moveTo(centerX - 60, equilibriumY - params.amplitude)\r\n                ctx.lineTo(centerX + 60, equilibriumY - params.amplitude)\r\n                ctx.moveTo(centerX - 60, equilibriumY + params.amplitude)\r\n                ctx.lineTo(centerX + 60, equilibriumY + params.amplitude)\r\n                ctx.stroke()\r\n                ctx.setLineDash([])\r\n\r\n                // Draw Spring\r\n                ctx.strokeStyle = \"#cbd5e1\"\r\n                drawSpring(ctx, centerX, ceilingY, centerX, massY - 25, 12, 15)\r\n\r\n                // Draw Mass\r\n                ctx.fillStyle = isDragging ? strokeColor : primaryColor\r\n                ctx.beginPath()\r\n                ctx.arc(centerX, massY, 25, 0, Math.PI * 2)\r\n                ctx.fill()\r\n                ctx.strokeStyle = strokeColor\r\n                ctx.lineWidth = isDragging ? 3 : 1\r\n                ctx.stroke()\r\n\r\n                if (!isDragging) {\r\n                    drawArrow(ctx, centerX + 30, massY, state.v * 0.5, \"#22c55e\", \"v\", \"vertical\")\r\n                    drawArrow(ctx, centerX - 30, massY, state.force * 5, \"#ef4444\", \"F\", \"vertical\")\r\n                }\r\n            }\r\n\r\n            // Info Box\r\n            ctx.fillStyle = \"rgba(15, 23, 42, 0.7)\"\r\n            ctx.fillRect(10, 10, 150, 70)\r\n            ctx.strokeStyle = \"rgba(56, 189, 248, 0.3)\"\r\n            ctx.strokeRect(10, 10, 150, 70)\r\n\r\n            ctx.textAlign = \"left\"\r\n            ctx.textBaseline = \"alphabetic\"\r\n\r\n            ctx.fillStyle = \"#4ade80\"\r\n            ctx.font = \"13px monospace\"\r\n            ctx.fillText(`t = ${state.t.toFixed(2)} s`, 20, 30)\r\n            ctx.fillStyle = \"#38bdf8\"\r\n            ctx.fillText(`x = ${state.x.toFixed(1)} cm`, 20, 50)\r\n            ctx.fillStyle = \"#facc15\"\r\n            ctx.fillText(`v = ${state.v.toFixed(1)} cm/s`, 20, 70)\r\n\r\n            if (isDragging) {\r\n                ctx.fillStyle = \"#ffffff\"\r\n                ctx.font = \"12px sans-serif\"\r\n                ctx.fillText(\"✋ Đang kéo...\", 20, 95)\r\n            } else if (label) {\r\n                ctx.fillStyle = primaryColor\r\n                ctx.font = \"bold 12px sans-serif\"\r\n                ctx.fillText(label, 20, 95)\r\n            }\r\n\r\n        },\r\n        [layout, state, params, derived, width, height, isDragging, label, colorTheme]\r\n    )\r\n\r\n    useEffect(() => {\r\n        // Only Redraw when state or props change\r\n        if (canvasRef.current && width > 0 && height > 0) {\r\n            const canvas = canvasRef.current\r\n            if (canvas.width !== width * pixelRatio || canvas.height !== height * pixelRatio) {\r\n                canvas.width = width * pixelRatio\r\n                canvas.height = height * pixelRatio\r\n            }\r\n\r\n            const ctx = canvas.getContext(\"2d\")\r\n            if (ctx) {\r\n                ctx.save()\r\n                ctx.scale(pixelRatio, pixelRatio)\r\n                draw(ctx)\r\n                ctx.restore()\r\n            }\r\n        }\r\n    }, [draw, width, height, pixelRatio])\r\n\r\n    return (\r\n        <div\r\n            ref={containerRef}\r\n            className=\"bg-[#16213e] rounded-xl overflow-hidden border border-cyan-900/50 shadow-lg relative w-full h-[300px] lg:h-[400px] touch-none\"\r\n        >\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"w-full h-full block touch-none cursor-move\"\r\n                onPointerDown={handlePointerDown}\r\n                onPointerMove={handlePointerMove}\r\n                onPointerUp={handlePointerUp}\r\n                onPointerLeave={handlePointerUp}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1195, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/spring-oscillator.tsx"],"sourcesContent":["\"use client\"\n\nimport { useRef, useEffect, useState, useCallback } from \"react\"\nimport ControlPanel from \"../ui/control-panel\"\nimport { TrendingUp, Ruler, Activity, RotateCcw, SkipBack, Play, Pause, SkipForward, SplitSquareHorizontal, Square } from \"lucide-react\"\nimport { useSpringPhysics } from \"@/hooks/use-spring-physics\"\nimport OscillatorView from \"./oscillator-view\"\n\nexport default function SpringOscillator() {\n  const energyCanvasRef = useRef<HTMLCanvasElement>(null)\n  const animationRef = useRef<number>()\n\n  const [layout, setLayout] = useState<\"horizontal\" | \"vertical\">(\"horizontal\")\n  const [mode, setMode] = useState<\"single\" | \"compare\">(\"single\")\n  const [activeTab, setActiveTab] = useState<\"system1\" | \"system2\">(\"system1\")\n\n  // System 1 Physics\n  const sys1 = useSpringPhysics({ mass: 0.5, k: 20, amplitude: 80, phase: 0 })\n\n  // System 2 Physics\n  const sys2 = useSpringPhysics({ mass: 1.0, k: 40, amplitude: 60, phase: 0 })\n\n  // Unified Controls\n  const togglePlay = () => {\n    const newState = !sys1.isPlaying\n    sys1.setIsPlaying(newState)\n    sys2.setIsPlaying(newState) // Sync playing state\n  }\n\n  const handleReset = () => {\n    sys1.reset()\n    sys2.reset()\n  }\n\n  const stepForward = () => {\n    sys1.step(0.05)\n    sys2.step(0.05)\n  }\n\n  const stepBackward = () => {\n    sys1.step(-0.05)\n    sys2.step(-0.05)\n  }\n\n  const activeSys = activeTab === \"system1\" ? sys1 : sys2\n  const isPlaying = sys1.isPlaying // Assuming synced\n\n  // Energy Graph Drawing\n  const drawEnergyGraph = useCallback(\n    (ctx: CanvasRenderingContext2D) => {\n      const w = ctx.canvas.width\n      const h = ctx.canvas.height\n\n      const history = activeSys.historyRef.current\n      const params = activeSys.params\n\n      // Transparent Background for Overlay\n      ctx.clearRect(0, 0, w, h)\n      ctx.fillStyle = \"rgba(15, 23, 42, 0.4)\" // Semi-transparent\n      ctx.fillRect(0, 50, w, h - 50)\n\n      // Grid\n      ctx.strokeStyle = \"#1e293b\"\n      ctx.lineWidth = 0.5\n      ctx.beginPath()\n      for (let x = 0; x < w; x += 50) {\n        ctx.moveTo(x, 0)\n        ctx.lineTo(x, h)\n      }\n      for (let y = 50; y < h - 10; y += 30) { // Adjusted grid to fit new fillRect area\n        ctx.moveTo(0, y)\n        ctx.lineTo(w, y)\n      }\n      ctx.stroke()\n\n      if (history.length < 2) return\n\n      // Use a fixed reference for max energy based on Max Amplitude (100cm)\n      const maxAmpMeters = 1.0 // 100cm\n      const maxRefEnergy = 0.5 * params.k * Math.pow(maxAmpMeters, 2)\n\n      // Scale so that Max Ref Energy hits 90% of height\n      const graphHeight = h - 60 // Total height for graph lines, leaving 50px for top label and 10px for bottom padding\n      const yScale = maxRefEnergy > 0 ? (graphHeight * 0.9) / maxRefEnergy : 1\n\n      const drawLine = (key: keyof typeof history[0], color: string) => {\n        ctx.strokeStyle = color\n        ctx.lineWidth = 2\n        ctx.beginPath()\n        const stepX = w / 300\n        const dataSlice = history.slice(-300)\n\n        dataSlice.forEach((pt, i) => {\n          const val = pt[key] as number\n          const x = i * stepX\n          const y = h - 10 - val * yScale // 10px padding bottom, graph starts from bottom\n          if (i === 0) ctx.moveTo(x, y)\n          else ctx.lineTo(x, y)\n        })\n        ctx.stroke()\n      }\n\n      drawLine(\"wd\", \"#22c55e\")\n      drawLine(\"wt\", \"#3b82f6\")\n      drawLine(\"wTotal\", \"#eab308\")\n\n      // Legend\n      ctx.font = \"10px monospace\"\n      ctx.fillStyle = \"#eab308\"; ctx.fillText(\"Cơ năng\", 10, h - 35)\n      ctx.fillStyle = \"#22c55e\"; ctx.fillText(\"Động năng\", 70, h - 35)\n      ctx.fillStyle = \"#3b82f6\"; ctx.fillText(\"Thế năng\", 140, h - 35)\n    },\n    [activeSys, activeTab]\n  )\n\n  // Stable Animation Loop Pattern\n  const renderLogic = useCallback(() => {\n    if (sys1.isPlaying) {\n      sys1.step(0.016)\n      sys2.step(0.016)\n    }\n\n    if (energyCanvasRef.current) {\n      const ctx = energyCanvasRef.current.getContext(\"2d\")\n      if (ctx) drawEnergyGraph(ctx)\n    }\n  }, [sys1.isPlaying, sys1.step, sys2.step, drawEnergyGraph])\n  // Note: relying on sys1.step stable identity. using sys1.isPlaying value. \n  // If we used [sys1], it would change every frame.\n  // sys1.step is stable. sys1.isPlaying changes only on user interaction.\n  // drawEnergyGraph depends on activeSys params/history which are stable refs/state-setters, \n  // but activeSys object changes.\n  // Actually drawEnergyGraph (lines 49-114) depends on [activeSys, activeTab].\n  // activeSys changes every frame. So drawEnergyGraph changes every frame.\n  // So renderLogic changes every frame.\n  // So renderRef updates every frame.\n  // Main loop calls separate function via ref. No cancel/restart. Correct.\n\n  const renderRef = useRef(renderLogic)\n  useEffect(() => {\n    renderRef.current = renderLogic\n  }, [renderLogic])\n\n  useEffect(() => {\n    const loop = () => {\n      if (renderRef.current) renderRef.current()\n      animationRef.current = requestAnimationFrame(loop)\n    }\n    animationRef.current = requestAnimationFrame(loop)\n    return () => {\n      if (animationRef.current) cancelAnimationFrame(animationRef.current)\n    }\n  }, [])\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n      <div className=\"lg:col-span-2 space-y-4\">\n\n        {/* VIEWPORT AREA */}\n        <div className={`grid gap-4 ${mode === \"compare\" ? \"grid-rows-2\" : \"grid-rows-1\"} relative`}>\n          {/* OVERLAY ENERGY GRAPH (Absolute over the viewport area) */}\n          <div className=\"absolute bottom-0 left-0 w-full h-[200px] pointer-events-none z-20 flex flex-col justify-end\">\n            <canvas\n              ref={energyCanvasRef}\n              width={800}\n              height={200}\n              className=\"w-full h-full\"\n            />\n          </div>\n\n          {/* System 1 */}\n          <div className=\"relative bg-[#1e293b] rounded-xl overflow-hidden border border-slate-700/50\">\n            {mode === \"compare\" && <div className=\"absolute top-2 left-2 z-10 text-xs font-bold text-blue-400 bg-black/50 px-2 py-1 rounded\">System 1</div>}\n            <OscillatorView\n              sysId=\"sys1\"\n              params={sys1.params}\n              state={sys1.calculateState(sys1.timeRef.current)} // Get instantaneous state\n              derived={sys1.derived}\n              layout={layout}\n              onParameterChange={(p) => sys1.setParams(prev => ({ ...prev, ...p }))}\n              onInteractionStart={() => sys1.setIsPlaying(false)}\n              onInteractionEnd={() => { }}\n              colorTheme=\"blue\"\n              label={mode === \"single\" ? \"\" : \"Hệ 1\"}\n            />\n          </div>\n\n          {/* System 2 (Only in Compare Mode) */}\n          {mode === \"compare\" && (\n            <div className=\"relative animate-in slide-in-from-top-4 duration-300 bg-[#1e293b] rounded-xl overflow-hidden border border-slate-700/50\">\n              <div className=\"absolute top-2 left-2 z-10 text-xs font-bold text-orange-400 bg-black/50 px-2 py-1 rounded\">System 2</div>\n              <OscillatorView\n                sysId=\"sys2\"\n                params={sys2.params}\n                state={sys2.calculateState(sys2.timeRef.current)}\n                derived={sys2.derived}\n                layout={layout}\n                onParameterChange={(p) => sys2.setParams(prev => ({ ...prev, ...p }))}\n                onInteractionStart={() => {\n                  sys1.setIsPlaying(false)\n                  sys2.setIsPlaying(false)\n                }}\n                onInteractionEnd={() => { }}\n                colorTheme=\"orange\"\n                label=\"Hệ 2\"\n              />\n            </div>\n          )}\n        </div>\n\n        {/* UNIFIED CONTROLS */}\n        <div className=\"flex justify-center gap-3 py-2\">\n          <button onClick={handleReset} className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n            <RotateCcw size={20} />\n          </button>\n          <button onClick={stepBackward} className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n            <SkipBack size={20} />\n          </button>\n          <button\n            onClick={togglePlay}\n            className={`w-14 h-14 rounded-2xl flex items-center justify-center transition-all shadow-lg active:scale-95 border border-transparent ${isPlaying\n              ? \"bg-amber-600 hover:bg-amber-500 shadow-amber-900/20\"\n              : \"bg-cyan-600 hover:bg-cyan-500 shadow-cyan-500/30\"\n              } text-white`}\n          >\n            {isPlaying ? <Pause size={28} fill=\"currentColor\" /> : <Play size={28} fill=\"currentColor\" className=\"ml-1\" />}\n          </button>\n          <button onClick={stepForward} className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n            <SkipForward size={20} />\n          </button>\n        </div>\n      </div>\n\n      <div className=\"space-y-4\">\n        <ControlPanel title=\"Cấu hình hệ thống\">\n          {/* Mode Selection */}\n          <div className=\"flex gap-2 mb-4 bg-slate-900/50 p-1 rounded-lg border border-slate-700\">\n            <button onClick={() => setMode(\"single\")} className={`flex-1 py-2 rounded text-xs font-bold uppercase ${mode === \"single\" ? \"bg-cyan-600 text-white shadow\" : \"text-slate-400 hover:text-white\"}`}>\n              <Square size={14} className=\"inline mr-1 mb-0.5\" /> Đơn\n            </button>\n            <button onClick={() => setMode(\"compare\")} className={`flex-1 py-2 rounded text-xs font-bold uppercase ${mode === \"compare\" ? \"bg-orange-600 text-white shadow\" : \"text-slate-400 hover:text-white\"}`}>\n              <SplitSquareHorizontal size={14} className=\"inline mr-1 mb-0.5\" /> So sánh\n            </button>\n          </div>\n\n          {/* Layout Selection */}\n          <div className=\"flex gap-2 mb-4\">\n            <button onClick={() => setLayout(\"horizontal\")} className={`flex-1 py-2 rounded border text-xs font-bold uppercase ${layout === \"horizontal\" ? \"bg-slate-700 border-slate-500 text-white\" : \"border-transparent bg-slate-800 text-slate-400\"}`}>Nằm ngang</button>\n            <button onClick={() => setLayout(\"vertical\")} className={`flex-1 py-2 rounded border text-xs font-bold uppercase ${layout === \"vertical\" ? \"bg-slate-700 border-slate-500 text-white\" : \"border-transparent bg-slate-800 text-slate-400\"}`}>Thẳng đứng</button>\n          </div>\n\n          {/* System Tabs (Only in Compare Mode) */}\n          {mode === \"compare\" && (\n            <div className=\"flex gap-1 mb-4 border-b border-slate-700\">\n              <button onClick={() => setActiveTab(\"system1\")} className={`flex-1 py-2 text-xs font-bold uppercase border-b-2 transition-colors ${activeTab === \"system1\" ? \"border-blue-500 text-blue-400\" : \"border-transparent text-slate-500 hover:text-slate-300\"}`}>\n                System 1\n              </button>\n              <button onClick={() => setActiveTab(\"system2\")} className={`flex-1 py-2 text-xs font-bold uppercase border-b-2 transition-colors ${activeTab === \"system2\" ? \"border-orange-500 text-orange-400\" : \"border-transparent text-slate-500 hover:text-slate-300\"}`}>\n                System 2\n              </button>\n            </div>\n          )}\n\n          <div className=\"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300\" key={activeTab}>\n            <div>\n              <label className=\"text-xs text-gray-400 mb-1 block\">Khối lượng m</label>\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"range\"\n                  min=\"0.1\"\n                  max=\"2\"\n                  step=\"0.1\"\n                  value={activeSys.params.mass}\n                  onChange={(e) => activeSys.setParams(p => ({ ...p, mass: Number(e.target.value) }))}\n                  className={`flex-1 h-2 bg-slate-700 rounded-lg cursor-pointer ${activeTab === 'system1' ? 'accent-cyan-500' : 'accent-orange-500'}`}\n                />\n                <span className={`w-16 text-right font-mono text-sm ${activeTab === 'system1' ? 'text-cyan-400' : 'text-orange-400'}`}>{activeSys.params.mass} kg</span>\n              </div>\n            </div>\n            <div>\n              <label className=\"text-xs text-gray-400 mb-1 block\">Độ cứng k</label>\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"range\"\n                  min=\"10\"\n                  max=\"200\"\n                  step=\"5\"\n                  value={activeSys.params.k}\n                  onChange={(e) => activeSys.setParams(p => ({ ...p, k: Number(e.target.value) }))}\n                  className={`flex-1 h-2 bg-slate-700 rounded-lg cursor-pointer ${activeTab === 'system1' ? 'accent-cyan-500' : 'accent-orange-500'}`}\n                />\n                <span className={`w-16 text-right font-mono text-sm ${activeTab === 'system1' ? 'text-cyan-400' : 'text-orange-400'}`}>{activeSys.params.k} N/m</span>\n              </div>\n            </div>\n            <div>\n              <label className=\"text-xs text-gray-400 mb-1 block\">Biên độ A</label>\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"range\"\n                  min=\"10\"\n                  max=\"100\"\n                  value={activeSys.params.amplitude}\n                  onChange={(e) => activeSys.setParams(p => ({ ...p, amplitude: Number(e.target.value) }))}\n                  className={`flex-1 h-2 bg-slate-700 rounded-lg cursor-pointer ${activeTab === 'system1' ? 'accent-cyan-500' : 'accent-orange-500'}`}\n                />\n                <span className={`w-16 text-right font-mono text-sm ${activeTab === 'system1' ? 'text-cyan-400' : 'text-orange-400'}`}>{Math.round(activeSys.params.amplitude)} cm</span>\n              </div>\n            </div>\n          </div>\n        </ControlPanel>\n\n        <div className=\"bg-[#1e293b] rounded-xl p-0 border border-cyan-900/50 overflow-hidden\">\n          <div className=\"bg-slate-800/50 p-3 border-b border-slate-700 flex items-center gap-2\">\n            <Activity className=\"w-4 h-4 text-green-400\" />\n            <h3 className=\"text-sm font-bold text-slate-200\">Đại lượng ({mode === \"compare\" ? (activeTab === \"system1\" ? \"Sys 1\" : \"Sys 2\") : \"Sys 1\"})</h3>\n          </div>\n          <div className=\"p-4 grid grid-cols-2 gap-4\">\n            <div>\n              <div className=\"text-[10px] text-gray-500 uppercase\">Chu kỳ (T)</div>\n              <div className=\"text-lg font-mono font-bold text-white\">\n                {activeSys.derived.period.toFixed(2)} <span className=\"text-xs font-normal text-gray-400\">s</span>\n              </div>\n            </div>\n            <div>\n              <div className=\"text-[10px] text-gray-500 uppercase\">Tần số (f)</div>\n              <div className=\"text-lg font-mono font-bold text-white\">\n                {activeSys.derived.frequency.toFixed(2)} <span className=\"text-xs font-normal text-gray-400\">Hz</span>\n              </div>\n            </div>\n            <div>\n              <div className=\"text-[10px] text-gray-500 uppercase\">Vận tốc Max</div>\n              <div className=\"text-lg font-mono font-bold text-green-400\">\n                {activeSys.derived.vmax.toFixed(1)} <span className=\"text-xs font-normal text-gray-400\">cm/s</span>\n              </div>\n            </div>\n            <div>\n              <div className=\"text-[10px] text-gray-500 uppercase\">Gia tốc Max</div>\n              <div className=\"text-lg font-mono font-bold text-red-400\">\n                {activeSys.derived.amax.toFixed(0)} <span className=\"text-xs font-normal text-gray-400\">cm/s²</span>\n              </div>\n            </div>\n            {layout === \"vertical\" && (\n              <div className=\"col-span-2 bg-slate-900 p-2 rounded border border-slate-700 flex items-center justify-between\">\n                <span className=\"text-xs text-yellow-500 flex items-center gap-1\">\n                  <Ruler size={12} /> Độ giãn lò xo (Δl₀)\n                </span>\n                <span className=\"font-mono font-bold text-yellow-400\">{(activeSys.derived.deltaL0 * 100).toFixed(1)} cm</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"bg-[#16213e] rounded-lg p-4 border border-cyan-900/50\">\n          <h3 className=\"text-cyan-400 font-semibold mb-2\">Công thức</h3>\n          <div className=\"text-sm text-gray-300 space-y-1 font-mono\">\n            <p>ω = √(k/m) = {activeSys.derived.omega.toFixed(2)} rad/s</p>\n            <p>T = 2π√(m/k) = {activeSys.derived.period.toFixed(2)} s</p>\n            <p>F = -kx (Định luật Hooke)</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2129, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/simple-pendulum.tsx"],"sourcesContent":["\"use client\"\n\nimport { useRef, useEffect, useState, useCallback } from \"react\"\nimport ControlPanel from \"../ui/control-panel\"\nimport { Activity, Zap, TrendingUp, RotateCcw, SkipBack, Pause, Play, SkipForward, Ruler, Anchor } from \"lucide-react\"\n\nexport default function SimplePendulum() {\n    const canvasRef = useRef<HTMLCanvasElement>(null)\n    const energyCanvasRef = useRef<HTMLCanvasElement>(null)\n\n    const [isPlaying, setIsPlaying] = useState(false)\n    const [time, setTime] = useState(0)\n\n    const [showGraph, setShowGraph] = useState({ x: true, v: false, a: false })\n\n    const [params, setParams] = useState({\n        length: 100,      // cm\n        gravity: 9.8,     // m/s²\n        initialAngle: 10, // degrees\n        mass: 1.0         // kg\n    })\n\n    // History for Energy Graph\n    const energyHistoryRef = useRef<{ t: number, wd: number, wt: number, w: number }[]>([])\n\n    const animationRef = useRef<number>()\n    const timeRef = useRef(0)\n\n    // Physics Calculations\n    const lengthM = params.length / 100\n    const omega = Math.sqrt(params.gravity / lengthM)\n    const period = (2 * Math.PI) / omega\n    const frequency = 1 / period\n    const thetaMax = (params.initialAngle * Math.PI) / 180\n    const dt = 0.016\n\n    const calculateState = useCallback(\n        (t: number) => {\n            const theta = thetaMax * Math.cos(omega * t)\n            const x = params.length * Math.sin(theta) // Horizontal displacement approx\n\n            // Calculate v using Energy Conservation to ensure W is constant for large angles\n            const l_m = params.length / 100\n            const h_current = l_m * (1 - Math.cos(theta))\n            const h_max = l_m * (1 - Math.cos(thetaMax))\n            const v_mag = Math.sqrt(2 * params.gravity * Math.max(0, h_max - h_current))\n\n            // Direction same as SHM approximation: -sin(omega*t)\n            const sign = -Math.sin(omega * t) >= 0 ? 1 : -1\n            const v = sign * v_mag * 100 // Convert to cm/s\n\n            // Acceleration (approx)\n            const a = -params.length * omega * omega * thetaMax * Math.cos(omega * t)\n\n            return { theta, x, v, a }\n        },\n        [thetaMax, omega, params.length, params.gravity],\n    )\n\n    const drawSim = useCallback(\n        (ctx: CanvasRenderingContext2D, t: number) => {\n            const width = ctx.canvas.width\n            const height = ctx.canvas.height\n\n            ctx.fillStyle = \"#0f172a\"\n            ctx.fillRect(0, 0, width, height)\n\n            // Grid\n            ctx.strokeStyle = \"#1e293b\"\n            ctx.lineWidth = 0.5\n            ctx.beginPath()\n            for (let i = 0; i < width; i += 40) { ctx.moveTo(i, 0); ctx.lineTo(i, height) }\n            for (let i = 0; i < height; i += 40) { ctx.moveTo(0, i); ctx.lineTo(width, i) }\n            ctx.stroke()\n\n            const state = calculateState(t)\n\n            const pivotX = width / 2\n            const pivotY = 40\n\n            const bobX = pivotX + params.length * Math.sin(state.theta)\n            const bobY = pivotY + params.length * Math.cos(state.theta)\n\n            // Support\n            ctx.fillStyle = \"#64748b\"\n            ctx.fillRect(pivotX - 40, pivotY - 10, 80, 10)\n\n            // Vertical dashed line\n            ctx.strokeStyle = \"#334155\"; ctx.setLineDash([5, 5])\n            ctx.beginPath(); ctx.moveTo(pivotX, pivotY); ctx.lineTo(pivotX, pivotY + params.length + 40); ctx.stroke(); ctx.setLineDash([])\n\n            // String\n            ctx.strokeStyle = \"#cbd5e1\"; ctx.lineWidth = 2\n            ctx.beginPath(); ctx.moveTo(pivotX, pivotY); ctx.lineTo(bobX, bobY); ctx.stroke()\n\n            // Bob\n            const gradient = ctx.createRadialGradient(bobX - 5, bobY - 5, 2, bobX, bobY, 20)\n            gradient.addColorStop(0, \"#fb923c\")\n            gradient.addColorStop(1, \"#ea580c\")\n            ctx.fillStyle = gradient\n            ctx.beginPath(); ctx.arc(bobX, bobY, 20, 0, 2 * Math.PI); ctx.fill()\n            ctx.strokeStyle = \"#fff7ed\"; ctx.lineWidth = 2; ctx.stroke()\n\n            // Angle indicator\n            ctx.fillStyle = \"#facc15\"; ctx.font = \"bold 14px monospace\"\n            ctx.fillText(`${state.theta > 0 ? '+' : ''}${((state.theta * 180) / Math.PI).toFixed(1)}°`, pivotX + 20, pivotY + 40)\n\n            // Info overlay (Top Left)\n            ctx.fillStyle = \"rgba(15, 23, 42, 0.8)\"; ctx.fillRect(10, 10, 140, 80)\n            ctx.strokeStyle = \"rgba(56, 189, 248, 0.3)\"; ctx.strokeRect(10, 10, 140, 80)\n\n            ctx.font = \"12px monospace\"; ctx.textAlign = \"left\"\n            ctx.fillStyle = \"#e2e8f0\"; ctx.fillText(`t = ${t.toFixed(2)} s`, 20, 30)\n            ctx.fillStyle = \"#22d3ee\"; ctx.fillText(`α = ${((state.theta * 180) / Math.PI).toFixed(1)}°`, 20, 50)\n            ctx.fillStyle = \"#4ade80\"; ctx.fillText(`v = ${state.v.toFixed(1)} cm/s`, 20, 70)\n\n            // Signature\n            ctx.fillStyle = \"rgba(255, 255, 255, 0.15)\"; ctx.textAlign = \"right\"\n            ctx.fillText(\"Simple Pendulum\", width - 15, height - 15)\n            ctx.textAlign = \"left\" // Reset\n        },\n        [params.length, params.gravity, calculateState],\n    )\n\n    const drawEnergyGraph = useCallback((ctx: CanvasRenderingContext2D) => {\n        const w = ctx.canvas.width\n        const h = ctx.canvas.height\n        const history = energyHistoryRef.current\n\n        // Clear instead of fill to allow overlay\n        ctx.clearRect(0, 0, w, h)\n\n        // Optional: Semi-transparent background for readability\n        ctx.fillStyle = \"rgba(15, 23, 42, 0.4)\"\n        ctx.fillRect(0, 50, w, h - 50)\n\n        if (history.length < 2) return\n\n        const l_m = params.length / 100\n\n        // Auto-Scale based on CURRENT initialAngle (user preference)\n        // This makes the graph always fill the view regardless of how small the angle is.\n        const thetaMaxRad = (params.initialAngle * Math.PI) / 180\n        const maxRefPotential = params.mass * params.gravity * l_m * (1 - Math.cos(thetaMaxRad))\n\n        // Scale to fit available height (leaving 50px top for overlay, 10px bottom padding)\n        const graphHeight = h - 60\n        const yScale = maxRefPotential > 0 ? (graphHeight * 0.9) / maxRefPotential : 1\n\n        const drawLine = (key: 'wd' | 'wt' | 'w', color: string) => {\n            ctx.strokeStyle = color\n            ctx.lineWidth = 2\n            ctx.beginPath()\n            const dataToDraw = history.slice(-300)\n            const stepX = w / 300\n\n            dataToDraw.forEach((pt, i) => {\n                const x = i * stepX\n                const y = h - 10 - (pt[key] * yScale)\n                if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y)\n            })\n            ctx.stroke()\n        }\n\n        drawLine('wt', '#3b82f6')\n        drawLine('wd', '#22c55e')\n        drawLine('w', '#eab308')\n\n        // Draw Leading Dots (Current Value Indicators)\n        if (history.length > 0) {\n            const lastPt = history[history.length - 1]\n            const stepX = w / 300\n            const x = (history.length - 1) * stepX // Should be roughly w if full\n\n            const drawDot = (key: 'wd' | 'wt' | 'w', color: string) => {\n                const y = h - 10 - (lastPt[key] * yScale)\n                ctx.fillStyle = color\n                ctx.beginPath()\n                ctx.arc(x, y, 4, 0, Math.PI * 2)\n                ctx.fill()\n                ctx.strokeStyle = \"#ffffff\"\n                ctx.lineWidth = 1.5\n                ctx.stroke()\n            }\n\n            drawDot('wt', '#3b82f6')\n            drawDot('wd', '#22c55e')\n            drawDot('w', '#eab308')\n        }\n\n        // Legend inside canvas\n        ctx.font = \"10px monospace\"\n        ctx.fillStyle = \"#eab308\"; ctx.fillText(\"Cơ năng\", 10, h - 35)\n        ctx.fillStyle = \"#22c55e\"; ctx.fillText(\"Động năng\", 70, h - 35)\n        ctx.fillStyle = \"#3b82f6\"; ctx.fillText(\"Thế năng\", 140, h - 35)\n\n    }, [params.length, params.mass, params.gravity, params.initialAngle])\n\n    const renderLogic = useCallback(() => {\n        if (!canvasRef.current) return\n        const ctx = canvasRef.current.getContext(\"2d\")\n        if (!ctx) return\n\n        if (isPlaying) {\n            timeRef.current += dt\n            setTime(timeRef.current)\n\n            const state = calculateState(timeRef.current)\n\n            // Energy Calculation (Enforced Conservation)\n            const l_m = params.length / 100\n            const thetaMaxRad = (params.initialAngle * Math.PI) / 180\n\n            // Total Energy is constant based on initial release angle (assuming v0=0)\n            const h_max = l_m * (1 - Math.cos(thetaMaxRad))\n            const W_total = params.mass * params.gravity * h_max\n\n            // Potential Energy\n            const h_current = l_m * (1 - Math.cos(state.theta))\n            const wt = params.mass * params.gravity * h_current\n\n            // Kinetic Energy (Derived to ensure sum is exactly W_total)\n            const wd = Math.max(0, W_total - wt)\n\n            energyHistoryRef.current.push({ t: timeRef.current, wd, wt, w: W_total })\n            if (energyHistoryRef.current.length > 300) energyHistoryRef.current.shift()\n        }\n\n        drawSim(ctx, timeRef.current)\n        if (energyCanvasRef.current) drawEnergyGraph(energyCanvasRef.current.getContext(\"2d\")!)\n\n    }, [isPlaying, drawSim, drawEnergyGraph, calculateState, params, dt])\n\n    const renderRef = useRef(renderLogic)\n    useEffect(() => {\n        renderRef.current = renderLogic\n    }, [renderLogic])\n\n    useEffect(() => {\n        const loop = () => {\n            if (renderRef.current) renderRef.current()\n            animationRef.current = requestAnimationFrame(loop)\n        }\n        animationRef.current = requestAnimationFrame(loop)\n        return () => { if (animationRef.current) cancelAnimationFrame(animationRef.current) }\n    }, [])\n\n    // Initial Draw\n    useEffect(() => {\n        if (!isPlaying && canvasRef.current && energyCanvasRef.current) {\n            drawSim(canvasRef.current.getContext(\"2d\")!, timeRef.current)\n            drawEnergyGraph(energyCanvasRef.current.getContext(\"2d\")!)\n        }\n    }, [params, drawSim, drawEnergyGraph, isPlaying])\n\n    const handleStep = (dir: number) => {\n        setIsPlaying(false)\n        timeRef.current = Math.max(0, timeRef.current + dir * 0.05)\n        setTime(timeRef.current)\n        // Draw will be updated by loop or effect\n    }\n\n    const handleReset = () => {\n        setIsPlaying(false)\n        timeRef.current = 0\n        setTime(0)\n        energyHistoryRef.current = []\n    }\n\n    // Current values for Stats Panel\n    const currState = calculateState(time)\n    const currH = lengthM * (1 - Math.cos(currState.theta))\n    const currWt = params.mass * params.gravity * currH\n    const currWd = 0.5 * params.mass * (currState.v / 100) ** 2\n    const currW = currWt + currWd\n\n    return (\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n            <div className=\"lg:col-span-2 space-y-4\">\n                {/* Canvas Area with Overlay Graph */}\n                <div className=\"relative bg-[#1e293b] rounded-xl overflow-hidden border border-slate-700/50 shadow-sm\">\n                    <canvas ref={canvasRef} width={800} height={400} className=\"w-full h-[400px] block\" />\n\n                    {/* Energy Graph Overlay */}\n                    <canvas\n                        ref={energyCanvasRef}\n                        width={800}\n                        height={200}\n                        className=\"absolute bottom-0 left-0 w-full h-[200px] pointer-events-none z-10\"\n                    />\n                </div>\n\n                {/* UNIFIED CONTROLS */}\n                <div className=\"flex justify-center gap-3 py-2\">\n                    <button onClick={handleReset} className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n                        <RotateCcw size={20} />\n                    </button>\n                    <button onClick={() => handleStep(-1)} className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n                        <SkipBack size={20} />\n                    </button>\n                    <button\n                        onClick={() => setIsPlaying(!isPlaying)}\n                        className={`w-14 h-14 rounded-2xl flex items-center justify-center transition-all shadow-lg active:scale-95 border border-transparent ${isPlaying\n                            ? \"bg-amber-600 hover:bg-amber-500 shadow-amber-900/20\"\n                            : \"bg-cyan-600 hover:bg-cyan-500 shadow-cyan-500/30\"\n                            } text-white`}\n                    >\n                        {isPlaying ? <Pause size={28} fill=\"currentColor\" /> : <Play size={28} fill=\"currentColor\" className=\"ml-1\" />}\n                    </button>\n                    <button onClick={() => handleStep(1)} className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n                        <SkipForward size={20} />\n                    </button>\n                </div>\n            </div>\n            <div className=\"space-y-4\">\n                {/* CONFIGURATION */}\n                <ControlPanel title=\"Cấu hình hệ thống\">\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label className=\"text-xs text-gray-400 mb-1 block\">Chiều dài l</label>\n                            <div className=\"flex items-center gap-2\">\n                                <input\n                                    type=\"range\"\n                                    min=\"50\"\n                                    max=\"200\"\n                                    value={params.length}\n                                    onChange={(e) => {\n                                        setParams(p => ({ ...p, length: Number(e.target.value) }))\n                                        energyHistoryRef.current = []\n                                    }}\n                                    className=\"flex-1 h-2 bg-slate-700 rounded-lg cursor-pointer accent-cyan-500\"\n                                />\n                                <span className=\"w-16 text-right font-mono text-sm text-cyan-400\">{params.length} cm</span>\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"text-xs text-gray-400 mb-1 block\">Gia tốc g</label>\n                            <div className=\"flex items-center gap-2\">\n                                <input\n                                    type=\"range\"\n                                    min=\"1\"\n                                    max=\"20\"\n                                    step=\"0.1\"\n                                    value={params.gravity}\n                                    onChange={(e) => {\n                                        setParams(p => ({ ...p, gravity: Number(e.target.value) }))\n                                        energyHistoryRef.current = []\n                                    }}\n                                    className=\"flex-1 h-2 bg-slate-700 rounded-lg cursor-pointer accent-cyan-500\"\n                                />\n                                <span className=\"w-16 text-right font-mono text-sm text-cyan-400\">{params.gravity} m/s²</span>\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"text-xs text-gray-400 mb-1 block\">Góc ban đầu θ₀ (Lưu ý: ≤ 10° để dao động điều hòa)</label>\n                            <div className=\"flex items-center gap-2\">\n                                <input\n                                    type=\"range\"\n                                    min=\"1\"\n                                    max=\"60\"\n                                    value={params.initialAngle}\n                                    onChange={(e) => {\n                                        setParams(p => ({ ...p, initialAngle: Number(e.target.value) }))\n                                        energyHistoryRef.current = []\n                                    }}\n                                    className=\"flex-1 h-2 bg-slate-700 rounded-lg cursor-pointer accent-cyan-500\"\n                                />\n                                <span className=\"w-16 text-right font-mono text-sm text-cyan-400\">{params.initialAngle}°</span>\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"text-xs text-gray-400 mb-1 block\">Khối lượng m</label>\n                            <div className=\"flex items-center gap-2\">\n                                <input\n                                    type=\"range\"\n                                    min=\"0.1\"\n                                    max=\"5\"\n                                    step=\"0.1\"\n                                    value={params.mass}\n                                    onChange={(e) => {\n                                        setParams(p => ({ ...p, mass: Number(e.target.value) }))\n                                        energyHistoryRef.current = []\n                                    }}\n                                    className=\"flex-1 h-2 bg-slate-700 rounded-lg cursor-pointer accent-cyan-500\"\n                                />\n                                <span className=\"w-16 text-right font-mono text-sm text-cyan-400\">{params.mass} kg</span>\n                            </div>\n                        </div>\n                    </div>\n                </ControlPanel>\n\n                {/* STATS */}\n                <div className=\"bg-[#1e293b] rounded-xl p-0 border border-cyan-900/50 overflow-hidden\">\n                    <div className=\"bg-slate-800/50 p-3 border-b border-slate-700 flex items-center gap-2\">\n                        <Activity className=\"w-4 h-4 text-green-400\" />\n                        <h3 className=\"text-sm font-bold text-slate-200\">Đại lượng đo đạc</h3>\n                    </div>\n                    <div className=\"p-4 grid grid-cols-2 gap-4\">\n                        <div>\n                            <div className=\"text-[10px] text-gray-500 uppercase\">Chu kỳ (T)</div>\n                            <div className=\"text-lg font-mono font-bold text-white\">\n                                {period.toFixed(2)} <span className=\"text-xs font-normal text-gray-400\">s</span>\n                            </div>\n                        </div>\n                        <div>\n                            <div className=\"text-[10px] text-gray-500 uppercase\">Tần số (f)</div>\n                            <div className=\"text-lg font-mono font-bold text-white\">\n                                {frequency.toFixed(2)} <span className=\"text-xs font-normal text-gray-400\">Hz</span>\n                            </div>\n                        </div>\n                        <div>\n                            <div className=\"text-[10px] text-gray-500 uppercase\">Vận tốc (v)</div>\n                            <div className=\"text-lg font-mono font-bold text-white\">\n                                {currState.v.toFixed(1)} <span className=\"text-xs font-normal text-gray-400\">cm/s</span>\n                            </div>\n                        </div>\n                        <div>\n                            <div className=\"text-[10px] text-gray-500 uppercase\">Gia tốc (a)</div>\n                            <div className=\"text-lg font-mono font-bold text-white\">\n                                {currState.a.toFixed(1)} <span className=\"text-xs font-normal text-gray-400\">cm/s²</span>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n\n                {/* ENERGY MONITOR */}\n                <div className=\"bg-[#1e293b] rounded-xl p-4 border border-cyan-900/50\">\n                    <h3 className=\"text-amber-400 font-semibold mb-3 text-sm flex items-center gap-2\">\n                        <Zap size={14} /> Năng lượng\n                    </h3>\n                    <div className=\"space-y-3\">\n                        <div>\n                            <div className=\"flex justify-between text-xs mb-1\">\n                                <span className=\"text-green-400\">Động năng Wđ</span>\n                                <span className=\"text-green-400 font-mono\">{currWd.toFixed(3)} J</span>\n                            </div>\n                            <div className=\"h-2 bg-slate-700 rounded-full overflow-hidden\">\n                                <div className=\"h-full bg-green-500 transition-all duration-100\" style={{ width: `${(currWd / (currW || 1)) * 100}%` }} />\n                            </div>\n                        </div>\n                        <div>\n                            <div className=\"flex justify-between text-xs mb-1\">\n                                <span className=\"text-blue-400\">Thế năng Wt</span>\n                                <span className=\"text-blue-400 font-mono\">{currWt.toFixed(3)} J</span>\n                            </div>\n                            <div className=\"h-2 bg-slate-700 rounded-full overflow-hidden\">\n                                <div className=\"h-full bg-blue-500 transition-all duration-100\" style={{ width: `${(currWt / (currW || 1)) * 100}%` }} />\n                            </div>\n                        </div>\n                        <div>\n                            <div className=\"flex justify-between text-xs mb-1\">\n                                <span className=\"text-yellow-400\">Cơ năng W</span>\n                                <span className=\"text-yellow-400 font-mono\">{currW.toFixed(3)} J</span>\n                            </div>\n                            <div className=\"h-2 bg-yellow-500/30 rounded-full\" />\n                        </div>\n                    </div>\n                </div>\n\n                {/* FORMULAS */}\n                <div className=\"bg-[#16213e] rounded-lg p-4 border border-cyan-900/50\">\n                    <h3 className=\"text-cyan-400 font-semibold mb-2 flex items-center gap-2 text-sm\"><Anchor size={14} /> Công thức</h3>\n                    <div className=\"text-xs text-gray-300 space-y-1 font-mono\">\n                        <p>l: Chiều dài từ điểm treo đến tâm vật</p>\n                        <p className=\"text-slate-500\">Điều kiện: α₀ ≤ 10°</p>\n                        <div className=\"w-full h-[1px] bg-slate-700 my-2\"></div>\n                        <p>ω = √(g/l) = {omega.toFixed(2)} rad/s</p>\n                        <p>T = 2π/ω = {period.toFixed(2)} s</p>\n                        <p>W = mgl(1-cos(α₀))</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3262, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/damped-oscillation.tsx"],"sourcesContent":["\"use client\"\n\nimport { useRef, useEffect, useState, useCallback } from \"react\"\nimport { Play, Pause, RotateCcw, SkipBack, SkipForward, Activity, Settings, TrendingDown, Wind, Zap, Droplets, Hexagon } from \"lucide-react\"\n\n// --- COMPONENT CON ---\nconst ControlPanel = ({ title, icon: Icon, children }: { title: string; icon?: any; children: React.ReactNode }) => (\n    <div className=\"bg-[#1e293b] rounded-xl border border-slate-700/50 shadow-sm overflow-hidden flex flex-col h-full\">\n        <div className=\"bg-slate-800/50 px-4 py-3 border-b border-slate-700/50 flex items-center gap-2\">\n            {Icon && <Icon size={16} className=\"text-cyan-400\" />}\n            <h3 className=\"text-slate-300 font-bold text-xs uppercase tracking-wider\">{title}</h3>\n        </div>\n        <div className=\"p-4 space-y-4 flex-1\">{children}</div>\n    </div>\n)\n\n// --- GRID BACKGROUND COMPONENT ---\nconst GridBackground = () => (\n    <defs>\n        <pattern id=\"smallGrid\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n            <path d=\"M 20 0 L 0 0 0 20\" fill=\"none\" stroke=\"#334155\" strokeWidth=\"0.5\" opacity=\"0.3\" />\n        </pattern>\n        <pattern id=\"grid\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\">\n            <rect width=\"100\" height=\"100\" fill=\"url(#smallGrid)\" />\n            <path d=\"M 100 0 L 0 0 0 100\" fill=\"none\" stroke=\"#475569\" strokeWidth=\"1\" opacity=\"0.5\" />\n        </pattern>\n    </defs>\n)\n\nconst ENVIRONMENTS: Record<string, { name: string; beta: number; color: string; icon: any }> = {\n    vacuum: { name: 'Chân không', beta: 0, color: '#94a3b8', icon: Zap },\n    air: { name: 'Không khí', beta: 0.05, color: '#38bdf8', icon: Wind },\n    water: { name: 'Nước', beta: 0.3, color: '#3b82f6', icon: Droplets },\n    oil: { name: 'Dầu nhớt', beta: 0.8, color: '#eab308', icon: Hexagon }\n};\n\nexport default function DampedOscillation() {\n    const energyCanvasRef = useRef<HTMLCanvasElement>(null)\n\n    const [isPlaying, setIsPlaying] = useState(false)\n    const [time, setTime] = useState(0)\n    const [env, setEnv] = useState('air')\n    const [graphMode, setGraphMode] = useState<'x' | 'v' | 'a'>('x') // Chế độ hiển thị đồ thị\n    const GRAPH_WINDOW = 20\n\n    const [params, setParams] = useState({\n        A: 80,   // px\n        f: 0.5,  // Hz\n        phi: 0,  // rad\n        m: 1.0,  // kg\n        k: 20    // N/m\n    })\n\n    const energyHistoryRef = useRef<{ t: number, w: number }[]>([])\n    const animationRef = useRef<number>()\n    const timeRef = useRef(0)\n    const dt = 0.02\n\n    // --- TÍNH TOÁN ---\n    const beta = ENVIRONMENTS[env].beta\n    const omega = 2 * Math.PI * params.f\n\n    // Tính trạng thái x, v, a tại thời điểm t\n    const calculateState = useCallback((t: number) => {\n        // Phase\n        const phase = omega * t + params.phi\n        const exp = Math.exp(-beta * t)\n\n        // Li độ x\n        const x = params.A * exp * Math.cos(phase)\n        const envelope = params.A * exp\n\n        // Vận tốc v = dx/dt\n        const v = -beta * x - params.A * exp * omega * Math.sin(phase)\n\n        // Gia tốc a = dv/dt\n        const a = -2 * beta * v - (beta * beta + omega * omega) * x\n\n        // Năng lượng (xấp xỉ)\n        const w0 = 0.5 * params.k * (params.A / 100) ** 2\n        const w = w0 * Math.exp(-2 * beta * t)\n\n        return { x, v, a, envelope, w }\n    }, [beta, omega, params.A, params.k, params.phi])\n\n    // --- GENERATE SVG PATHS ---\n    const width = 800\n    const height = 380\n    const centerY = height / 2\n    const shift = Math.max(0, time - GRAPH_WINDOW)\n    const timeScale = width / GRAPH_WINDOW\n\n    const generatePaths = useCallback(() => {\n        const points = []\n        const envTop = []\n        const envBot = []\n\n        const scaleV = omega > 0 ? 1 / omega : 1;\n        const scaleA = omega > 0 ? 1 / (omega * omega) : 1;\n\n        for (let i = 0; i <= width; i += 2) {\n            const t_plot = shift + i / timeScale\n            const state = calculateState(t_plot)\n\n            let val = 0;\n            if (graphMode === 'x') val = state.x;\n            else if (graphMode === 'v') val = state.v * scaleV;\n            else if (graphMode === 'a') val = state.a * scaleA;\n\n            points.push(`${i},${centerY - val}`)\n\n            if (graphMode === 'x') {\n                envTop.push(`${i},${centerY - state.envelope}`)\n                envBot.push(`${i},${centerY + state.envelope}`)\n            }\n        }\n\n        return {\n            wave: `M ${points.join(\" L \")}`,\n            envTop: graphMode === 'x' ? `M ${envTop.join(\" L \")}` : \"\",\n            envBot: graphMode === 'x' ? `M ${envBot.join(\" L \")}` : \"\",\n        }\n    }, [calculateState, graphMode, timeScale, centerY, omega, shift])\n\n    const paths = generatePaths()\n    const cx = (time - shift) * timeScale\n    const currState = calculateState(time)\n\n    // Value to display for the dot (normalized)\n    let currentDisplayVal = currState.x;\n    if (graphMode === 'v') currentDisplayVal = currState.v * (omega > 0 ? 1 / omega : 1);\n    if (graphMode === 'a') currentDisplayVal = currState.a * (omega > 0 ? 1 / (omega * omega) : 1);\n\n\n    // --- DRAW ENERGY GRAPH ---\n    const drawEnergy = useCallback((ctx: CanvasRenderingContext2D) => {\n        const w = ctx.canvas.width; const h = ctx.canvas.height;\n\n        ctx.fillStyle = \"#0f172a\"; ctx.fillRect(0, 0, w, h);\n        ctx.strokeStyle = \"#1e293b\"; ctx.lineWidth = 0.5; ctx.beginPath();\n        for (let x = 0; x < w; x += w / 10) { ctx.moveTo(x, 0); ctx.lineTo(x, h) }\n        ctx.stroke();\n\n        const history = energyHistoryRef.current;\n        if (history.length < 2) return;\n\n        const maxE = history[0].w || 1;\n        const yScale = (h - 20) / maxE;\n\n        ctx.strokeStyle = \"#eab308\"; ctx.lineWidth = 2; ctx.beginPath();\n        let started = false\n        history.forEach((pt) => {\n            if (pt.t < shift) return;\n            const x = (pt.t - shift) * (w / GRAPH_WINDOW);\n            const y = h - 10 - (pt.w * yScale);\n            if (!started) { ctx.moveTo(x, y); started = true; }\n            else ctx.lineTo(x, y);\n        });\n        ctx.stroke();\n\n        // Simplified Fill\n        ctx.fillStyle = \"rgba(234, 179, 8, 0.1)\";\n        // Need a closed path for fill, but simple stroke is enough for now or complex close\n\n    }, [shift])\n\n    // --- LOOP ---\n    const animate = useCallback(() => {\n        if (isPlaying) {\n            timeRef.current += dt;\n            setTime(timeRef.current);\n\n            const state = calculateState(timeRef.current);\n            if (timeRef.current % 0.1 < dt) {\n                energyHistoryRef.current.push({ t: timeRef.current, w: state.w });\n                if (energyHistoryRef.current.length > 5000) energyHistoryRef.current.shift();\n            }\n        }\n        if (energyCanvasRef.current) drawEnergy(energyCanvasRef.current.getContext('2d')!);\n        animationRef.current = requestAnimationFrame(animate);\n    }, [isPlaying, drawEnergy, calculateState]);\n\n    useEffect(() => {\n        animationRef.current = requestAnimationFrame(animate);\n        return () => { if (animationRef.current) cancelAnimationFrame(animationRef.current); }\n    }, [animate]);\n\n    useEffect(() => {\n        if (!isPlaying && energyCanvasRef.current) {\n            drawEnergy(energyCanvasRef.current.getContext('2d')!);\n        }\n    }, [params, env, drawEnergy, isPlaying])\n\n    const handleReset = () => { setIsPlaying(false); timeRef.current = 0; setTime(0); energyHistoryRef.current = []; }\n    const handleStep = (dir: number) => { setIsPlaying(false); timeRef.current = Math.max(0, timeRef.current + dir * 0.5); setTime(timeRef.current); }\n\n    // Màu sắc cho từng chế độ\n    const getGraphColor = () => {\n        if (graphMode === 'x') return ENVIRONMENTS[env].color;\n        if (graphMode === 'v') return '#22c55e'; // Green\n        if (graphMode === 'a') return '#ef4444'; // Red\n        return '#fff';\n    }\n\n    return (\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n            {/* CỘT TRÁI */}\n            <div className=\"lg:col-span-2 space-y-4\">\n\n                {/* Main Visual (SVG) */}\n                <div className=\"bg-[#1e293b] rounded-xl border border-slate-700/50 shadow-lg relative overflow-hidden h-[380px]\">\n                    {/* Mode Selector (Tabs) */}\n                    <div className=\"absolute top-4 right-4 z-20 flex bg-slate-900/80 backdrop-blur rounded-lg p-1 border border-slate-700\">\n                        <button onClick={() => setGraphMode('x')} className={`px-3 py-1 rounded text-xs font-bold transition-colors ${graphMode === 'x' ? 'bg-cyan-600 text-white' : 'text-slate-400 hover:text-white'}`}>x(t)</button>\n                        <button onClick={() => setGraphMode('v')} className={`px-3 py-1 rounded text-xs font-bold transition-colors ${graphMode === 'v' ? 'bg-green-600 text-white' : 'text-slate-400 hover:text-white'}`}>v(t)</button>\n                        <button onClick={() => setGraphMode('a')} className={`px-3 py-1 rounded text-xs font-bold transition-colors ${graphMode === 'a' ? 'bg-red-500 text-white' : 'text-slate-400 hover:text-white'}`}>a(t)</button>\n                    </div>\n\n                    {/* SVG Layer */}\n                    <svg width=\"100%\" height=\"100%\" viewBox={`0 0 ${width} ${height}`} className=\"bg-[#0f172a] absolute inset-0\">\n                        <GridBackground />\n                        <rect width=\"100%\" height=\"100%\" fill=\"url(#grid)\" opacity=\"0.5\" />\n\n                        {/* Trục tọa độ */}\n                        <line x1=\"0\" y1={centerY} x2={width} y2={centerY} stroke=\"#475569\" strokeWidth=\"1\" />\n                        <line x1=\"2\" y1=\"0\" x2=\"2\" y2={height} stroke=\"#475569\" strokeWidth=\"1\" />\n\n                        {/* Đường bao (Chỉ hiện khi xem x) */}\n                        {beta > 0 && graphMode === 'x' && (\n                            <>\n                                <path d={paths.envTop} fill=\"none\" stroke=\"#94a3b8\" strokeDasharray=\"4 4\" strokeWidth=\"1\" opacity=\"0.5\" />\n                                <path d={paths.envBot} fill=\"none\" stroke=\"#94a3b8\" strokeDasharray=\"4 4\" strokeWidth=\"1\" opacity=\"0.5\" />\n                            </>\n                        )}\n\n                        {/* Đường sóng (Wave) */}\n                        <path\n                            d={paths.wave}\n                            fill=\"none\"\n                            stroke={getGraphColor()}\n                            strokeWidth=\"3\"\n                            filter=\"drop-shadow(0 0 4px currentColor)\"\n                        />\n\n                        {/* Điểm chạy (Scan Line & Point) */}\n                        {cx < width && (\n                            <g>\n                                <line x1={cx} y1=\"0\" x2={cx} y2={height} stroke=\"#facc15\" strokeWidth=\"1\" opacity=\"0.3\" />\n                                <g transform={`translate(${cx}, ${centerY - currentDisplayVal})`}>\n                                    <circle r=\"6\" fill=\"#facc15\" stroke=\"white\" strokeWidth=\"2\" />\n                                    <line x1=\"0\" y1=\"0\" x2=\"0\" y2={currentDisplayVal} stroke=\"#facc15\" strokeDasharray=\"2 2\" opacity=\"0.5\" />\n                                </g>\n                            </g>\n                        )}\n                    </svg>\n\n                    {/* Labels Overlay */}\n                    <div className=\"absolute top-4 left-4 bg-slate-900/80 backdrop-blur px-3 py-2 rounded-lg border border-slate-700 text-xs font-mono flex gap-2\" style={{ color: getGraphColor() }}>\n                        <Activity size={14} />\n                        {graphMode === 'x' && \"Đồ thị Li độ x(t)\"}\n                        {graphMode === 'v' && \"Đồ thị Vận tốc v(t)\"}\n                        {graphMode === 'a' && \"Đồ thị Gia tốc a(t)\"}\n                    </div>\n\n                    {/* Info Panel Integrated into Canvas (Bottom Right - MOVED HERE) */}\n                    <div className=\"absolute bottom-4 right-4 bg-slate-900/80 backdrop-blur p-3 rounded-lg border border-slate-700/50 text-xs font-mono shadow-lg min-w-[180px] z-10\">\n                        <div className=\"flex justify-between mb-1\">\n                            <span className=\"text-slate-400\">t:</span>\n                            <span className=\"text-white\">{time.toFixed(2)}s</span>\n                        </div>\n                        <div className=\"flex justify-between mb-1\">\n                            <span className=\"text-slate-400\">x:</span>\n                            <span className=\"text-cyan-400\">{currState.x.toFixed(1)} px</span>\n                        </div>\n                        <div className=\"flex justify-between mb-1\">\n                            <span className=\"text-slate-400\">v:</span>\n                            <span className=\"text-green-400\">{currState.v.toFixed(1)}</span>\n                        </div>\n                        <div className=\"flex justify-between mb-1\">\n                            <span className=\"text-slate-400\">a:</span>\n                            <span className=\"text-red-400\">{currState.a.toFixed(1)}</span>\n                        </div>\n                        {beta > 0 && (\n                            <div className=\"flex justify-between border-t border-slate-700 mt-1 pt-1\">\n                                <span className=\"text-slate-500\">Env:</span>\n                                <span className=\"text-slate-300\">{currState.envelope.toFixed(1)}</span>\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Signature (Bottom Left - MOVED HERE) */}\n                    <div className=\"absolute bottom-4 left-4 text-[10px] font-mono text-slate-600\">\n                        Hô Hoàng Anh A1K50\n                    </div>\n                </div>\n\n                {/* Controls */}\n                <div className=\"bg-[#1e293b] rounded-xl p-3 border border-slate-700/50 shadow-md flex items-center gap-4\">\n                    <div className=\"flex items-center gap-2\">\n                        <button onClick={handleReset} className=\"w-10 h-10 rounded-lg bg-slate-700 hover:bg-slate-600 text-slate-300 flex items-center justify-center transition-all active:scale-95\"><RotateCcw size={18} /></button>\n                        <button onClick={() => handleStep(-1)} className=\"w-10 h-10 rounded-lg bg-slate-700 hover:bg-slate-600 text-slate-300 flex items-center justify-center transition-all active:scale-95\"><SkipBack size={18} /></button>\n                        <button onClick={() => setIsPlaying(!isPlaying)} className={`w-12 h-12 rounded-xl flex items-center justify-center transition-all shadow-lg active:scale-95 ${isPlaying ? 'bg-amber-500 hover:bg-amber-400 text-white' : 'bg-cyan-500 hover:bg-cyan-400 text-white'}`}>\n                            {isPlaying ? <Pause size={24} fill=\"currentColor\" /> : <Play size={24} fill=\"currentColor\" className=\"ml-1\" />}\n                        </button>\n                        <button onClick={() => handleStep(1)} className=\"w-10 h-10 rounded-lg bg-slate-700 hover:bg-slate-600 text-slate-300 flex items-center justify-center transition-all active:scale-95\"><SkipForward size={18} /></button>\n                    </div>\n                    <div className=\"flex-1\"></div>\n                </div>\n\n                {/* Energy Graph */}\n                <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50 shadow-md\">\n                    <div className=\"flex justify-between items-center mb-2\">\n                        <h3 className=\"text-xs font-bold text-yellow-500 uppercase flex items-center gap-2\"><TrendingDown size={14} /> Sự hao hụt cơ năng</h3>\n                        <div className=\"text-[10px] font-mono text-yellow-400 font-bold\">\n                            Năng lượng (W) = {(currState.w * 1000).toFixed(2)} mJ\n                        </div>\n                    </div>\n                    <div className=\"relative w-full h-32 bg-[#0f172a] rounded-lg border border-slate-700 overflow-hidden\">\n                        <canvas ref={energyCanvasRef} width={800} height={128} className=\"w-full h-full\" />\n                    </div>\n                </div>\n            </div>\n\n            {/* CỘT PHẢI */}\n            <div className=\"lg:col-span-1 space-y-4 flex flex-col\">\n                {/* Environment Selector */}\n                <div className=\"bg-[#1e293b] rounded-xl border border-slate-700/50 p-4 shadow-sm\">\n                    <h3 className=\"text-slate-300 font-bold text-xs uppercase mb-3 flex items-center gap-2\"><Settings size={14} /> Môi trường cản</h3>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                        {Object.entries(ENVIRONMENTS).map(([key, val]) => {\n                            const IconComp = val.icon;\n                            return (\n                                <button key={key} onClick={() => { setEnv(key); handleReset(); }} className={`p-2 rounded-lg border text-xs font-bold flex items-center gap-2 transition-all ${env === key ? 'bg-cyan-900/40 border-cyan-500 text-cyan-400' : 'bg-slate-800 border-transparent text-slate-400 hover:bg-slate-700'}`}>\n                                    <IconComp size={14} /> {val.name}\n                                </button>\n                            )\n                        })}\n                    </div>\n                </div>\n\n                {/* Config */}\n                <ControlPanel title=\"Cấu hình hệ thống\" icon={Settings}>\n                    <div className=\"space-y-4\">\n                        <div>\n                            <div className=\"flex justify-between text-xs text-slate-400 mb-1\"><span>Tần số (f)</span> <span className=\"text-cyan-400 font-mono\">{params.f} Hz</span></div>\n                            <input type=\"range\" min=\"0.1\" max=\"2\" step=\"0.1\" value={params.f} onChange={(e) => { setParams({ ...params, f: Number(e.target.value) }); handleReset(); }} className=\"w-full accent-cyan-500 h-1.5 bg-slate-700 rounded-lg cursor-pointer\" />\n                        </div>\n                        <div>\n                            <div className=\"flex justify-between text-xs text-slate-400 mb-1\"><span>Biên độ đầu (A)</span> <span className=\"text-cyan-400 font-mono\">{params.A} px</span></div>\n                            <input type=\"range\" min=\"20\" max=\"150\" value={params.A} onChange={(e) => { setParams({ ...params, A: Number(e.target.value) }); handleReset(); }} className=\"w-full accent-cyan-500 h-1.5 bg-slate-700 rounded-lg cursor-pointer\" />\n                        </div>\n                        <div>\n                            <div className=\"flex justify-between text-xs text-slate-400 mb-1\"><span>Pha ban đầu (φ)</span> <span className=\"text-cyan-400 font-mono\">{params.phi.toFixed(2)}</span></div>\n                            <input type=\"range\" min=\"0\" max=\"6.28\" step=\"0.1\" value={params.phi} onChange={(e) => { setParams({ ...params, phi: Number(e.target.value) }); handleReset(); }} className=\"w-full accent-cyan-500 h-1.5 bg-slate-700 rounded-lg cursor-pointer\" />\n                        </div>\n                    </div>\n                    <div className=\"mt-4 pt-4 border-t border-slate-700/50 text-xs text-slate-400 font-mono space-y-1\">\n                        <p>x = A·e^(-βt)·cos(ωt + φ)</p>\n                        <p>β = {beta} (Hệ số tắt dần)</p>\n                    </div>\n                </ControlPanel>\n            </div>\n        </div >\n    )\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4419, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/harmonic-oscillation.tsx"],"sourcesContent":["\"use client\"\n\nimport { useRef, useEffect, useState, useCallback } from \"react\"\nimport { Zap, RotateCcw, SkipBack, Pause, Play, SkipForward, ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { useCanvasScale } from \"@/hooks/use-canvas-scale\"\n\n// Special angles in degrees within one circle (0 to 360)\nconst SPECIAL_ANGLES_DEG = [0, 30, 45, 60, 90, 120, 135, 150, 180, 210, 225, 240, 270, 300, 315, 330]\nconst SPECIAL_ANGLES_RAD = SPECIAL_ANGLES_DEG.map((d) => (d * Math.PI) / 180)\n\nexport default function HarmonicOscillation() {\n  const containerRef = useRef<HTMLDivElement>(null)\n  const canvasRef = useRef<HTMLCanvasElement>(null)\n\n  const [isPlaying, setIsPlaying] = useState(false)\n  const [time, setTime] = useState(0)\n\n  // Use Responsive Canvas Hook\n  const { width, height, pixelRatio } = useCanvasScale(containerRef)\n\n  const [showGraph, setShowGraph] = useState({ x: true, v: true, a: true })\n\n  const [params, setParams] = useState({\n    amplitude: 10,\n    frequency: 0.5,\n    phase: 0,\n  })\n\n  const animationRef = useRef<number>()\n  const timeRef = useRef(0)\n\n  const omega = 2 * Math.PI * params.frequency\n  const T = 1 / params.frequency\n  const dt = 0.016\n\n  const calculateState = useCallback(\n    (t: number) => {\n      const x = params.amplitude * Math.cos(omega * t + params.phase)\n      const v = -params.amplitude * omega * Math.sin(omega * t + params.phase)\n      const a = -params.amplitude * omega * omega * Math.cos(omega * t + params.phase)\n      return { x, v, a }\n    },\n    [params.amplitude, omega, params.phase],\n  )\n\n  const draw = useCallback(\n    (ctx: CanvasRenderingContext2D, t: number) => {\n      // Use dynamic width/height from hook\n      const currWidth = width\n      const currHeight = height\n\n      // Determine Layout based on available width\n      // If width is small (< 600), maybe reduce circle section or scaling\n      const isSmallScreen = currWidth < 600\n      const circleSectionWidth = isSmallScreen ? currWidth * 0.4 : 300\n      const graphStartX = circleSectionWidth + 20\n      const graphWidth = currWidth - graphStartX - 20\n      const centerX = circleSectionWidth / 2\n      const centerY = currHeight / 2\n\n      ctx.clearRect(0, 0, currWidth, currHeight)\n\n      // Background\n      ctx.fillStyle = \"#0f172a\"\n      ctx.fillRect(0, 0, currWidth, currHeight)\n\n      // --- CIRCLE SECTION ---\n      // Scale radius down if screen is small\n      const maxRadius = isSmallScreen ? Math.min(80, circleSectionWidth / 2 - 20) : 80\n      const radius = maxRadius\n\n      const angle = omega * t + params.phase\n\n      // Circle Grid/Axes\n      ctx.strokeStyle = \"#1e293b\"\n      ctx.lineWidth = 1\n      ctx.beginPath()\n      ctx.moveTo(centerX, centerY - radius - 30)\n      ctx.lineTo(centerX, centerY + radius + 30)\n      ctx.moveTo(centerX - radius - 30, centerY)\n      ctx.lineTo(centerX + radius + 30, centerY)\n      ctx.stroke()\n\n      // Main Circle\n      ctx.strokeStyle = \"#475569\"\n      ctx.lineWidth = 2\n      ctx.beginPath()\n      ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI)\n      ctx.stroke()\n\n      // Vector\n      const vectorX = centerX + radius * Math.cos(angle)\n      const vectorY = centerY - radius * Math.sin(angle)\n\n      ctx.strokeStyle = \"#f97316\"\n      ctx.lineWidth = 3\n      ctx.beginPath()\n      ctx.moveTo(centerX, centerY)\n      ctx.lineTo(vectorX, vectorY)\n      ctx.stroke()\n\n      ctx.fillStyle = \"#f97316\"\n      ctx.beginPath()\n      ctx.arc(vectorX, vectorY, 6, 0, 2 * Math.PI)\n      ctx.fill()\n\n      // --- GRAPH SECTION (MERGED) ---\n\n      const graphTop = 20\n      const graphBottom = currHeight - 20\n      const graphHeight = graphBottom - graphTop\n      const graphCenterY = graphTop + graphHeight / 2\n\n      // Draw Axis Line\n      ctx.strokeStyle = \"#334155\"\n      ctx.lineWidth = 1\n      ctx.beginPath()\n      ctx.moveTo(graphStartX, graphCenterY)\n      ctx.lineTo(graphStartX + graphWidth, graphCenterY)\n      ctx.stroke()\n\n      // Time Window (History length)\n      const timeWindow = 2.5 * T\n      const quarterT = T / 4\n      const tEnd = t\n      const tStart = t - timeWindow\n\n      const kStart = Math.ceil(tStart / quarterT)\n      const kEnd = Math.floor(tEnd / quarterT)\n\n      // Draw Grid Lines (Time)\n      ctx.textAlign = \"center\"\n      ctx.font = \"10px monospace\"\n\n      for (let k = kStart; k <= kEnd; k++) {\n        if (k < 0) continue\n        const tGrid = k * quarterT\n        const xPos = graphStartX + graphWidth - ((tEnd - tGrid) / timeWindow) * graphWidth\n\n        // Only draw inside graph area\n        if (xPos < graphStartX || xPos > graphStartX + graphWidth) continue\n\n        // Grid Line\n        ctx.strokeStyle = \"#334155\"\n        ctx.lineWidth = 1\n        ctx.setLineDash([2, 2])\n        ctx.beginPath()\n        ctx.moveTo(xPos, graphTop)\n        ctx.lineTo(xPos, graphBottom)\n        ctx.stroke()\n        ctx.setLineDash([])\n\n        // Grid Label\n        if (xPos > graphStartX + 10 && xPos < graphStartX + graphWidth + 10) {\n          ctx.fillStyle = \"#94a3b8\"\n          let gridLabel = \"\"\n          if (k === 0) gridLabel = \"0\"\n          else if (k % 4 === 0) gridLabel = `${k / 4}T`\n          else if (k % 2 === 0) gridLabel = `${k / 2}T/2`\n          else gridLabel = `${k}T/4`\n\n          ctx.fillText(gridLabel, xPos, graphBottom + 10)\n        }\n      }\n\n      const drawCurve = (\n        getValue: (wt: number) => number,\n        maxValue: number,\n        color: string\n      ) => {\n        ctx.strokeStyle = color\n        ctx.lineWidth = 2\n        ctx.beginPath()\n\n        const step = 2\n        let started = false\n\n        for (let i = 0; i <= graphWidth; i += step) {\n          const waveT = tStart + (i / graphWidth) * timeWindow\n          if (waveT < 0) continue\n\n          const val = getValue(waveT)\n          const scale = (graphHeight / 2) * 0.8 // 80% of half height\n          const y = graphCenterY - (val / maxValue) * scale\n\n          if (!started) {\n            ctx.moveTo(graphStartX + i, y)\n            started = true\n          } else {\n            ctx.lineTo(graphStartX + i, y)\n          }\n        }\n        ctx.stroke()\n\n        // Draw Current Value Dot\n        const currentVal = getValue(t)\n        const currentY = graphCenterY - (currentVal / maxValue) * ((graphHeight / 2) * 0.8)\n\n        if (currentY >= graphTop - 10 && currentY <= graphBottom + 10) {\n          ctx.fillStyle = color\n          ctx.beginPath()\n          ctx.arc(graphStartX + graphWidth, currentY, 4, 0, 2 * Math.PI)\n          ctx.fill()\n        }\n      }\n\n      // Draw Curves\n      if (showGraph.x) {\n        drawCurve(\n          (wt) => params.amplitude * Math.cos(omega * wt + params.phase),\n          params.amplitude,\n          \"#ef4444\"\n        )\n      }\n      if (showGraph.v) {\n        drawCurve(\n          (wt) => -params.amplitude * omega * Math.sin(omega * wt + params.phase),\n          params.amplitude * omega,\n          \"#22c55e\"\n        )\n      }\n      if (showGraph.a) {\n        drawCurve(\n          (wt) => -params.amplitude * omega * omega * Math.cos(omega * wt + params.phase),\n          params.amplitude * omega * omega,\n          \"#3b82f6\"\n        )\n      }\n\n      // Signature\n      ctx.fillStyle = \"rgba(255, 255, 255, 0.15)\"\n      ctx.font = \"12px monospace\"\n      ctx.textAlign = \"right\"\n      ctx.fillText(\"Hô Hoàng Anh A1K50\", currWidth - 15, currHeight - 15)\n\n      // Info overlay (Updated)\n      const currentState = calculateState(t)\n      const infoWidth = 160\n      const infoHeight = 110 // Increased height\n      ctx.fillStyle = \"rgba(15, 23, 42, 0.9)\"\n      ctx.fillRect(10, 10, infoWidth, infoHeight)\n      ctx.strokeStyle = \"rgba(56, 189, 248, 0.3)\"\n      ctx.strokeRect(10, 10, infoWidth, infoHeight)\n\n      ctx.font = \"13px monospace\"\n      ctx.textAlign = \"left\"\n\n      // Time\n      ctx.fillStyle = \"#e2e8f0\"\n      ctx.fillText(`t = ${t.toFixed(3)}s`, 20, 30)\n\n      // Values\n      ctx.fillStyle = \"#ef4444\" // Red for x\n      ctx.fillText(`x = ${currentState.x.toFixed(2)} cm`, 20, 55)\n\n      ctx.fillStyle = \"#22c55e\" // Green for v\n      ctx.fillText(`v = ${currentState.v.toFixed(2)} cm/s`, 20, 75)\n\n      ctx.fillStyle = \"#3b82f6\" // Blue for a\n      ctx.fillText(`a = ${currentState.a.toFixed(2)} cm/s²`, 20, 95)\n\n    },\n    [params.amplitude, params.phase, omega, calculateState, showGraph, T, width, height],\n  )\n\n  const animate = useCallback(() => {\n    // Only animate if canvas is available\n    if (!canvasRef.current || width === 0 || height === 0) return\n\n    // We can render directly using 'draw' since we have the context via ref or we can get it here\n    const canvas = canvasRef.current\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n\n    // Check pixel ratio scaling \n    if (canvas.width !== width * pixelRatio || canvas.height !== height * pixelRatio) {\n      canvas.width = width * pixelRatio\n      canvas.height = height * pixelRatio\n    }\n\n    // Scale Context\n    ctx.save()\n    ctx.scale(pixelRatio, pixelRatio)\n\n    if (isPlaying) {\n      timeRef.current += dt\n      setTime(timeRef.current)\n    }\n\n    draw(ctx, timeRef.current)\n    ctx.restore()\n\n    if (isPlaying) {\n      animationRef.current = requestAnimationFrame(animate)\n    }\n  }, [isPlaying, draw, width, height, pixelRatio])\n\n  useEffect(() => {\n    // Start animation loop\n    if (isPlaying) {\n      animationRef.current = requestAnimationFrame(animate)\n    }\n    return () => {\n      if (animationRef.current) cancelAnimationFrame(animationRef.current)\n    }\n  }, [isPlaying, animate])\n\n  // Need a separate effect to draw when NOT playing (paused or init)\n  // And to handle resize (width/height change)\n  useEffect(() => {\n    if (!isPlaying && canvasRef.current && width > 0 && height > 0) {\n      const canvas = canvasRef.current\n      const ctx = canvas.getContext(\"2d\")\n      if (!ctx) return\n\n      if (canvas.width !== width * pixelRatio || canvas.height !== height * pixelRatio) {\n        canvas.width = width * pixelRatio\n        canvas.height = height * pixelRatio\n      }\n\n      ctx.save()\n      ctx.scale(pixelRatio, pixelRatio)\n      draw(ctx, timeRef.current)\n      ctx.restore()\n    }\n  }, [isPlaying, draw, width, height, pixelRatio]) // Trigger on resize\n\n  const handleManualUpdate = (newTime: number) => {\n    setIsPlaying(false)\n    timeRef.current = Math.max(0, newTime)\n    setTime(timeRef.current)\n    // Draw will be triggered by useEffect due to state change? No, timeRef doesn't trigger effect\n    // But setTime does trigger render. \n    // Wait, draw is in useEffect dep list because it depends on calculations? \n    // Ideally we force a redraw here.\n    if (canvasRef.current && width > 0) {\n      const ctx = canvasRef.current.getContext(\"2d\")\n      if (ctx) {\n        ctx.save()\n        ctx.scale(pixelRatio, pixelRatio)\n        draw(ctx, timeRef.current)\n        ctx.restore()\n      }\n    }\n  }\n\n  // Handle large jumps\n  const handleSkip = (direction: number) => {\n    handleManualUpdate(timeRef.current + direction * 0.5)\n  }\n\n  const handleReset = () => {\n    handleManualUpdate(0)\n  }\n\n  // Handle Micro Step (T/80)\n  const handleMicroStep = (direction: number) => {\n    const stepTime = T / 80\n    const epsilon = 1e-4\n    const currentPhaseTotal = omega * timeRef.current + params.phase\n    const currentPhaseNorm = currentPhaseTotal % (2 * Math.PI)\n    const currentPhasePos = currentPhaseNorm < 0 ? currentPhaseNorm + 2 * Math.PI : currentPhaseNorm\n    let targetTime = timeRef.current + direction * stepTime\n    const stepPhase = (2 * Math.PI) / 80\n\n    if (direction > 0) {\n      let nextSpecial = SPECIAL_ANGLES_RAD.find(a => a > currentPhasePos + epsilon)\n      let distance = 0\n      if (nextSpecial !== undefined) distance = nextSpecial - currentPhasePos\n      else {\n        nextSpecial = SPECIAL_ANGLES_RAD[0] + 2 * Math.PI\n        distance = nextSpecial - currentPhasePos\n      }\n      if (distance <= stepPhase + epsilon) targetTime = timeRef.current + distance / omega\n    } else {\n      const reversed = [...SPECIAL_ANGLES_RAD].reverse()\n      let prevSpecial = reversed.find(a => a < currentPhasePos - epsilon)\n      let distance = 0\n      if (prevSpecial !== undefined) distance = currentPhasePos - prevSpecial\n      else {\n        prevSpecial = SPECIAL_ANGLES_RAD[SPECIAL_ANGLES_RAD.length - 1] - 2 * Math.PI\n        distance = currentPhasePos - prevSpecial\n      }\n      if (distance <= stepPhase + epsilon) targetTime = timeRef.current - distance / omega\n    }\n\n    handleManualUpdate(targetTime)\n  }\n\n  const state = calculateState(time)\n  const kineticEnergy = (0.5 * state.v * state.v) / 10000\n  const potentialEnergy = (0.5 * omega * omega * state.x * state.x) / 10000\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n      <div className=\"lg:col-span-2 space-y-4\">\n        {/* Main Canvas Container - RESPONSIVE */}\n        <div\n          ref={containerRef}\n          className=\"bg-[#1e293b] rounded-xl overflow-hidden border border-slate-700/50 relative w-full h-[400px]\"\n        >\n          {/* Toggle buttons */}\n          <div className=\"absolute top-4 right-4 flex gap-2 z-10 bg-[#0f172a]/80 p-1 rounded-lg backdrop-blur-sm border border-slate-700\">\n            <button\n              onClick={() => setShowGraph((p) => ({ ...p, x: !p.x }))}\n              className={`px-2 py-1 text-[10px] font-bold rounded transition-all ${showGraph.x ? \"bg-red-500 text-white\" : \"bg-slate-700 text-slate-400\"}`}\n            >\n              x(t)\n            </button>\n            <button\n              onClick={() => setShowGraph((p) => ({ ...p, v: !p.v }))}\n              className={`px-2 py-1 text-[10px] font-bold rounded transition-all ${showGraph.v ? \"bg-green-500 text-white\" : \"bg-slate-700 text-slate-400\"}`}\n            >\n              v(t)\n            </button>\n            <button\n              onClick={() => setShowGraph((p) => ({ ...p, a: !p.a }))}\n              className={`px-2 py-1 text-[10px] font-bold rounded transition-all ${showGraph.a ? \"bg-blue-500 text-white\" : \"bg-slate-700 text-slate-400\"}`}\n            >\n              a(t)\n            </button>\n          </div>\n\n          <canvas ref={canvasRef} className=\"w-full h-full block\" />\n        </div>\n\n        <div className=\"bg-[#1e293b] rounded-xl p-3 border border-slate-700/50 flex flex-wrap items-center justify-center gap-3\">\n          <button onClick={handleReset} className=\"w-10 h-10 rounded-lg bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n            <RotateCcw size={16} />\n          </button>\n          <div className=\"w-[1px] h-8 bg-slate-700 mx-1\"></div>\n          <button onClick={() => handleSkip(-1)} className=\"w-10 h-10 rounded-lg bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n            <SkipBack size={16} />\n          </button>\n          <button onClick={() => handleMicroStep(-1)} className=\"w-12 h-12 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-600 text-cyan-400 flex items-center justify-center transition-all shadow-md active:scale-95 ring-1 ring-slate-700/50\">\n            <ChevronLeft size={24} />\n          </button>\n          <button\n            onClick={() => setIsPlaying(!isPlaying)}\n            className={`w-14 h-14 rounded-2xl flex items-center justify-center transition-all shadow-lg active:scale-95 border border-transparent mx-2 ${isPlaying ? \"bg-amber-500 hover:bg-amber-400 shadow-amber-900/20\" : \"bg-cyan-500 hover:bg-cyan-400 shadow-cyan-500/30\"\n              } text-white`}\n          >\n            {isPlaying ? <Pause size={28} fill=\"currentColor\" /> : <Play size={28} fill=\"currentColor\" className=\"ml-1\" />}\n          </button>\n          <button onClick={() => handleMicroStep(1)} className=\"w-12 h-12 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-600 text-cyan-400 flex items-center justify-center transition-all shadow-md active:scale-95 ring-1 ring-slate-700/50\">\n            <ChevronRight size={24} />\n          </button>\n          <button onClick={() => handleSkip(1)} className=\"w-10 h-10 rounded-lg bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\">\n            <SkipForward size={16} />\n          </button>\n        </div>\n      </div>\n\n      <div className=\"space-y-4\">\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50\">\n          <h3 className=\"text-cyan-400 font-semibold mb-4 text-sm\">Thông số dao động</h3>\n          <div className=\"space-y-4\">\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <label className=\"text-slate-400\">Biên độ A</label>\n                <span className=\"text-cyan-400 font-mono\">{params.amplitude} cm</span>\n              </div>\n              <input type=\"range\" min=\"20\" max=\"150\" value={params.amplitude} onChange={(e) => setParams({ ...params, amplitude: Number(e.target.value) })} className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg cursor-pointer\" />\n            </div>\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <label className=\"text-slate-400\">Tần số f (Chu kỳ T = {(1 / params.frequency).toFixed(2)}s)</label>\n                <span className=\"text-cyan-400 font-mono\">{params.frequency} Hz</span>\n              </div>\n              <input type=\"range\" min=\"0.1\" max=\"2\" step=\"0.1\" value={params.frequency} onChange={(e) => setParams({ ...params, frequency: Number(e.target.value) })} className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg cursor-pointer\" />\n            </div>\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <label className=\"text-slate-400\">Pha ban đầu φ</label>\n                <span className=\"text-cyan-400 font-mono\">{params.phase.toFixed(2)} rad</span>\n              </div>\n              <input type=\"range\" min=\"0\" max={Math.PI * 2} step=\"0.1\" value={params.phase} onChange={(e) => setParams({ ...params, phase: Number(e.target.value) })} className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg cursor-pointer\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50\">\n          <h3 className=\"text-amber-400 font-semibold mb-3 text-sm flex items-center gap-2\">\n            <Zap size={14} /> Năng lượng\n          </h3>\n          <div className=\"space-y-3\">\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <span className=\"text-green-400\">Động năng Wđ</span>\n                <span className=\"text-green-400 font-mono\">{kineticEnergy.toFixed(3)} J</span>\n              </div>\n              <div className=\"h-2 bg-slate-700 rounded-full overflow-hidden\">\n                <div className=\"h-full bg-green-500 transition-all duration-100\" style={{ width: `${(kineticEnergy / (kineticEnergy + potentialEnergy || 1)) * 100}%` }} />\n              </div>\n            </div>\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <span className=\"text-blue-400\">Thế năng Wt</span>\n                <span className=\"text-blue-400 font-mono\">{potentialEnergy.toFixed(3)} J</span>\n              </div>\n              <div className=\"h-2 bg-slate-700 rounded-full overflow-hidden\">\n                <div className=\"h-full bg-blue-500 transition-all duration-100\" style={{ width: `${(potentialEnergy / (kineticEnergy + potentialEnergy || 1)) * 100}%` }} />\n              </div>\n            </div>\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <span className=\"text-yellow-400\">Cơ năng W</span>\n                <span className=\"text-yellow-400 font-mono\">{(kineticEnergy + potentialEnergy).toFixed(3)} J</span>\n              </div>\n              <div className=\"h-2 bg-yellow-500/30 rounded-full\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50\">\n          <h3 className=\"text-cyan-400 font-semibold mb-2 text-sm\">Công thức</h3>\n          <div className=\"text-xs text-slate-300 space-y-1 font-mono\">\n            <p className=\"flex justify-between\"><span>x = A·cos(ωt + φ)</span> <span className=\"text-red-400\">Li độ</span></p>\n            <p className=\"flex justify-between\"><span>v = -Aω·sin(ωt + φ)</span> <span className=\"text-green-400\">Vận tốc</span></p>\n            <p className=\"flex justify-between\"><span>a = -Aω²·cos(ωt + φ)</span> <span className=\"text-blue-400\">Gia tốc</span></p>\n            <div className=\"w-full h-[1px] bg-slate-700 my-2\"></div>\n            <p>ω = 2πf = {omega.toFixed(2)} rad/s</p>\n            <p>T = 1/f = {(1 / params.frequency).toFixed(2)} s</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5508, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/mechanical-waves.tsx"],"sourcesContent":["\"use client\"\n\nimport { useRef, useEffect, useState, useCallback } from \"react\"\nimport { Play, Pause, RotateCcw, SkipForward, SkipBack } from \"lucide-react\"\n\n\n\nexport default function MechanicalWaves() {\n  const canvasRef = useRef<HTMLCanvasElement>(null)\n  const [isPlaying, setIsPlaying] = useState(false)\n  const [time, setTime] = useState(0)\n  const [waveType, setWaveType] = useState<\"transverse\" | \"longitudinal\">(\"transverse\")\n  const [params, setParams] = useState({\n    amplitude: 40,\n    wavelength: 150,\n    frequency: 0.5,\n  })\n\n  const animationRef = useRef<number>()\n  const timeRef = useRef(0)\n\n  const omega = 2 * Math.PI * params.frequency\n  const k = (2 * Math.PI) / params.wavelength\n  const velocity = params.frequency * params.wavelength\n  const dt = 0.016\n  const numParticles = 40\n\n  const draw = useCallback(\n    (ctx: CanvasRenderingContext2D, t: number) => {\n      const width = ctx.canvas.width\n      const height = ctx.canvas.height\n\n      ctx.fillStyle = \"#0f172a\"\n      ctx.fillRect(0, 0, width, height)\n\n      // Grid\n      ctx.strokeStyle = \"#1e293b\"\n      ctx.lineWidth = 0.5\n      for (let i = 0; i < width; i += 40) {\n        ctx.beginPath()\n        ctx.moveTo(i, 0)\n        ctx.lineTo(i, height)\n        ctx.stroke()\n      }\n      for (let i = 0; i < height; i += 40) {\n        ctx.beginPath()\n        ctx.moveTo(0, i)\n        ctx.lineTo(width, i)\n        ctx.stroke()\n      }\n\n      const centerY = height / 2\n      const startX = 50\n      const spacing = (width - 100) / numParticles\n\n      if (waveType === \"transverse\") {\n        ctx.strokeStyle = \"#4ade80\"\n        ctx.setLineDash([5, 5])\n        ctx.beginPath()\n        ctx.moveTo(startX, centerY)\n        ctx.lineTo(width - 50, centerY)\n        ctx.stroke()\n        ctx.setLineDash([])\n\n        ctx.strokeStyle = \"#22d3ee\"\n        ctx.lineWidth = 2\n        ctx.beginPath()\n        for (let x = startX; x < width - 50; x++) {\n          const y = centerY - params.amplitude * Math.sin(k * (x - startX) - omega * t)\n          if (x === startX) ctx.moveTo(x, y)\n          else ctx.lineTo(x, y)\n        }\n        ctx.stroke()\n\n        for (let i = 0; i < numParticles; i++) {\n          const x = startX + i * spacing\n          const displacement = params.amplitude * Math.sin(k * (x - startX) - omega * t)\n          const y = centerY - displacement\n          const vy = -params.amplitude * omega * Math.cos(k * (x - startX) - omega * t)\n\n          ctx.fillStyle = \"#3b82f6\"\n          ctx.beginPath()\n          ctx.arc(x, y, 6, 0, 2 * Math.PI)\n          ctx.fill()\n\n          if (Math.abs(vy) > 1) {\n            ctx.strokeStyle = \"#22c55e\"\n            ctx.lineWidth = 2\n            ctx.beginPath()\n            ctx.moveTo(x, y)\n            ctx.lineTo(x, y - vy * 0.3)\n            ctx.stroke()\n          }\n\n          ctx.fillStyle = \"rgba(74, 222, 128, 0.3)\"\n          ctx.beginPath()\n          ctx.arc(x, centerY, 3, 0, 2 * Math.PI)\n          ctx.fill()\n        }\n\n        ctx.fillStyle = \"#f97316\"\n        ctx.font = \"14px sans-serif\"\n        ctx.textAlign = \"center\"\n        ctx.fillText(\"↕ Hướng dao động\", width / 2, 40)\n        ctx.fillText(\"→ Hướng truyền sóng\", width / 2, 60)\n        ctx.textAlign = \"left\" // Reset alignment\n      } else {\n        ctx.strokeStyle = \"#4ade80\"\n        ctx.setLineDash([5, 5])\n        ctx.beginPath()\n        ctx.moveTo(startX, centerY)\n        ctx.lineTo(width - 50, centerY)\n        ctx.stroke()\n        ctx.setLineDash([])\n\n        for (let i = 0; i < numParticles; i++) {\n          const baseX = startX + i * spacing\n          const displacement = params.amplitude * 0.5 * Math.sin(k * (baseX - startX) - omega * t)\n          const x = baseX + displacement\n          const vx = params.amplitude * 0.5 * omega * Math.cos(k * (baseX - startX) - omega * t)\n\n          const density = Math.cos(k * (baseX - startX) - omega * t)\n          const alpha = 0.5 + 0.5 * Math.abs(density)\n          ctx.fillStyle = density > 0 ? `rgba(239, 68, 68, ${alpha})` : `rgba(59, 130, 246, ${alpha})`\n\n          ctx.beginPath()\n          ctx.arc(x, centerY, 8, 0, 2 * Math.PI)\n          ctx.fill()\n\n          if (Math.abs(vx) > 1) {\n            ctx.strokeStyle = \"#22c55e\"\n            ctx.lineWidth = 2\n            ctx.beginPath()\n            ctx.moveTo(x, centerY)\n            ctx.lineTo(x + vx * 0.3, centerY)\n            ctx.stroke()\n          }\n\n          ctx.fillStyle = \"rgba(74, 222, 128, 0.3)\"\n          ctx.beginPath()\n          ctx.arc(baseX, centerY + 40, 3, 0, 2 * Math.PI)\n          ctx.fill()\n        }\n\n        ctx.fillStyle = \"#ef4444\"\n        ctx.font = \"12px monospace\"\n        ctx.fillText(\"Nén\", width / 2 - 100, centerY - 50)\n        ctx.fillStyle = \"#3b82f6\"\n        ctx.fillText(\"Dãn\", width / 2 + 50, centerY - 50)\n\n        ctx.fillStyle = \"#f97316\"\n        ctx.font = \"14px sans-serif\"\n        ctx.textAlign = \"center\"\n        ctx.fillText(\"↔ Hướng dao động\", width / 2, 40)\n        ctx.fillText(\"→ Hướng truyền sóng\", width / 2, 60)\n        ctx.textAlign = \"left\" // Reset alignment\n      }\n\n      // Info panel\n      ctx.fillStyle = \"rgba(15, 23, 42, 0.8)\"\n      ctx.fillRect(10, height - 100, 180, 90)\n      ctx.strokeStyle = \"rgba(56, 189, 248, 0.3)\"\n      ctx.strokeRect(10, height - 100, 180, 90)\n\n      ctx.fillStyle = \"#4ade80\"\n      ctx.font = \"13px monospace\"\n      ctx.fillText(`t = ${t.toFixed(2)} s`, 20, height - 80)\n      ctx.fillText(`λ = ${params.wavelength} px`, 20, height - 60)\n      ctx.fillText(`f = ${params.frequency} Hz`, 20, height - 40)\n      ctx.fillText(`v = ${velocity.toFixed(0)} px/s`, 20, height - 20)\n\n      ctx.fillStyle = \"rgba(255, 255, 255, 0.15)\"\n      ctx.font = \"12px monospace\"\n      ctx.textAlign = \"right\"\n      ctx.fillText(\"Hô Hoàng Anh A1K50\", width - 15, height - 15)\n      ctx.textAlign = \"left\"\n    },\n    [waveType, params.amplitude, params.wavelength, params.frequency, omega, k, velocity],\n  )\n\n  const animate = useCallback(() => {\n    const canvas = canvasRef.current\n    if (!canvas) return\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n\n    timeRef.current += dt\n    setTime(timeRef.current)\n    draw(ctx, timeRef.current)\n\n    if (isPlaying) {\n      animationRef.current = requestAnimationFrame(animate)\n    }\n  }, [isPlaying, draw])\n\n  useEffect(() => {\n    if (isPlaying) {\n      animationRef.current = requestAnimationFrame(animate)\n    }\n    return () => {\n      if (animationRef.current) cancelAnimationFrame(animationRef.current)\n    }\n  }, [isPlaying, animate])\n\n  useEffect(() => {\n    const canvas = canvasRef.current\n    if (!canvas) return\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n    draw(ctx, timeRef.current)\n  }, [params, waveType, draw])\n\n  const handleStep = (direction: number) => {\n    setIsPlaying(false)\n    timeRef.current = Math.max(0, timeRef.current + dt * direction * 10)\n    setTime(timeRef.current)\n    const canvas = canvasRef.current\n    if (!canvas) return\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n    draw(ctx, timeRef.current)\n  }\n\n  const handleReset = () => {\n    setIsPlaying(false)\n    timeRef.current = 0\n    setTime(0)\n    const canvas = canvasRef.current\n    if (!canvas) return\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n    draw(ctx, 0)\n  }\n\n  const handleTimelineChange = (newTime: number) => {\n    setIsPlaying(false)\n    timeRef.current = newTime\n    setTime(newTime)\n    const canvas = canvasRef.current\n    if (!canvas) return\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n    draw(ctx, newTime)\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n      <div className=\"lg:col-span-2 space-y-4\">\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50\">\n          <canvas ref={canvasRef} width={800} height={400} className=\"w-full rounded-lg bg-[#0f172a]\" />\n        </div>\n\n        <div className=\"bg-[#1e293b] rounded-xl p-3 border border-slate-700/50 flex items-center gap-3\">\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={handleReset}\n              className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\"\n              title=\"Reset\"\n            >\n              <RotateCcw size={20} />\n            </button>\n            <button\n              onClick={() => handleStep(-1)}\n              className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\"\n              title=\"Lùi\"\n            >\n              <SkipBack size={20} />\n            </button>\n            <button\n              onClick={() => setIsPlaying(!isPlaying)}\n              className={`w-14 h-14 rounded-2xl flex items-center justify-center transition-all shadow-lg active:scale-95 border border-transparent ${isPlaying\n                ? \"bg-amber-500 hover:bg-amber-400 shadow-amber-900/20\"\n                : \"bg-cyan-500 hover:bg-cyan-400 shadow-cyan-500/30\"\n                } text-white`}\n              title={isPlaying ? \"Dừng\" : \"Chạy\"}\n            >\n              {isPlaying ? (\n                <Pause size={28} fill=\"currentColor\" />\n              ) : (\n                <Play size={28} fill=\"currentColor\" className=\"ml-1\" />\n              )}\n            </button>\n            <button\n              onClick={() => handleStep(1)}\n              className=\"w-12 h-12 rounded-xl bg-slate-700 hover:bg-slate-600 border border-slate-600 text-white flex items-center justify-center transition-all shadow-md active:scale-95\"\n              title=\"Tiến\"\n            >\n              <SkipForward size={20} />\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"space-y-4\">\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50\">\n          <h3 className=\"text-cyan-400 font-semibold mb-3 text-sm\">Loại sóng</h3>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => setWaveType(\"transverse\")}\n              className={`flex-1 py-3 px-4 rounded-lg text-sm font-semibold transition-all border ${waveType === \"transverse\"\n                ? \"bg-cyan-600 border-cyan-500 text-white shadow\"\n                : \"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700\"\n                }`}\n            >\n              Sóng ngang\n            </button>\n            <button\n              onClick={() => setWaveType(\"longitudinal\")}\n              className={`flex-1 py-3 px-4 rounded-lg text-sm font-semibold transition-all border ${waveType === \"longitudinal\"\n                ? \"bg-cyan-600 border-cyan-500 text-white shadow\"\n                : \"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700\"\n                }`}\n            >\n              Sóng dọc\n            </button>\n          </div>\n        </div>\n\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50\">\n          <h3 className=\"text-cyan-400 font-semibold mb-4 text-sm\">Thông số sóng</h3>\n          <div className=\"space-y-4\">\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <label className=\"text-slate-400\">Biên độ A</label>\n                <span className=\"text-cyan-400 font-mono\">{params.amplitude} px</span>\n              </div>\n              <input\n                type=\"range\"\n                min=\"10\"\n                max=\"80\"\n                value={params.amplitude}\n                onChange={(e) => setParams({ ...params, amplitude: Number(e.target.value) })}\n                className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg cursor-pointer\"\n              />\n            </div>\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <label className=\"text-slate-400\">Bước sóng λ</label>\n                <span className=\"text-cyan-400 font-mono\">{params.wavelength} px</span>\n              </div>\n              <input\n                type=\"range\"\n                min=\"50\"\n                max=\"300\"\n                value={params.wavelength}\n                onChange={(e) => setParams({ ...params, wavelength: Number(e.target.value) })}\n                className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg cursor-pointer\"\n              />\n            </div>\n            <div>\n              <div className=\"flex justify-between text-xs mb-1\">\n                <label className=\"text-slate-400\">Tần số f</label>\n                <span className=\"text-cyan-400 font-mono\">{params.frequency} Hz</span>\n              </div>\n              <input\n                type=\"range\"\n                min=\"0.1\"\n                max=\"2\"\n                step=\"0.1\"\n                value={params.frequency}\n                onChange={(e) => setParams({ ...params, frequency: Number(e.target.value) })}\n                className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg cursor-pointer\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50\">\n          <h3 className=\"text-cyan-400 font-semibold mb-2 text-sm\">Công thức</h3>\n          <div className=\"text-xs text-slate-300 space-y-1 font-mono\">\n            <p>y = A·sin(kx - ωt)</p>\n            <p>v = λf = {velocity.toFixed(0)} px/s</p>\n            <p>k = 2π/λ = {k.toFixed(3)} rad/px</p>\n            <p>ω = 2πf = {omega.toFixed(2)} rad/s</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6178, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/sound-waves.tsx"],"sourcesContent":["\"use client\"\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Play, Pause, Mic, MicOff, Activity, Settings, RefreshCw, Volume2, Info, BookOpen, RotateCcw, SkipBack, SkipForward, BarChart3, Radio } from 'lucide-react';\n\n// --- COMPONENT CON ---\nconst ControlPanel = ({ title, icon: Icon, children }: { title: string; icon?: any; children: React.ReactNode }) => (\n  <div className=\"bg-[#1e293b] rounded-xl border border-slate-700/50 shadow-sm overflow-hidden flex flex-col h-full\">\n    <div className=\"bg-slate-800/50 px-4 py-3 border-b border-slate-700/50 flex items-center gap-2\">\n      {Icon && <Icon size={16} className=\"text-cyan-400\"/>}\n      <h3 className=\"text-slate-300 font-bold text-xs uppercase tracking-wider\">{title}</h3>\n    </div>\n    <div className=\"p-4 space-y-4 flex-1\">{children}</div>\n  </div>\n)\n\nconst StatBox = ({ label, value, unit, color = \"text-slate-200\" }: { label: string, value: string | number, unit?: string, color?: string }) => (\n    <div className=\"bg-slate-900/50 rounded-lg p-2 border border-slate-700/50 flex flex-col items-center justify-center min-w-[80px]\">\n        <div className=\"text-[10px] text-slate-500 uppercase font-semibold mb-1\">{label}</div>\n        <div className={`text-lg font-mono font-bold ${color}`}>\n            {value} <span className=\"text-xs font-normal text-slate-500\">{unit}</span>\n        </div>\n    </div>\n)\n\nconst SoundWaveLab = () => {\n  // --- STATE ---\n  const [isListening, setIsListening] = useState(false);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [isFrozen, setIsFrozen] = useState(false);\n  \n  // Physics & Measurement\n  const [frequency, setFrequency] = useState(0); // Measured freq\n  const [medium, setMedium] = useState('air'); \n  const [velocity, setVelocity] = useState(343); \n\n  // Generator\n  const [genFreq, setGenFreq] = useState(440); \n  const [genType, setGenType] = useState<OscillatorType>('sine');\n  const [genVolume, setGenVolume] = useState(0.5);\n\n  // --- REFS ---\n  const audioContextRef = useRef<AudioContext | null>(null);\n  const analyserRef = useRef<AnalyserNode | null>(null);\n  const microphoneRef = useRef<MediaStreamAudioSourceNode | null>(null);\n  const oscillatorRef = useRef<OscillatorNode | null>(null);\n  const gainNodeRef = useRef<GainNode | null>(null);\n  const requestRef = useRef<number | null>(null);\n  \n  const canvasTimeRef = useRef<HTMLCanvasElement>(null); // Oscilloscope\n  const canvasFreqRef = useRef<HTMLCanvasElement>(null); // Spectrum\n  \n  const timeDataRef = useRef(new Uint8Array(0));\n  const freqDataRef = useRef(new Uint8Array(0));\n\n  const MEDIUMS: Record<string, { name: string; v: number }> = {\n    air: { name: 'Không khí (20°C)', v: 343 },\n    water: { name: 'Nước (25°C)', v: 1493 },\n    soil: { name: 'Đất', v: 3000 },\n  };\n\n  const WAVEFORMS: Record<string, string> = {\n      sine: 'Hình Sin',\n      square: 'Hình Vuông',\n      sawtooth: 'Răng Cưa',\n      triangle: 'Tam Giác'\n  };\n\n  useEffect(() => {\n    setVelocity(MEDIUMS[medium].v);\n  }, [medium]);\n\n  // --- AUDIO LOGIC ---\n  const initAudio = async () => {\n    if (!audioContextRef.current) {\n      audioContextRef.current = new (window.AudioContext || (window as any).webkitAudioContext)();\n    }\n    if (audioContextRef.current?.state === 'suspended') await audioContextRef.current.resume();\n  };\n\n  const startMicrophone = async () => {\n    try {\n      await initAudio();\n      if (!audioContextRef.current) return;\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      setupAnalyser();\n      microphoneRef.current = audioContextRef.current.createMediaStreamSource(stream);\n      microphoneRef.current.connect(analyserRef.current!);\n      setIsListening(true);\n      setIsGenerating(false);\n      setIsFrozen(false);\n    } catch (err) { alert(\"Cần cấp quyền Micro!\"); }\n  };\n\n  const startGenerator = async () => {\n    await initAudio();\n    if (!audioContextRef.current) return;\n    if (isListening) stopMicrophone();\n    \n    setupAnalyser();\n    oscillatorRef.current = audioContextRef.current.createOscillator();\n    gainNodeRef.current = audioContextRef.current.createGain();\n    \n    oscillatorRef.current.type = genType;\n    oscillatorRef.current.frequency.setValueAtTime(genFreq, audioContextRef.current.currentTime);\n    gainNodeRef.current!.gain.setValueAtTime(genVolume, audioContextRef.current.currentTime);\n    \n    oscillatorRef.current.connect(gainNodeRef.current!);\n    gainNodeRef.current!.connect(analyserRef.current!);\n    gainNodeRef.current!.connect(audioContextRef.current.destination);\n    \n    oscillatorRef.current.start();\n    setIsGenerating(true);\n    setIsListening(false);\n    setIsFrozen(false);\n  };\n\n  const setupAnalyser = () => {\n      if(!audioContextRef.current) return;\n      analyserRef.current = audioContextRef.current.createAnalyser();\n      analyserRef.current.fftSize = 2048;\n      analyserRef.current.smoothingTimeConstant = 0.8;\n  }\n\n  const stopMicrophone = () => {\n    microphoneRef.current?.disconnect();\n    microphoneRef.current = null;\n    setIsListening(false);\n  };\n\n  const stopGenerator = () => {\n    try { oscillatorRef.current?.stop(); } catch(e){}\n    oscillatorRef.current?.disconnect();\n    oscillatorRef.current = null;\n    setIsGenerating(false);\n  };\n\n  const updateGen = (freq: number, type: OscillatorType, vol: number) => {\n    if (audioContextRef.current && oscillatorRef.current && gainNodeRef.current) {\n      oscillatorRef.current.frequency.setValueAtTime(freq, audioContextRef.current.currentTime);\n      oscillatorRef.current.type = type;\n      gainNodeRef.current.gain.setValueAtTime(vol, audioContextRef.current.currentTime);\n    }\n    setGenFreq(freq); setGenType(type); setGenVolume(vol);\n  };\n\n  const getPitch = (buffer: Uint8Array, sampleRate: number) => {\n    let maxVal = -Infinity; let maxIndex = -1;\n    for (let i = 1; i < buffer.length / 2; i++) {\n      if (buffer[i] > maxVal) { maxVal = buffer[i]; maxIndex = i; }\n    }\n    if (maxVal < 100) return 0; // Noise gate\n    // Interpolation\n    const prev = buffer[maxIndex - 1]; const next = buffer[maxIndex + 1]; const curr = buffer[maxIndex];\n    const trueIndex = maxIndex + (next - prev) / (2 * (2 * curr - next - prev));\n    return trueIndex * sampleRate / (analyserRef.current?.fftSize || 2048);\n  };\n\n  // --- DRAW LOOP ---\n  const draw = useCallback(() => {\n    if (!analyserRef.current || !audioContextRef.current) return;\n    \n    if (!isFrozen) {\n      const bufferLength = analyserRef.current.frequencyBinCount;\n      if (timeDataRef.current.length !== bufferLength) {\n        timeDataRef.current = new Uint8Array(bufferLength);\n        freqDataRef.current = new Uint8Array(bufferLength);\n      }\n      analyserRef.current.getByteTimeDomainData(timeDataRef.current);\n      analyserRef.current.getByteFrequencyData(freqDataRef.current);\n      \n      // Update Freq Display\n      if (isGenerating) setFrequency(genFreq);\n      else {\n          const f = getPitch(freqDataRef.current, audioContextRef.current.sampleRate);\n          setFrequency(prev => (f > 0 && Math.abs(prev - f) > 5) ? f : prev); // Simple smoothing\n      }\n    }\n\n    // 1. Draw Time Domain (Oscilloscope)\n    const ctxTime = canvasTimeRef.current?.getContext('2d');\n    if (ctxTime && canvasTimeRef.current) {\n        const w = canvasTimeRef.current.width; const h = canvasTimeRef.current.height;\n        ctxTime.fillStyle = '#0f172a'; ctxTime.fillRect(0, 0, w, h);\n        \n        // Grid\n        ctxTime.strokeStyle = '#1e293b'; ctxTime.lineWidth = 1; ctxTime.beginPath();\n        for(let x=0; x<=w; x+=w/10) { ctxTime.moveTo(x,0); ctxTime.lineTo(x,h); }\n        ctxTime.stroke();\n        ctxTime.strokeStyle = '#334155'; ctxTime.beginPath(); ctxTime.moveTo(0, h/2); ctxTime.lineTo(w, h/2); ctxTime.stroke();\n\n        // Wave\n        ctxTime.lineWidth = 3; ctxTime.strokeStyle = '#38bdf8'; ctxTime.beginPath();\n        const sliceWidth = w * 1.0 / timeDataRef.current.length;\n        let x = 0;\n        for(let i=0; i<timeDataRef.current.length; i++) {\n            const v = timeDataRef.current[i] / 128.0;\n            const y = v * h/2;\n            if(i===0) ctxTime.moveTo(x, y); else ctxTime.lineTo(x, y);\n            x += sliceWidth;\n        }\n        ctxTime.stroke();\n        \n        // Author\n        ctxTime.fillStyle = \"rgba(255,255,255,0.1)\"; ctxTime.font = \"12px sans-serif\"; ctxTime.textAlign = \"right\";\n        ctxTime.fillText(\"Hô Hoàng Anh A1K50\", w - 10, h - 10);\n    }\n\n    // 2. Draw Frequency Domain (Spectrum)\n    const ctxFreq = canvasFreqRef.current?.getContext('2d');\n    if (ctxFreq && canvasFreqRef.current) {\n        const w = canvasFreqRef.current.width; const h = canvasFreqRef.current.height;\n        ctxFreq.fillStyle = '#0f172a'; ctxFreq.fillRect(0, 0, w, h);\n        \n        const barWidth = (w / freqDataRef.current.length) * 2.5;\n        let x = 0;\n        for(let i=0; i<freqDataRef.current.length; i++) {\n            const barHeight = freqDataRef.current[i] / 255 * h;\n            ctxFreq.fillStyle = `rgb(${barHeight + 100},50,200)`;\n            ctxFreq.fillRect(x, h - barHeight, barWidth, barHeight);\n            x += barWidth + 1;\n        }\n    }\n\n    requestRef.current = requestAnimationFrame(draw);\n  }, [isFrozen, isGenerating, genFreq]);\n\n  useEffect(() => {\n    requestRef.current = requestAnimationFrame(draw);\n    return () => { if(requestRef.current) cancelAnimationFrame(requestRef.current); }\n  }, [draw]);\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n      {/* CỘT TRÁI */}\n      <div className=\"lg:col-span-2 space-y-4\">\n        {/* Visualizer Main */}\n        <div className=\"bg-[#1e293b] rounded-xl border border-slate-700/50 shadow-lg relative overflow-hidden group\">\n            <canvas ref={canvasTimeRef} width={800} height={380} className=\"w-full h-[380px] bg-[#0f172a]\" />\n            <div className=\"absolute top-4 left-4 bg-slate-900/80 backdrop-blur px-3 py-2 rounded-lg border border-slate-700 text-xs font-mono text-cyan-400 flex gap-2 items-center\">\n                <Activity size={14}/> Dao động ký điện tử\n            </div>\n        </div>\n\n        {/* Controls */}\n        <div className=\"bg-[#1e293b] rounded-xl p-3 border border-slate-700/50 shadow-md flex items-center gap-4 justify-between\">\n            <div className=\"flex gap-2\">\n                <button \n                    onClick={() => { if(isGenerating) stopGenerator(); else startGenerator(); }}\n                    disabled={isListening}\n                    className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${isGenerating ? 'bg-green-600 text-white shadow-lg' : 'bg-slate-700 text-slate-300 hover:bg-slate-600'} ${isListening ? 'opacity-30' : ''}`}\n                >\n                    <Radio size={18}/> {isGenerating ? \"Tắt Máy Phát\" : \"Bật Máy Phát\"}\n                </button>\n                <button \n                    onClick={() => { if(isListening) stopMicrophone(); else startMicrophone(); }}\n                    disabled={isGenerating}\n                    className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${isListening ? 'bg-red-500 text-white shadow-lg' : 'bg-slate-700 text-slate-300 hover:bg-slate-600'} ${isGenerating ? 'opacity-30' : ''}`}\n                >\n                    {isListening ? <MicOff size={18}/> : <Mic size={18}/>} {isListening ? \"Tắt Mic\" : \"Bật Mic\"}\n                </button>\n            </div>\n            \n            <button \n                onClick={() => setIsFrozen(!isFrozen)}\n                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${isFrozen ? 'bg-amber-500 text-white' : 'bg-cyan-600 text-white'}`}\n            >\n                {isFrozen ? <Play size={18} fill=\"currentColor\"/> : <Pause size={18} fill=\"currentColor\"/>} {isFrozen ? \"Tiếp tục\" : \"Dừng hình\"}\n            </button>\n        </div>\n\n        {/* Spectrum Graph */}\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50 shadow-md\">\n            <div className=\"flex justify-between items-center mb-2\">\n                <h3 className=\"text-xs font-bold text-purple-400 uppercase flex items-center gap-2\"><BarChart3 size={14}/> Phổ Tần Số (FFT)</h3>\n            </div>\n            <div className=\"relative w-full h-32 bg-[#0f172a] rounded-lg border border-slate-700 overflow-hidden\">\n                <canvas ref={canvasFreqRef} width={800} height={128} className=\"w-full h-full\"/>\n            </div>\n        </div>\n      </div>\n\n      {/* CỘT PHẢI */}\n      <div className=\"lg:col-span-1 space-y-4 flex flex-col\">\n        {/* Frequency Display */}\n        <div className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 border border-slate-700 shadow-2xl text-center relative\">\n               <div className=\"absolute top-4 right-4 animate-pulse\">\n                  <div className={`w-3 h-3 rounded-full ${frequency > 20 ? (isGenerating ? 'bg-green-500' : 'bg-red-500') : 'bg-slate-600'}`}></div>\n               </div>\n               <h2 className=\"text-slate-400 text-sm uppercase tracking-wider mb-2\">\n                 {isGenerating ? \"Tần số đang phát\" : \"Tần số đo được\"}\n               </h2>\n               <div className={`text-6xl font-mono font-bold tracking-tighter tabular-nums ${isGenerating ? 'text-green-400' : 'text-cyan-400'}`}>\n                 {frequency > 0 ? frequency.toFixed(1) : \"--\"}\n                 <span className=\"text-2xl text-slate-500 ml-2\">Hz</span>\n               </div>\n        </div>\n\n        {/* Generator Settings */}\n        <ControlPanel title=\"Cấu hình nguồn phát\" icon={Settings}>\n            <div className=\"space-y-4\">\n                <div>\n                   <div className=\"flex justify-between text-xs text-slate-400 mb-1\">\n                        <span>Tần số phát (Hz)</span> <span className=\"text-green-400 font-mono font-bold\">{genFreq.toFixed(0)}</span>\n                   </div>\n                   <input type=\"range\" min=\"20\" max=\"5000\" step=\"1\" value={genFreq} onChange={(e) => updateGen(Number(e.target.value), genType, genVolume)} className=\"w-full accent-green-500 h-1.5 bg-slate-700 rounded-lg cursor-pointer\" />\n                </div>\n                <div>\n                   <div className=\"flex justify-between text-xs text-slate-400 mb-1\">\n                        <span>Biên độ (Volume)</span> <span className=\"text-green-400 font-mono font-bold\">{(genVolume*100).toFixed(0)}%</span>\n                   </div>\n                   <input type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" value={genVolume} onChange={(e) => updateGen(genFreq, genType, Number(e.target.value))} className=\"w-full accent-green-500 h-1.5 bg-slate-700 rounded-lg cursor-pointer\" />\n                </div>\n                <div>\n                   <label className=\"text-xs text-slate-400 mb-2 block\">Dạng sóng</label>\n                   <div className=\"grid grid-cols-2 gap-2\">\n                      {Object.entries(WAVEFORMS).map(([key, label]) => (\n                        <button key={key} onClick={() => updateGen(genFreq, key as OscillatorType, genVolume)} className={`text-[10px] py-2 rounded border transition-all ${genType === key ? 'bg-green-600 border-green-500 text-white' : 'bg-slate-800 border-slate-600 text-slate-400 hover:text-white'}`}>{label}</button>\n                      ))}\n                   </div>\n                </div>\n            </div>\n        </ControlPanel>\n\n        {/* Physics Info */}\n        <ControlPanel title=\"Thông số vật lý\" icon={BookOpen}>\n            <div className=\"space-y-3 text-xs\">\n                <div>\n                    <label className=\"text-slate-400 mb-1 block\">Môi trường</label>\n                    <select value={medium} onChange={(e) => setMedium(e.target.value)} className=\"w-full bg-slate-900 border border-slate-600 rounded px-2 py-1.5 text-slate-200 outline-none focus:border-cyan-500\">\n                      {Object.entries(MEDIUMS).map(([key, val]) => (\n                        <option key={key} value={key}>{val.name} (v={val.v}m/s)</option>\n                      ))}\n                    </select>\n                </div>\n                <div className=\"grid grid-cols-2 gap-2 mt-2\">\n                    <StatBox label=\"Bước sóng (λ)\" value={frequency > 0 ? (velocity/frequency).toFixed(3) : \"--\"} unit=\"m\" color=\"text-yellow-400\"/>\n                    <StatBox label=\"Chu kỳ (T)\" value={frequency > 0 ? (1000/frequency).toFixed(2) : \"--\"} unit=\"ms\" color=\"text-orange-400\"/>\n                </div>\n                <div className=\"mt-4 pt-4 border-t border-slate-700\">\n                    <h4 className=\"text-xs font-bold text-slate-300 mb-2 flex items-center gap-1\">\n                        <BookOpen size={14} /> CÔNG THỨC & CHÚ THÍCH\n                    </h4>\n                    <div className=\"bg-slate-900/50 p-3 rounded text-xs space-y-2 border border-slate-700/50 font-mono text-slate-400\">\n                        <div className=\"flex justify-between\">\n                            <span>x = A·cos(ωt + φ)</span>\n                            <span className=\"text-slate-600\">// PT Dao động</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                            <span>ω = 2πf</span>\n                            <span className=\"text-slate-600\">// Tần số góc</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                            <span>T = 1/f</span>\n                            <span className=\"text-slate-600\">// Chu kỳ</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                            <span>λ = v/f = v·T</span>\n                            <span className=\"text-slate-600\">// Bước sóng</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                            <span>k = 2π/λ</span>\n                            <span className=\"text-slate-600\">// Số sóng</span>\n                        </div>\n                        <div className=\"flex justify-between text-yellow-500/80 pt-1 border-t border-slate-800\">\n                            <span>u = A·cos(ωt - kx)</span>\n                            <span>// PT Sóng</span>\n                        </div>\n                    </div>\n                  </div>\n            </div>\n        </ControlPanel>\n      </div>\n    </div>\n  );\n};\n\nexport default SoundWaveLab;"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;;;;AAKA,wBAAwB;AACxB,MAAM,eAAe,CAAC,EAAE,KAAK,EAAE,MAAM,IAAI,EAAE,QAAQ,EAA4D,iBAC7G,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;oBACZ,sBAAQ,8OAAC;wBAAK,MAAM;wBAAI,WAAU;;;;;;kCACnC,8OAAC;wBAAG,WAAU;kCAA6D;;;;;;;;;;;;0BAE7E,8OAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;;AAI3C,MAAM,UAAU,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,gBAAgB,EAA4E,iBACvI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;0BAA2D;;;;;;0BAC1E,8OAAC;gBAAI,WAAW,CAAC,4BAA4B,EAAE,OAAO;;oBACjD;oBAAM;kCAAC,8OAAC;wBAAK,WAAU;kCAAsC;;;;;;;;;;;;;;;;;;AAK1E,MAAM,eAAe;IACnB,gBAAgB;IAChB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,wBAAwB;IACxB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC,IAAI,gBAAgB;IAC/D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,YAAY;IACZ,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAiB;IACvD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,eAAe;IACf,MAAM,kBAAkB,IAAA,+MAAM,EAAsB;IACpD,MAAM,cAAc,IAAA,+MAAM,EAAsB;IAChD,MAAM,gBAAgB,IAAA,+MAAM,EAAoC;IAChE,MAAM,gBAAgB,IAAA,+MAAM,EAAwB;IACpD,MAAM,cAAc,IAAA,+MAAM,EAAkB;IAC5C,MAAM,aAAa,IAAA,+MAAM,EAAgB;IAEzC,MAAM,gBAAgB,IAAA,+MAAM,EAAoB,OAAO,eAAe;IACtE,MAAM,gBAAgB,IAAA,+MAAM,EAAoB,OAAO,WAAW;IAElE,MAAM,cAAc,IAAA,+MAAM,EAAC,IAAI,WAAW;IAC1C,MAAM,cAAc,IAAA,+MAAM,EAAC,IAAI,WAAW;IAE1C,MAAM,UAAuD;QAC3D,KAAK;YAAE,MAAM;YAAoB,GAAG;QAAI;QACxC,OAAO;YAAE,MAAM;YAAe,GAAG;QAAK;QACtC,MAAM;YAAE,MAAM;YAAO,GAAG;QAAK;IAC/B;IAEA,MAAM,YAAoC;QACtC,MAAM;QACN,QAAQ;QACR,UAAU;QACV,UAAU;IACd;IAEA,IAAA,kNAAS,EAAC;QACR,YAAY,OAAO,CAAC,OAAO,CAAC,CAAC;IAC/B,GAAG;QAAC;KAAO;IAEX,sBAAsB;IACtB,MAAM,YAAY;QAChB,IAAI,CAAC,gBAAgB,OAAO,EAAE;YAC5B,gBAAgB,OAAO,GAAG,IAAI,CAAC,OAAO,YAAY,IAAI,AAAC,OAAe,kBAAkB;QAC1F;QACA,IAAI,gBAAgB,OAAO,EAAE,UAAU,aAAa,MAAM,gBAAgB,OAAO,CAAC,MAAM;IAC1F;IAEA,MAAM,kBAAkB;QACtB,IAAI;YACF,MAAM;YACN,IAAI,CAAC,gBAAgB,OAAO,EAAE;YAC9B,MAAM,SAAS,MAAM,UAAU,YAAY,CAAC,YAAY,CAAC;gBAAE,OAAO;YAAK;YACvE;YACA,cAAc,OAAO,GAAG,gBAAgB,OAAO,CAAC,uBAAuB,CAAC;YACxE,cAAc,OAAO,CAAC,OAAO,CAAC,YAAY,OAAO;YACjD,eAAe;YACf,gBAAgB;YAChB,YAAY;QACd,EAAE,OAAO,KAAK;YAAE,MAAM;QAAyB;IACjD;IAEA,MAAM,iBAAiB;QACrB,MAAM;QACN,IAAI,CAAC,gBAAgB,OAAO,EAAE;QAC9B,IAAI,aAAa;QAEjB;QACA,cAAc,OAAO,GAAG,gBAAgB,OAAO,CAAC,gBAAgB;QAChE,YAAY,OAAO,GAAG,gBAAgB,OAAO,CAAC,UAAU;QAExD,cAAc,OAAO,CAAC,IAAI,GAAG;QAC7B,cAAc,OAAO,CAAC,SAAS,CAAC,cAAc,CAAC,SAAS,gBAAgB,OAAO,CAAC,WAAW;QAC3F,YAAY,OAAO,CAAE,IAAI,CAAC,cAAc,CAAC,WAAW,gBAAgB,OAAO,CAAC,WAAW;QAEvF,cAAc,OAAO,CAAC,OAAO,CAAC,YAAY,OAAO;QACjD,YAAY,OAAO,CAAE,OAAO,CAAC,YAAY,OAAO;QAChD,YAAY,OAAO,CAAE,OAAO,CAAC,gBAAgB,OAAO,CAAC,WAAW;QAEhE,cAAc,OAAO,CAAC,KAAK;QAC3B,gBAAgB;QAChB,eAAe;QACf,YAAY;IACd;IAEA,MAAM,gBAAgB;QAClB,IAAG,CAAC,gBAAgB,OAAO,EAAE;QAC7B,YAAY,OAAO,GAAG,gBAAgB,OAAO,CAAC,cAAc;QAC5D,YAAY,OAAO,CAAC,OAAO,GAAG;QAC9B,YAAY,OAAO,CAAC,qBAAqB,GAAG;IAChD;IAEA,MAAM,iBAAiB;QACrB,cAAc,OAAO,EAAE;QACvB,cAAc,OAAO,GAAG;QACxB,eAAe;IACjB;IAEA,MAAM,gBAAgB;QACpB,IAAI;YAAE,cAAc,OAAO,EAAE;QAAQ,EAAE,OAAM,GAAE,CAAC;QAChD,cAAc,OAAO,EAAE;QACvB,cAAc,OAAO,GAAG;QACxB,gBAAgB;IAClB;IAEA,MAAM,YAAY,CAAC,MAAc,MAAsB;QACrD,IAAI,gBAAgB,OAAO,IAAI,cAAc,OAAO,IAAI,YAAY,OAAO,EAAE;YAC3E,cAAc,OAAO,CAAC,SAAS,CAAC,cAAc,CAAC,MAAM,gBAAgB,OAAO,CAAC,WAAW;YACxF,cAAc,OAAO,CAAC,IAAI,GAAG;YAC7B,YAAY,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,gBAAgB,OAAO,CAAC,WAAW;QAClF;QACA,WAAW;QAAO,WAAW;QAAO,aAAa;IACnD;IAEA,MAAM,WAAW,CAAC,QAAoB;QACpC,IAAI,SAAS,CAAC;QAAU,IAAI,WAAW,CAAC;QACxC,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,GAAG,GAAG,IAAK;YAC1C,IAAI,MAAM,CAAC,EAAE,GAAG,QAAQ;gBAAE,SAAS,MAAM,CAAC,EAAE;gBAAE,WAAW;YAAG;QAC9D;QACA,IAAI,SAAS,KAAK,OAAO,GAAG,aAAa;QACzC,gBAAgB;QAChB,MAAM,OAAO,MAAM,CAAC,WAAW,EAAE;QAAE,MAAM,OAAO,MAAM,CAAC,WAAW,EAAE;QAAE,MAAM,OAAO,MAAM,CAAC,SAAS;QACnG,MAAM,YAAY,WAAW,CAAC,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,OAAO,OAAO,IAAI,CAAC;QAC1E,OAAO,YAAY,aAAa,CAAC,YAAY,OAAO,EAAE,WAAW,IAAI;IACvE;IAEA,oBAAoB;IACpB,MAAM,OAAO,IAAA,oNAAW,EAAC;QACvB,IAAI,CAAC,YAAY,OAAO,IAAI,CAAC,gBAAgB,OAAO,EAAE;QAEtD,IAAI,CAAC,UAAU;YACb,MAAM,eAAe,YAAY,OAAO,CAAC,iBAAiB;YAC1D,IAAI,YAAY,OAAO,CAAC,MAAM,KAAK,cAAc;gBAC/C,YAAY,OAAO,GAAG,IAAI,WAAW;gBACrC,YAAY,OAAO,GAAG,IAAI,WAAW;YACvC;YACA,YAAY,OAAO,CAAC,qBAAqB,CAAC,YAAY,OAAO;YAC7D,YAAY,OAAO,CAAC,oBAAoB,CAAC,YAAY,OAAO;YAE5D,sBAAsB;YACtB,IAAI,cAAc,aAAa;iBAC1B;gBACD,MAAM,IAAI,SAAS,YAAY,OAAO,EAAE,gBAAgB,OAAO,CAAC,UAAU;gBAC1E,aAAa,CAAA,OAAQ,AAAC,IAAI,KAAK,KAAK,GAAG,CAAC,OAAO,KAAK,IAAK,IAAI,OAAO,mBAAmB;YAC3F;QACF;QAEA,qCAAqC;QACrC,MAAM,UAAU,cAAc,OAAO,EAAE,WAAW;QAClD,IAAI,WAAW,cAAc,OAAO,EAAE;YAClC,MAAM,IAAI,cAAc,OAAO,CAAC,KAAK;YAAE,MAAM,IAAI,cAAc,OAAO,CAAC,MAAM;YAC7E,QAAQ,SAAS,GAAG;YAAW,QAAQ,QAAQ,CAAC,GAAG,GAAG,GAAG;YAEzD,OAAO;YACP,QAAQ,WAAW,GAAG;YAAW,QAAQ,SAAS,GAAG;YAAG,QAAQ,SAAS;YACzE,IAAI,IAAI,IAAE,GAAG,KAAG,GAAG,KAAG,IAAE,GAAI;gBAAE,QAAQ,MAAM,CAAC,GAAE;gBAAI,QAAQ,MAAM,CAAC,GAAE;YAAI;YACxE,QAAQ,MAAM;YACd,QAAQ,WAAW,GAAG;YAAW,QAAQ,SAAS;YAAI,QAAQ,MAAM,CAAC,GAAG,IAAE;YAAI,QAAQ,MAAM,CAAC,GAAG,IAAE;YAAI,QAAQ,MAAM;YAEpH,OAAO;YACP,QAAQ,SAAS,GAAG;YAAG,QAAQ,WAAW,GAAG;YAAW,QAAQ,SAAS;YACzE,MAAM,aAAa,IAAI,MAAM,YAAY,OAAO,CAAC,MAAM;YACvD,IAAI,IAAI;YACR,IAAI,IAAI,IAAE,GAAG,IAAE,YAAY,OAAO,CAAC,MAAM,EAAE,IAAK;gBAC5C,MAAM,IAAI,YAAY,OAAO,CAAC,EAAE,GAAG;gBACnC,MAAM,IAAI,IAAI,IAAE;gBAChB,IAAG,MAAI,GAAG,QAAQ,MAAM,CAAC,GAAG;qBAAS,QAAQ,MAAM,CAAC,GAAG;gBACvD,KAAK;YACT;YACA,QAAQ,MAAM;YAEd,SAAS;YACT,QAAQ,SAAS,GAAG;YAAyB,QAAQ,IAAI,GAAG;YAAmB,QAAQ,SAAS,GAAG;YACnG,QAAQ,QAAQ,CAAC,sBAAsB,IAAI,IAAI,IAAI;QACvD;QAEA,sCAAsC;QACtC,MAAM,UAAU,cAAc,OAAO,EAAE,WAAW;QAClD,IAAI,WAAW,cAAc,OAAO,EAAE;YAClC,MAAM,IAAI,cAAc,OAAO,CAAC,KAAK;YAAE,MAAM,IAAI,cAAc,OAAO,CAAC,MAAM;YAC7E,QAAQ,SAAS,GAAG;YAAW,QAAQ,QAAQ,CAAC,GAAG,GAAG,GAAG;YAEzD,MAAM,WAAW,AAAC,IAAI,YAAY,OAAO,CAAC,MAAM,GAAI;YACpD,IAAI,IAAI;YACR,IAAI,IAAI,IAAE,GAAG,IAAE,YAAY,OAAO,CAAC,MAAM,EAAE,IAAK;gBAC5C,MAAM,YAAY,YAAY,OAAO,CAAC,EAAE,GAAG,MAAM;gBACjD,QAAQ,SAAS,GAAG,CAAC,IAAI,EAAE,YAAY,IAAI,QAAQ,CAAC;gBACpD,QAAQ,QAAQ,CAAC,GAAG,IAAI,WAAW,UAAU;gBAC7C,KAAK,WAAW;YACpB;QACJ;QAEA,WAAW,OAAO,GAAG,sBAAsB;IAC7C,GAAG;QAAC;QAAU;QAAc;KAAQ;IAEpC,IAAA,kNAAS,EAAC;QACR,WAAW,OAAO,GAAG,sBAAsB;QAC3C,OAAO;YAAQ,IAAG,WAAW,OAAO,EAAE,qBAAqB,WAAW,OAAO;QAAG;IAClF,GAAG;QAAC;KAAK;IAET,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAO,KAAK;gCAAe,OAAO;gCAAK,QAAQ;gCAAK,WAAU;;;;;;0CAC/D,8OAAC;gCAAI,WAAU;;kDACX,8OAAC,sNAAQ;wCAAC,MAAM;;;;;;oCAAK;;;;;;;;;;;;;kCAK7B,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCACG,SAAS;4CAAQ,IAAG,cAAc;iDAAsB;wCAAkB;wCAC1E,UAAU;wCACV,WAAW,CAAC,8EAA8E,EAAE,eAAe,sCAAsC,iDAAiD,CAAC,EAAE,cAAc,eAAe,IAAI;;0DAEtO,8OAAC,6MAAK;gDAAC,MAAM;;;;;;4CAAK;4CAAE,eAAe,iBAAiB;;;;;;;kDAExD,8OAAC;wCACG,SAAS;4CAAQ,IAAG,aAAa;iDAAuB;wCAAmB;wCAC3E,UAAU;wCACV,WAAW,CAAC,8EAA8E,EAAE,cAAc,oCAAoC,iDAAiD,CAAC,EAAE,eAAe,eAAe,IAAI;;4CAEnO,4BAAc,8OAAC,oNAAM;gDAAC,MAAM;;;;;yGAAQ,8OAAC,uMAAG;gDAAC,MAAM;;;;;;4CAAM;4CAAE,cAAc,YAAY;;;;;;;;;;;;;0CAI1F,8OAAC;gCACG,SAAS,IAAM,YAAY,CAAC;gCAC5B,WAAW,CAAC,8EAA8E,EAAE,WAAW,4BAA4B,0BAA0B;;oCAE5J,yBAAW,8OAAC,0MAAI;wCAAC,MAAM;wCAAI,MAAK;;;;;iGAAmB,8OAAC,6MAAK;wCAAC,MAAM;wCAAI,MAAK;;;;;;oCAAiB;oCAAE,WAAW,aAAa;;;;;;;;;;;;;kCAK7H,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAI,WAAU;0CACX,cAAA,8OAAC;oCAAG,WAAU;;sDAAsE,8OAAC,+NAAS;4CAAC,MAAM;;;;;;wCAAK;;;;;;;;;;;;0CAE9G,8OAAC;gCAAI,WAAU;0CACX,cAAA,8OAAC;oCAAO,KAAK;oCAAe,OAAO;oCAAK,QAAQ;oCAAK,WAAU;;;;;;;;;;;;;;;;;;;;;;;0BAMzE,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;;0CACR,8OAAC;gCAAI,WAAU;0CACZ,cAAA,8OAAC;oCAAI,WAAW,CAAC,qBAAqB,EAAE,YAAY,KAAM,eAAe,iBAAiB,eAAgB,gBAAgB;;;;;;;;;;;0CAE7H,8OAAC;gCAAG,WAAU;0CACX,eAAe,qBAAqB;;;;;;0CAEvC,8OAAC;gCAAI,WAAW,CAAC,2DAA2D,EAAE,eAAe,mBAAmB,iBAAiB;;oCAC9H,YAAY,IAAI,UAAU,OAAO,CAAC,KAAK;kDACxC,8OAAC;wCAAK,WAAU;kDAA+B;;;;;;;;;;;;;;;;;;kCAKxD,8OAAC;wBAAa,OAAM;wBAAsB,MAAM,sNAAQ;kCACpD,cAAA,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;;sDACE,8OAAC;4CAAI,WAAU;;8DACV,8OAAC;8DAAK;;;;;;gDAAuB;8DAAC,8OAAC;oDAAK,WAAU;8DAAsC,QAAQ,OAAO,CAAC;;;;;;;;;;;;sDAEzG,8OAAC;4CAAM,MAAK;4CAAQ,KAAI;4CAAK,KAAI;4CAAO,MAAK;4CAAI,OAAO;4CAAS,UAAU,CAAC,IAAM,UAAU,OAAO,EAAE,MAAM,CAAC,KAAK,GAAG,SAAS;4CAAY,WAAU;;;;;;;;;;;;8CAEtJ,8OAAC;;sDACE,8OAAC;4CAAI,WAAU;;8DACV,8OAAC;8DAAK;;;;;;gDAAuB;8DAAC,8OAAC;oDAAK,WAAU;;wDAAsC,CAAC,YAAU,GAAG,EAAE,OAAO,CAAC;wDAAG;;;;;;;;;;;;;sDAEpH,8OAAC;4CAAM,MAAK;4CAAQ,KAAI;4CAAI,KAAI;4CAAI,MAAK;4CAAO,OAAO;4CAAW,UAAU,CAAC,IAAM,UAAU,SAAS,SAAS,OAAO,EAAE,MAAM,CAAC,KAAK;4CAAI,WAAU;;;;;;;;;;;;8CAErJ,8OAAC;;sDACE,8OAAC;4CAAM,WAAU;sDAAoC;;;;;;sDACrD,8OAAC;4CAAI,WAAU;sDACX,OAAO,OAAO,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC,KAAK,MAAM,iBAC1C,8OAAC;oDAAiB,SAAS,IAAM,UAAU,SAAS,KAAuB;oDAAY,WAAW,CAAC,+CAA+C,EAAE,YAAY,MAAM,6CAA6C,iEAAiE;8DAAG;mDAA1Q;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAQ7B,8OAAC;wBAAa,OAAM;wBAAkB,MAAM,0NAAQ;kCAChD,cAAA,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;;sDACG,8OAAC;4CAAM,WAAU;sDAA4B;;;;;;sDAC7C,8OAAC;4CAAO,OAAO;4CAAQ,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;4CAAG,WAAU;sDAC1E,OAAO,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,iBACtC,8OAAC;oDAAiB,OAAO;;wDAAM,IAAI,IAAI;wDAAC;wDAAK,IAAI,CAAC;wDAAC;;mDAAtC;;;;;;;;;;;;;;;;8CAIrB,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAQ,OAAM;4CAAgB,OAAO,YAAY,IAAI,CAAC,WAAS,SAAS,EAAE,OAAO,CAAC,KAAK;4CAAM,MAAK;4CAAI,OAAM;;;;;;sDAC7G,8OAAC;4CAAQ,OAAM;4CAAa,OAAO,YAAY,IAAI,CAAC,OAAK,SAAS,EAAE,OAAO,CAAC,KAAK;4CAAM,MAAK;4CAAK,OAAM;;;;;;;;;;;;8CAE3G,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAG,WAAU;;8DACV,8OAAC,0NAAQ;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAE1B,8OAAC;4CAAI,WAAU;;8DACX,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;sEAAK;;;;;;sEACN,8OAAC;4DAAK,WAAU;sEAAiB;;;;;;;;;;;;8DAErC,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;sEAAK;;;;;;sEACN,8OAAC;4DAAK,WAAU;sEAAiB;;;;;;;;;;;;8DAErC,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;sEAAK;;;;;;sEACN,8OAAC;4DAAK,WAAU;sEAAiB;;;;;;;;;;;;8DAErC,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;sEAAK;;;;;;sEACN,8OAAC;4DAAK,WAAU;sEAAiB;;;;;;;;;;;;8DAErC,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;sEAAK;;;;;;sEACN,8OAAC;4DAAK,WAAU;sEAAiB;;;;;;;;;;;;8DAErC,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;sEAAK;;;;;;sEACN,8OAAC;sEAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASlC;uCAEe"}},
    {"offset": {"line": 7173, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/wave-interference.tsx"],"sourcesContent":["\"use client\"\n\nimport { useRef, useEffect, useState, useCallback } from \"react\"\nimport { Play, Pause, RotateCcw, Eye, EyeOff, Waves, SkipBack, SkipForward, Sun, Zap, Disc, Maximize2, Rainbow } from \"lucide-react\"\n\n\n\n// --- CÁC HÀM BỔ TRỢ ---\n\n// Polyfill cho hàm sinc\nif (!(Math as any).sinc) {\n  (Math as any).sinc = function (x: number) {\n    return x === 0 ? 1 : Math.sin(x) / x\n  }\n}\n\n// Hàm chuyển đổi bước sóng (nm) sang màu RGB\nconst wavelengthToRGB = (wavelength: number) => {\n  let r, g, b, alpha\n  if (wavelength >= 380 && wavelength < 440) {\n    r = -(wavelength - 440) / (440 - 380); g = 0; b = 1\n  } else if (wavelength >= 440 && wavelength < 490) {\n    r = 0; g = (wavelength - 440) / (490 - 440); b = 1\n  } else if (wavelength >= 490 && wavelength < 510) {\n    r = 0; g = 1; b = -(wavelength - 510) / (510 - 490)\n  } else if (wavelength >= 510 && wavelength < 580) {\n    r = (wavelength - 510) / (580 - 510); g = 1; b = 0\n  } else if (wavelength >= 580 && wavelength < 645) {\n    r = 1; g = -(wavelength - 645) / (645 - 580); b = 0\n  } else if (wavelength >= 645 && wavelength < 781) {\n    r = 1; g = 0; b = 0\n  } else {\n    r = 0; g = 0; b = 0\n  }\n\n  if (wavelength >= 380 && wavelength < 420) {\n    alpha = 0.3 + (0.7 * (wavelength - 380)) / (420 - 380)\n  } else if (wavelength >= 420 && wavelength < 701) {\n    alpha = 1.0\n  } else if (wavelength >= 701 && wavelength < 781) {\n    alpha = 0.3 + (0.7 * (781 - wavelength)) / (781 - 701)\n  } else {\n    alpha = 0\n  }\n\n  return {\n    r: Math.round(r * 255 * alpha),\n    g: Math.round(g * 255 * alpha),\n    b: Math.round(b * 255 * alpha),\n    colorString: `rgb(${Math.round(r * 255 * alpha)}, ${Math.round(g * 255 * alpha)}, ${Math.round(b * 255 * alpha)})`\n  }\n}\n\n// --- COMPONENT CHÍNH ---\nexport default function WaveInterference() {\n  const canvasRef = useRef<HTMLCanvasElement>(null)\n\n  // State chung\n  const [mode, setMode] = useState<'mechanical' | 'light'>('mechanical')\n\n  // State Sóng cơ\n  const [isPlaying, setIsPlaying] = useState(false)\n  const [time, setTime] = useState(0)\n  const [showNodalLines, setShowNodalLines] = useState(false)\n  const [view3D, setView3D] = useState(false)\n  const [mechParams, setMechParams] = useState({\n    frequency: 0.8,\n    amplitude: 1.0,\n    sourceDistance: 120,\n    wavelength: 40,\n  })\n\n  // State Sóng ánh sáng\n  const [lightMode, setLightMode] = useState<'mono' | 'dual' | 'white'>('mono')\n  const [lightParams, setLightParams] = useState({\n    wavelength1: 500, // Lambda 1 (nm)\n    wavelength2: 650, // Lambda 2 (nm)\n    slitDistance: 1.0, // a (mm)\n    screenDistance: 2.0, // D (m)\n  })\n\n  const animationRef = useRef<number>()\n  const timeRef = useRef(0)\n\n  // --- LOGIC SÓNG CƠ ---\n  const omega = 2 * Math.PI * mechParams.frequency\n  const k_mech = (2 * Math.PI) / mechParams.wavelength\n  const dt = 1 / 60\n\n  const calculateWaveHeight = useCallback(\n    (x: number, y: number, s1x: number, s1y: number, s2x: number, s2y: number, t: number) => {\n      const d1 = Math.sqrt((x - s1x) ** 2 + (y - s1y) ** 2)\n      const d2 = Math.sqrt((x - s2x) ** 2 + (y - s2y) ** 2)\n      const amp1 = mechParams.amplitude / Math.sqrt(1 + d1 * 0.01)\n      const amp2 = mechParams.amplitude / Math.sqrt(1 + d2 * 0.01)\n\n      const wave1 = amp1 * Math.sin(k_mech * d1 - omega * t)\n      const wave2 = amp2 * Math.sin(k_mech * d2 - omega * t)\n      return wave1 + wave2\n    },\n    [k_mech, omega, mechParams.amplitude],\n  )\n\n  const getNodalLinePoints = useCallback(\n    (width: number, height: number, s1x: number, s1y: number, s2x: number, s2y: number, order: number) => {\n      const points: { x: number; y: number }[] = []\n      const pathDiff = (order + 0.5) * mechParams.wavelength\n      for (let x = 0; x < width; x += 2) {\n        for (let y = 0; y < height; y += 2) {\n          const d1 = Math.sqrt((x - s1x) ** 2 + (y - s1y) ** 2)\n          const d2 = Math.sqrt((x - s2x) ** 2 + (y - s2y) ** 2)\n          if (Math.abs(Math.abs(d1 - d2) - pathDiff) < 2.5) points.push({ x, y })\n        }\n      }\n      return points\n    },\n    [mechParams.wavelength],\n  )\n\n  const drawMechanical = useCallback(\n    (ctx: CanvasRenderingContext2D, t: number) => {\n      const width = ctx.canvas.width\n      const height = ctx.canvas.height\n      const centerY = height / 2\n      const source1 = { x: 80, y: centerY - mechParams.sourceDistance / 2 }\n      const source2 = { x: 80, y: centerY + mechParams.sourceDistance / 2 }\n\n      const imageData = ctx.createImageData(width, height)\n      const data = imageData.data\n      const resolution = view3D ? 3 : 2\n\n      if (view3D) {\n        // Gradient Background\n        const bgGrad = ctx.createLinearGradient(0, 0, 0, height);\n        bgGrad.addColorStop(0, \"#0f172a\");\n        bgGrad.addColorStop(1, \"#1e293b\");\n        ctx.fillStyle = bgGrad;\n        ctx.fillRect(0, 0, width, height);\n\n        const perspectiveScale = 0.6;\n        const horizonY = height * 0.2;\n        const gridSpacing = 4; // High fidelity\n        const zStart = 0;\n        const zEnd = height * 1.5;\n\n        // Render from Far (z=0) to Near (z=max)\n        for (let z = zStart; z <= zEnd; z += gridSpacing) {\n          const perspY = horizonY + z * perspectiveScale;\n          // Skip if off screen\n          if (perspY > height) break;\n\n          const scale = 0.2 + (z / (height * 1.2)) * 0.8;\n\n          // Generate points for this Z-slice\n          const points = [];\n          for (let x = 0; x <= width; x += gridSpacing) {\n            const worldX = (x - width / 2) / scale + width / 2;\n            const worldZ = z;\n\n            // Calculate Wave Height\n            const waveHeight = calculateWaveHeight(worldX, worldZ, source1.x, source1.y, source2.x, source2.y, t);\n\n            const screenX = width / 2 + (x - width / 2); // Spread X based on perspective?\n            // Actually `x` loop is screen space X?\n            // In previous code: `worldX` was derived from `x`.\n            // `const screenX = width / 2 + (x - width / 2) * scale` ???\n            // Usually: x is projected.\n            // Let's stick to iterating screen X and unprojecting for sample is easier for filling screen.\n            // But simpler: Iterate Screen X.\n            // `const worldX = (x - width/2)/scale + width/2`.\n            // This assumes linear mapping.\n\n            // Display Logic\n            // Perspective Y shift based on height\n            const screenY = perspY - waveHeight * 12 * scale;\n            points.push({ x, y: screenY });\n          }\n\n          if (points.length < 2) continue;\n\n          // Draw Filled Polygon (Occlusion)\n          ctx.beginPath();\n          ctx.moveTo(points[0].x, points[0].y);\n          for (let i = 1; i < points.length; i++) {\n            // Smooth curves\n            // ctx.lineTo(points[i].x, points[i].y);\n            // Quadratic for smoother look? \n            // Simple lineTo is fast and fine for dense grid.\n            ctx.lineTo(points[i].x, points[i].y);\n          }\n          // Close shape downwards\n          ctx.lineTo(width, height);\n          ctx.lineTo(0, height);\n          ctx.closePath();\n\n          ctx.fillStyle = \"#0f172a\"; // Opaque dark fill\n          ctx.fill();\n\n          // Draw Stroke (The Water Surface Line)\n          ctx.beginPath();\n          ctx.moveTo(points[0].x, points[0].y);\n          for (let i = 1; i < points.length; i++) {\n            ctx.lineTo(points[i].x, points[i].y);\n          }\n\n          // Distance based color fading\n          const distanceAlpha = 0.3 + 0.7 * (z / zEnd);\n          ctx.strokeStyle = `rgba(34, 211, 238, ${distanceAlpha})`; // Cyan-400\n          ctx.lineWidth = 1 + scale; // Lines thicker when near\n          ctx.stroke();\n        }\n\n      } else {\n        // REALISTIC RIPPLE TANK SHADER (2D)\n        for (let y = 0; y < height; y += resolution) {\n          for (let x = 0; x < width; x += resolution) {\n            const waveHeight = calculateWaveHeight(x, y, source1.x, source1.y, source2.x, source2.y, t)\n\n            // Ripple Tank Physics:\n            // Crests (Positive) act as convex lenses -> Focus light -> Bright Strips\n            // Troughs (Negative) act as concave lenses -> Diverge light -> Dark Strips\n            // Flat water -> Average Brightness\n\n            const maxAmp = 2 * mechParams.amplitude\n            const val = Math.max(-1, Math.min(1, waveHeight / maxAmp)) // Clamp -1..1\n\n            let r, g, b\n            // Base Water Color (Deep Blue-Grey)\n            const baseR = 15, baseG = 113, baseB = 115\n\n            if (val > 0) {\n              // Highlight (Crests) - Cyan/White\n              const intensity = Math.pow(val, 0.7); // Non-linear for sharper crests\n              r = 15 + (220 - 15) * intensity\n              g = 113 + (255 - 113) * intensity\n              b = 115 + (255 - 115) * intensity\n            } else {\n              // Shadow (Troughs) - Darker\n              const intensity = Math.pow(Math.abs(val), 0.7)\n              r = 15 * (1 - intensity * 0.8) // Don't go pitch black\n              g = 113 * (1 - intensity * 0.8)\n              b = 115 * (1 - intensity * 0.8)\n            }\n\n            // Render Pixel (or Block)\n            for (let dy = 0; dy < resolution && y + dy < height; dy++) {\n              for (let dx = 0; dx < resolution && x + dx < width; dx++) {\n                const idx = ((y + dy) * width + (x + dx)) * 4\n                data[idx] = r; data[idx + 1] = g; data[idx + 2] = b; data[idx + 3] = 255\n              }\n            }\n          }\n        }\n        ctx.putImageData(imageData, 0, 0)\n      }\n\n      if (showNodalLines && !view3D) {\n        ctx.strokeStyle = \"rgba(255, 100, 100, 0.8)\"; ctx.lineWidth = 2; ctx.setLineDash([5, 5])\n        const maxOrder = Math.floor(mechParams.sourceDistance / mechParams.wavelength) + 2\n        for (let order = 0; order <= maxOrder; order++) {\n          const points = getNodalLinePoints(width, height, source1.x, source1.y, source2.x, source2.y, order)\n          if (points.length > 0) {\n            const upperPoints = points.filter((p) => p.y < centerY).sort((a, b) => a.x - b.x)\n            const lowerPoints = points.filter((p) => p.y >= centerY).sort((a, b) => a.x - b.x)\n            if (upperPoints.length > 5) { ctx.beginPath(); ctx.moveTo(upperPoints[0].x, upperPoints[0].y); for (let i = 1; i < upperPoints.length; i++) ctx.lineTo(upperPoints[i].x, upperPoints[i].y); ctx.stroke(); }\n            if (lowerPoints.length > 5) { ctx.beginPath(); ctx.moveTo(lowerPoints[0].x, lowerPoints[0].y); for (let i = 1; i < lowerPoints.length; i++) ctx.lineTo(lowerPoints[i].x, lowerPoints[i].y); ctx.stroke(); }\n          }\n        }\n        ctx.strokeStyle = \"rgba(100, 255, 100, 0.5)\"; ctx.setLineDash([8, 4]); ctx.beginPath(); ctx.moveTo(source1.x, centerY); ctx.lineTo(width, centerY); ctx.stroke(); ctx.setLineDash([])\n      }\n\n      if (!view3D) {\n        const drawSource = (x: number, y: number, label: string) => {\n          const gradient = ctx.createRadialGradient(x, y, 0, x, y, 20)\n          gradient.addColorStop(0, \"rgba(255, 50, 50, 1)\"); gradient.addColorStop(1, \"rgba(255, 50, 50, 0)\")\n          ctx.fillStyle = gradient; ctx.beginPath(); ctx.arc(x, y, 20, 0, 2 * Math.PI); ctx.fill()\n          ctx.fillStyle = \"#fff\"; ctx.beginPath(); ctx.arc(x, y, 4, 0, 2 * Math.PI); ctx.fill()\n          ctx.fillStyle = \"#fff\"; ctx.font = \"bold 14px monospace\"; ctx.fillText(label, x - 25, y + 5)\n        }\n        drawSource(source1.x, source1.y, \"S₁\"); drawSource(source2.x, source2.y, \"S₂\")\n      }\n    },\n    [mechParams, view3D, showNodalLines, calculateWaveHeight, getNodalLinePoints]\n  )\n\n  // --- HÀM VẼ GIAO THOA ÁNH SÁNG ---\n  const drawLight = useCallback((ctx: CanvasRenderingContext2D) => {\n    const width = ctx.canvas.width\n    const height = ctx.canvas.height\n    const centerX = width / 2\n\n    // Nền tối\n    ctx.fillStyle = \"#020617\"\n    ctx.fillRect(0, 0, width, height)\n\n    const a = lightParams.slitDistance * 1e-3\n    const D = lightParams.screenDistance\n    const physicalScreenWidth = 0.04\n    const pixelsPerMeter = width / physicalScreenWidth\n\n    let wavelengths: { wl: number, intensityScale: number }[] = []\n\n    if (lightMode === 'mono') {\n      wavelengths.push({ wl: lightParams.wavelength1, intensityScale: 1.0 })\n    } else if (lightMode === 'dual') {\n      wavelengths.push({ wl: lightParams.wavelength1, intensityScale: 0.8 })\n      wavelengths.push({ wl: lightParams.wavelength2, intensityScale: 0.8 })\n    } else if (lightMode === 'white') {\n      for (let w = 380; w <= 750; w += 10) {\n        let scale = 0.5\n        if (w > 450 && w < 650) scale = 0.8\n        wavelengths.push({ wl: w, intensityScale: scale * 0.15 })\n      }\n    }\n\n    const imageData = ctx.createImageData(width, height)\n    const data = imageData.data\n\n    for (let x = 0; x < width; x++) {\n      const xPhysical = (x - centerX) / pixelsPerMeter\n      let rTotal = 0, gTotal = 0, bTotal = 0\n\n      for (const src of wavelengths) {\n        const lambda = src.wl * 1e-9\n        const phaseDifference = (2 * Math.PI * a * xPhysical) / (lambda * D)\n        let intensity = Math.cos(phaseDifference / 2) ** 2\n\n        // SỬA LỖI: Đổi tên biến 'b' thành 'slitWidth' để không trùng với 'b' trong RGB\n        const slitWidth = a / 10\n        const diffractionPhase = (Math.PI * slitWidth * xPhysical) / (lambda * D)\n        const diffractionFactor = (Math as any).sinc(diffractionPhase) ** 2\n        intensity = intensity * diffractionFactor * src.intensityScale\n\n        const rgb = wavelengthToRGB(src.wl)\n        rTotal += rgb.r * intensity\n        gTotal += rgb.g * intensity\n        bTotal += rgb.b * intensity\n      }\n\n      rTotal = Math.min(255, rTotal)\n      gTotal = Math.min(255, gTotal)\n      bTotal = Math.min(255, bTotal)\n\n      // Môi phỏng Chùm tia Laser (Gaussian Beam)\n      const beamRadius = height * 0.35;\n\n      for (let y = 0; y < height; y++) {\n        const idx = (y * width + x) * 4\n\n        // Vertical Falloff (Beam Shape)\n        const distY = y - height / 2;\n        const beamFactor = Math.exp(-(distY * distY) / (2 * beamRadius * beamRadius));\n\n        // Apply Beam Profile\n        let r = rTotal * beamFactor;\n        let g = gTotal * beamFactor;\n        let b = bTotal * beamFactor;\n\n        // \"Hot Spot\" Bloom effect (Overexposure)\n        // Khi cường độ quá lớn, cảm biến/mắt bị bão hòa -> Trắng\n        const maxVal = Math.max(r, g, b);\n        if (maxVal > 220) {\n          const bloom = (maxVal - 220) * 0.8;\n          r += bloom; g += bloom; b += bloom;\n        }\n\n        // Laser Speckle Noise (Đốm ngẫu nhiên đặc trưng của laser)\n        // Noise tác động mạnh hơn ở vùng sáng\n        if (maxVal > 10) {\n          const speckle = (Math.random() - 0.5) * 30 * (maxVal / 255);\n          r += speckle; g += speckle; b += speckle;\n        }\n\n        data[idx] = Math.max(0, Math.min(255, r))\n        data[idx + 1] = Math.max(0, Math.min(255, g))\n        data[idx + 2] = Math.max(0, Math.min(255, b))\n        data[idx + 3] = 255\n      }\n    }\n    ctx.putImageData(imageData, 0, 0)\n\n    // --- VẼ KÍ HIỆU VÂN TRUNG TÂM (k=0) ---\n    ctx.save()\n    // Kẻ đường đứt nét sáng rõ\n    ctx.strokeStyle = \"rgba(255, 255, 255, 0.9)\"\n    ctx.setLineDash([4, 4])\n    ctx.lineWidth = 1.5\n    ctx.beginPath()\n    ctx.moveTo(centerX, 0)\n    ctx.lineTo(centerX, height)\n    ctx.stroke()\n\n    ctx.textAlign = \"center\"\n    const label = \"Vân trung tâm (k=0)\"\n    ctx.font = \"bold 13px monospace\"\n    const textWidth = ctx.measureText(label).width\n\n    // Hộp nhãn nổi bật\n    const boxX = centerX - textWidth / 2 - 8;\n    const boxY = 10;\n    const boxW = textWidth + 16;\n    const boxH = 26;\n\n    ctx.fillStyle = \"rgba(15, 23, 42, 0.9)\" // Slate-900 transparent\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = \"rgba(255, 255, 255, 0.4)\";\n    ctx.fillRect(boxX, boxY, boxW, boxH)\n    ctx.strokeRect(boxX, boxY, boxW, boxH)\n\n    ctx.fillStyle = \"#ffffff\"\n    ctx.fillText(label, centerX, boxY + 17)\n    ctx.restore()\n\n    // --- VẼ THƯỚC ĐO ---\n    if (lightMode !== 'white') {\n      const i1_meter = (lightParams.wavelength1 * 1e-9 * D) / a\n      const i1_pixel = i1_meter * pixelsPerMeter\n\n      ctx.textAlign = \"center\"\n      const markerY = height / 2\n\n      if (i1_pixel > 15 && i1_pixel < width / 2) {\n        const firstBrightX = centerX + i1_pixel\n        const color1 = wavelengthToRGB(lightParams.wavelength1).colorString\n\n        ctx.strokeStyle = \"rgba(255,255,255,0.9)\"; ctx.fillStyle = \"rgba(255,255,255,0.9)\"; ctx.lineWidth = 1.5\n\n        ctx.beginPath(); ctx.moveTo(centerX, markerY); ctx.lineTo(firstBrightX, markerY); ctx.stroke()\n        ctx.beginPath(); ctx.moveTo(centerX + 5, markerY - 4); ctx.lineTo(centerX, markerY); ctx.lineTo(centerX + 5, markerY + 4); ctx.fill()\n        ctx.beginPath(); ctx.moveTo(firstBrightX - 5, markerY - 4); ctx.lineTo(firstBrightX, markerY); ctx.lineTo(firstBrightX - 5, markerY + 4); ctx.fill()\n\n        ctx.font = \"bold 14px monospace\"\n        const text = `i₁ = ${(i1_meter * 1000).toFixed(2)}mm`\n        const textWidth = ctx.measureText(text).width\n        ctx.fillStyle = \"rgba(0,0,0,0.8)\"; ctx.fillRect(centerX + i1_pixel / 2 - textWidth / 2 - 4, markerY - 24, textWidth + 8, 20)\n        ctx.fillStyle = color1; ctx.fillText(text, centerX + i1_pixel / 2, markerY - 10)\n      }\n    }\n    ctx.textAlign = \"left\"\n  }, [lightParams, lightMode])\n\n\n  // --- ANIMATION LOOP ---\n  const animate = useCallback(() => {\n    const ctx = canvasRef.current?.getContext(\"2d\")\n    if (!ctx) return\n\n    if (mode === 'mechanical') {\n      timeRef.current += dt\n      setTime(timeRef.current)\n      drawMechanical(ctx, timeRef.current)\n      if (isPlaying) {\n        animationRef.current = requestAnimationFrame(animate)\n      }\n    } else {\n      drawLight(ctx)\n    }\n  }, [isPlaying, drawMechanical, drawLight, mode, dt])\n\n  useEffect(() => {\n    if (isPlaying && mode === 'mechanical') {\n      animationRef.current = requestAnimationFrame(animate)\n    }\n    return () => { if (animationRef.current) cancelAnimationFrame(animationRef.current) }\n  }, [isPlaying, animate, mode])\n\n  useEffect(() => {\n    const ctx = canvasRef.current?.getContext(\"2d\")\n    if (!ctx) return\n    if (mode === 'mechanical') {\n      drawMechanical(ctx, timeRef.current)\n    } else {\n      drawLight(ctx)\n    }\n  }, [mechParams, view3D, showNodalLines, lightParams, lightMode, mode, drawMechanical, drawLight])\n\n  const handleReset = () => {\n    if (mode !== 'mechanical') return\n    setIsPlaying(false); timeRef.current = 0; setTime(0)\n    canvasRef.current?.getContext(\"2d\") && drawMechanical(canvasRef.current.getContext(\"2d\")!, 0)\n  }\n  const handleStep = (direction: number) => {\n    if (mode !== 'mechanical') return\n    setIsPlaying(false)\n    timeRef.current = Math.max(0, timeRef.current + dt * direction * 5)\n    setTime(timeRef.current)\n    canvasRef.current?.getContext(\"2d\") && drawMechanical(canvasRef.current.getContext(\"2d\")!, timeRef.current)\n  }\n\n  const calculateI = (wl: number) => (wl * 1e-9 * lightParams.screenDistance) / (lightParams.slitDistance * 1e-3) * 1000\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-4 font-sans items-start\">\n      <div className=\"lg:col-span-3 space-y-4\">\n        {/* Nút chuyển chế độ */}\n        <div className=\"flex gap-3 mb-2 p-1 bg-slate-800/50 rounded-xl w-fit backdrop-blur-sm border border-slate-700/50\">\n          <button\n            onClick={() => { setMode('mechanical'); setIsPlaying(false); }}\n            className={`px-5 py-2 rounded-lg font-bold flex items-center gap-2 transition-all text-sm ${mode === 'mechanical' ? 'bg-cyan-500 text-white shadow-lg shadow-cyan-500/25 scale-[1.02]' : 'text-slate-400 hover:text-white hover:bg-slate-700/50'}`}\n          >\n            <Waves size={18} className={mode === 'mechanical' ? 'animate-pulse' : ''} /> mặt nước\n          </button>\n          <button\n            onClick={() => { setMode('light'); setIsPlaying(false); }}\n            className={`px-5 py-2 rounded-lg font-bold flex items-center gap-2 transition-all text-sm ${mode === 'light' ? 'bg-amber-500 text-white shadow-lg shadow-amber-500/25 scale-[1.02]' : 'text-slate-400 hover:text-white hover:bg-slate-700/50'}`}\n          >\n            <Sun size={18} className={mode === 'light' ? 'animate-spin-slow' : ''} /> Ánh Sáng\n          </button>\n        </div>\n\n        {/* Khung mô phỏng - Full height */}\n        <div className=\"bg-[#1e293b] rounded-xl border border-slate-700/50 shadow-xl overflow-hidden group\">\n          {/* Header của Canvas */}\n          <div className=\"px-4 py-2 border-b border-slate-700/50 bg-slate-800/50 flex items-center justify-between\">\n            <h3 className=\"text-sm font-bold text-slate-200 flex items-center gap-2\">\n              {mode === 'mechanical' ? <Waves className=\"w-4 h-4 text-cyan-400\" /> : <Rainbow className=\"w-4 h-4 text-amber-400\" />}\n              {mode === 'mechanical' ? 'Mô phỏng giao thoa mặt nước' : 'Mô phỏng giao thoa ánh sáng'}\n            </h3>\n            <div className=\"flex gap-2\">\n              <span className=\"w-2 h-2 rounded-full bg-red-500\"></span>\n              <span className=\"w-2 h-2 rounded-full bg-yellow-500\"></span>\n              <span className=\"w-2 h-2 rounded-full bg-green-500\"></span>\n            </div>\n          </div>\n\n          <div className=\"p-1 bg-[#0f172a] relative\">\n            <canvas ref={canvasRef} width={800} height={340} className=\"w-full rounded-b-lg block\" />\n            <div className=\"absolute bottom-2 right-4 text-[10px] text-slate-600 font-mono pointer-events-none group-hover:text-slate-500 transition-colors\">\n              Hô Hoàng Anh A1K50\n            </div>\n          </div>\n        </div>\n\n        {/* Controls Sóng cơ (Chỉ hiện khi ở chế độ sóng cơ) */}\n        {mode === 'mechanical' && (\n          <div className=\"bg-[#1e293b]/80 backdrop-blur rounded-xl p-3 border border-slate-700/50 flex items-center gap-4 animate-in fade-in slide-in-from-top-2\">\n            <div className=\"flex items-center gap-2\">\n              <button onClick={handleReset} className=\"w-9 h-9 rounded-lg bg-slate-700 hover:bg-slate-600 text-slate-300 hover:text-white flex items-center justify-center transition-all active:scale-95\">\n                <RotateCcw size={16} />\n              </button>\n              <button onClick={() => handleStep(-1)} className=\"w-9 h-9 rounded-lg bg-slate-700 hover:bg-slate-600 text-slate-300 hover:text-white flex items-center justify-center transition-all active:scale-95\">\n                <SkipBack size={16} />\n              </button>\n              <button\n                onClick={() => setIsPlaying(!isPlaying)}\n                className={`w-10 h-10 rounded-xl flex items-center justify-center transition-all shadow-lg active:scale-95 ${isPlaying ? \"bg-amber-500 hover:bg-amber-400 shadow-amber-900/20\" : \"bg-cyan-500 hover:bg-cyan-400 shadow-cyan-500/30\"\n                  } text-white`}\n              >\n                {isPlaying ? <Pause size={20} fill=\"currentColor\" /> : <Play size={20} fill=\"currentColor\" className=\"ml-1\" />}\n              </button>\n              <button onClick={() => handleStep(1)} className=\"w-9 h-9 rounded-lg bg-slate-700 hover:bg-slate-600 text-slate-300 hover:text-white flex items-center justify-center transition-all active:scale-95\">\n                <SkipForward size={16} />\n              </button>\n            </div>\n            <div className=\"flex-1\"></div>\n          </div>\n        )}\n      </div>\n\n      {/* CỘT PHẢI: BẢNG THAM SỐ */}\n      <div className=\"space-y-4\">\n        {mode === 'mechanical' ? (\n          <>\n            <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50 animate-in fade-in slide-in-from-right-4 shadow-lg\">\n              <h3 className=\"text-cyan-400 font-bold mb-4 flex items-center gap-2 text-sm uppercase tracking-wider border-b border-slate-700/50 pb-2\">\n                <Waves className=\"w-4 h-4\" /> Thông số nguồn\n              </h3>\n              <div className=\"space-y-4\">\n                <div className=\"group\">\n                  <div className=\"flex justify-between text-xs mb-1\">\n                    <label className=\"text-slate-300\">Tần số (f)</label>\n                    <span className=\"text-cyan-400 font-mono\">{mechParams.frequency.toFixed(1)} Hz</span>\n                  </div>\n                  <input type=\"range\" min=\"0.5\" max=\"2.0\" step=\"0.1\" value={mechParams.frequency} onChange={(e) => setMechParams({ ...mechParams, frequency: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500\" />\n                </div>\n                <div className=\"group\">\n                  <div className=\"flex justify-between text-xs mb-1\">\n                    <label className=\"text-slate-300\">Bước sóng (λ)</label>\n                    <span className=\"text-cyan-400 font-mono\">{mechParams.wavelength} px</span>\n                  </div>\n                  <input type=\"range\" min=\"20\" max=\"80\" step=\"5\" value={mechParams.wavelength} onChange={(e) => setMechParams({ ...mechParams, wavelength: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500\" />\n                </div>\n                <div className=\"group\">\n                  <div className=\"flex justify-between text-xs mb-1\">\n                    <label className=\"text-slate-300\">Khoảng cách nguồn</label>\n                    <span className=\"text-cyan-400 font-mono\">{mechParams.sourceDistance} px</span>\n                  </div>\n                  <input type=\"range\" min=\"40\" max=\"250\" step=\"10\" value={mechParams.sourceDistance} onChange={(e) => setMechParams({ ...mechParams, sourceDistance: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500\" />\n                </div>\n                <div className=\"group\">\n                  <div className=\"flex justify-between text-xs mb-1\">\n                    <label className=\"text-slate-300\">Biên độ nguồn</label>\n                    <span className=\"text-cyan-400 font-mono\">{mechParams.amplitude.toFixed(1)}</span>\n                  </div>\n                  <input type=\"range\" min=\"0.5\" max=\"2.5\" step=\"0.1\" value={mechParams.amplitude} onChange={(e) => setMechParams({ ...mechParams, amplitude: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500\" />\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-[#1e293b] rounded-xl p-4 border border-slate-700/50 shadow-lg\">\n              <h3 className=\"text-cyan-400 font-bold mb-3 text-sm uppercase tracking-wider border-b border-slate-700/50 pb-2\">Hiển thị</h3>\n              <div className=\"space-y-2\">\n                <label className=\"flex items-center justify-between cursor-pointer group hover:bg-slate-800/50 p-2 rounded transition-colors\">\n                  <span className=\"text-slate-300 text-xs flex items-center gap-2\">\n                    {showNodalLines ? <Eye className=\"w-3 h-3 text-cyan-400\" /> : <EyeOff className=\"w-3 h-3 text-slate-500\" />}\n                    Đường cực tiểu (Nodal)\n                  </span>\n                  <div onClick={() => setShowNodalLines(!showNodalLines)} className={`w-8 h-4 rounded-full transition-all cursor-pointer flex items-center px-0.5 border ${showNodalLines ? \"bg-cyan-600 border-cyan-500\" : \"bg-slate-700 border-slate-600\"}`}>\n                    <div className={`w-3 h-3 bg-white rounded-full shadow-sm transform transition-transform ${showNodalLines ? \"translate-x-4\" : \"translate-x-0\"}`} />\n                  </div>\n                </label>\n                <label className=\"flex items-center justify-between cursor-pointer group hover:bg-slate-800/50 p-2 rounded transition-colors\">\n                  <span className=\"text-slate-300 text-xs flex items-center gap-2\">\n                    <Maximize2 className=\"w-3 h-3 text-slate-400\" />\n                    Chế độ 3D Surface\n                  </span>\n                  {/* SỬA LỖI SVG: Xóa xmlns bị lỗi */}\n                  <div onClick={() => setView3D(!view3D)} className={`w-8 h-4 rounded-full transition-all cursor-pointer flex items-center px-0.5 border ${view3D ? \"bg-cyan-600 border-cyan-500\" : \"bg-slate-700 border-slate-600\"}`}>\n                    <div className={`w-3 h-3 bg-white rounded-full shadow-sm transform transition-transform ${view3D ? \"translate-x-4\" : \"translate-x-0\"}`} />\n                  </div>\n                </label>\n              </div>\n            </div>\n          </>\n        ) : (\n          <>\n            <div className=\"bg-slate-900 rounded-xl p-4 border border-slate-700 animate-in fade-in slide-in-from-right-4 shadow-lg\">\n              <h3 className=\"text-emerald-400 font-bold mb-4 flex items-center gap-2 text-sm uppercase tracking-wider border-b border-slate-700 pb-2\">\n                <Zap className=\"w-4 h-4\" /> Điều Khiển\n              </h3>\n\n              <div className=\"bg-slate-800/50 p-3 rounded-lg mb-4 space-y-1\">\n                <p className=\"text-[10px] font-bold text-slate-400 mb-2 uppercase tracking-wide\">Chế độ</p>\n                <label className=\"flex items-center gap-2 cursor-pointer p-1.5 rounded hover:bg-slate-700/50 transition-colors\">\n                  <input type=\"radio\" name=\"lightMode\" checked={lightMode === 'mono'} onChange={() => setLightMode('mono')} className=\"accent-emerald-500 w-3 h-3\" />\n                  <span className={`text-xs ${lightMode === 'mono' ? 'text-white' : 'text-slate-400'}`}>Đơn sắc (<span className=\"font-serif italic\">λ₁</span>)</span>\n                </label>\n                <label className=\"flex items-center gap-2 cursor-pointer p-1.5 rounded hover:bg-slate-700/50 transition-colors\">\n                  <input type=\"radio\" name=\"lightMode\" checked={lightMode === 'dual'} onChange={() => setLightMode('dual')} className=\"accent-emerald-500 w-3 h-3\" />\n                  <span className={`text-xs ${lightMode === 'dual' ? 'text-white' : 'text-slate-400'}`}>Hai màu (<span className=\"font-serif italic\">λ₁, λ₂</span>)</span>\n                </label>\n                <label className=\"flex items-center gap-2 cursor-pointer p-1.5 rounded hover:bg-slate-700/50 transition-colors\">\n                  <input type=\"radio\" name=\"lightMode\" checked={lightMode === 'white'} onChange={() => setLightMode('white')} className=\"accent-emerald-500 w-3 h-3\" />\n                  <span className={`text-xs ${lightMode === 'white' ? 'text-white' : 'text-slate-400'}`}>Ánh sáng Trắng</span>\n                </label>\n              </div>\n\n              <div className=\"space-y-4\">\n                {(lightMode === 'mono' || lightMode === 'dual') && (\n                  <div className=\"group\">\n                    <div className=\"flex justify-between text-xs mb-1\">\n                      <label className=\"text-slate-300\">Bước sóng 1 (λ₁)</label>\n                      <span style={{ color: wavelengthToRGB(lightParams.wavelength1).colorString }} className=\"font-mono font-bold text-xs bg-slate-800 px-1.5 rounded\">\n                        {lightParams.wavelength1} nm\n                      </span>\n                    </div>\n                    <input type=\"range\" min=\"380\" max=\"750\" step=\"5\" value={lightParams.wavelength1} onChange={(e) => setLightParams({ ...lightParams, wavelength1: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500\" />\n                  </div>\n                )}\n\n                {lightMode === 'dual' && (\n                  <div className=\"group\">\n                    <div className=\"flex justify-between text-xs mb-1\">\n                      <label className=\"text-slate-300\">Bước sóng 2 (λ₂)</label>\n                      <span style={{ color: wavelengthToRGB(lightParams.wavelength2).colorString }} className=\"font-mono font-bold text-xs bg-slate-800 px-1.5 rounded\">\n                        {lightParams.wavelength2} nm\n                      </span>\n                    </div>\n                    <input type=\"range\" min=\"380\" max=\"750\" step=\"5\" value={lightParams.wavelength2} onChange={(e) => setLightParams({ ...lightParams, wavelength2: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500\" />\n                  </div>\n                )}\n\n                <div className=\"pt-2 border-t border-slate-700/50 space-y-3\">\n                  <div className=\"group\">\n                    <div className=\"flex justify-between text-xs mb-1\">\n                      <label className=\"text-slate-300\">Khoảng cách a</label>\n                      <span className=\"text-emerald-400 font-mono text-xs\">{lightParams.slitDistance.toFixed(2)} mm</span>\n                    </div>\n                    <input type=\"range\" min=\"0.2\" max=\"2.0\" step=\"0.05\" value={lightParams.slitDistance} onChange={(e) => setLightParams({ ...lightParams, slitDistance: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500\" />\n                  </div>\n\n                  <div className=\"group\">\n                    <div className=\"flex justify-between text-xs mb-1\">\n                      <label className=\"text-slate-300\">Khoảng cách D</label>\n                      <span className=\"text-emerald-400 font-mono text-xs\">{lightParams.screenDistance.toFixed(1)} m</span>\n                    </div>\n                    <input type=\"range\" min=\"1.0\" max=\"4.0\" step=\"0.1\" value={lightParams.screenDistance} onChange={(e) => setLightParams({ ...lightParams, screenDistance: Number(e.target.value) })} className=\"w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500\" />\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-emerald-600 rounded-xl p-3 border border-emerald-500 shadow-lg text-white\">\n              <h3 className=\"font-bold mb-2 text-xs flex items-center gap-2 uppercase tracking-wide opacity-90\">\n                <Disc className=\"w-3 h-3\" /> Kết Quả\n              </h3>\n\n              {lightMode === 'white' ? (\n                <div className=\"text-xs space-y-1 opacity-90\">\n                  <p>Dải màu cầu vồng.</p>\n                  <p>Vân trung tâm màu trắng.</p>\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between items-end border-b border-emerald-500/50 pb-1\">\n                    <span className=\"text-xs text-emerald-100 opacity-80\">i₁:</span>\n                    <span className=\"font-mono text-lg font-bold leading-none\">{calculateI(lightParams.wavelength1).toFixed(2)} <span className=\"text-[10px] font-normal opacity-70\">mm</span></span>\n                  </div>\n                  {lightMode === 'dual' && (\n                    <div className=\"flex justify-between items-end border-b border-emerald-500/50 pb-1\">\n                      <span className=\"text-xs text-emerald-100 opacity-80\">i₂:</span>\n                      <span className=\"font-mono text-lg font-bold leading-none\">{calculateI(lightParams.wavelength2).toFixed(2)} <span className=\"text-[10px] font-normal opacity-70\">mm</span></span>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8887, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/standing-waves.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Play, Pause, RefreshCw, Info, Settings, Zap, Type, ChevronRight, Circle } from 'lucide-react';\n\ntype BoundaryMode = 'fixed-fixed' | 'fixed-free';\n\nconst StandingWaveSim = () => {\n  // --- State Configuration ---\n  const [mode, setMode] = useState<BoundaryMode>('fixed-fixed');\n\n  // Physical parameters\n  const [length, setLength] = useState(1.5); // Length (m)\n  const [amplitude, setAmplitude] = useState(0.5); // Amplitude (relative units)\n  const [tension, setTension] = useState(50); // Tension (N)\n  const [linearDensity, setLinearDensity] = useState(0.01); // kg/m\n  const [frequency, setFrequency] = useState(40); // Frequency (Hz) - NEW INPUT\n\n  // Simulation state\n  const [isPlaying, setIsPlaying] = useState(true);\n  const [time, setTime] = useState(0);\n\n  // Canvas Refs\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const animationRef = useRef<number>();\n\n  // --- Physics Calculations ---\n  // v = sqrt(T / mu)\n  const waveSpeed = Math.sqrt(tension / linearDensity);\n\n  // lambda = v / f\n  const wavelength = waveSpeed / frequency;\n\n  // k_wave (angular wavenumber) = 2pi / lambda\n  const kWave = (2 * Math.PI) / wavelength;\n  const omega = 2 * Math.PI * frequency;\n\n  // Calculated Number of Antinodes (Real-time visual count) for the given Length\n  // k_visible = 2L / lambda\n  // If integer -> Resonance\n  const currentK = (2 * length) / wavelength;\n\n  // Energy rough estimation\n  const energy = 0.5 * linearDensity * length * Math.pow(omega * amplitude * 0.05, 2);\n\n  // --- Animation Loop ---\n  const animate = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    const width = canvas.width;\n    const height = canvas.height;\n    const centerY = height / 2;\n\n    // Dark Theme Colors\n    const colorBg = '#0f172a'; // slate-900\n    const colorGrid = '#1e293b'; // slate-800\n    const colorAxis = '#334155'; // slate-700\n    const colorWave = '#22d3ee'; // cyan-400 (Neon)\n    const colorNode = '#f472b6'; // pink-400\n    const colorText = '#94a3b8'; // slate-400\n\n    const padding = 60;\n    const drawWidth = width - 2 * padding;\n    const pxPerMeter = drawWidth / length;\n\n    // Clear canvas\n    ctx.fillStyle = colorBg;\n    ctx.fillRect(0, 0, width, height);\n\n    // 1. Draw Grid\n    ctx.strokeStyle = colorGrid;\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    for (let i = 0; i <= height; i += 40) { ctx.moveTo(0, i); ctx.lineTo(width, i); }\n    for (let i = 0; i <= width; i += 40) { ctx.moveTo(i, 0); ctx.lineTo(i, height); }\n    ctx.stroke();\n\n    // 2. Draw Axes\n    ctx.strokeStyle = colorAxis;\n    ctx.setLineDash([5, 5]);\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(padding, centerY);\n    ctx.lineTo(width - padding, centerY);\n    ctx.stroke();\n\n    // Vertical Ref Lines\n    ctx.setLineDash([]);\n    ctx.strokeStyle = colorAxis;\n    ctx.beginPath();\n    ctx.moveTo(padding, 40); ctx.lineTo(padding, height - 40); // Sound Source\n    ctx.moveTo(width - padding, 40); ctx.lineTo(width - padding, height - 40); // End Post\n    ctx.stroke();\n\n    // 3. Draw The Wave\n    ctx.beginPath();\n    ctx.moveTo(padding, centerY);\n\n    let endPointY = centerY;\n\n    // Simulate \"Standing Wave\" Pattern with Correct Boundary Conditions (Driven System)\n    // We model the string driven at x=0 with amplitude A, and fixed/free at x=L.\n\n    // Calculate Resonance Gain Factor (Denominator)\n    // To avoid infinity, we add a small \"damping\" term imaginary or just clamp the denominator.\n    // Simple approach: min(Limit, 1/sin(kL))\n\n    let denominator = 0;\n    if (mode === 'fixed-fixed') {\n      // Condition: sin(kL)\n      denominator = Math.sin(kWave * length);\n    } else {\n      // Condition: cos(kL) for Fixed-Free (Node at 0, Slope 0 at L... wait)\n      // Driver at 0 is Displacment Source.\n      // Fixed-Free means x=L is Free (Antinode of displacement, Node of Slope).\n      // Form: y(x) ~ cos(k(L-x)) -> y'(L)=0 (Slope 0, Max Amp). \n      // y(0) = cos(kL).\n      denominator = Math.cos(kWave * length);\n    }\n\n    // \"Soft\" resonance limit (Simulating Damping)\n    const damping = 0.15; // Minimum value of denominator\n    // If denominator is close to 0, wave blows up.\n    // Effective Gain = 1 / sqrt(den^2 + damp^2)\n    const gain = 1 / Math.sqrt(denominator * denominator + damping * damping);\n\n    // Phase shift? At resonance, phase flips. \n    // cos(wt) term is fine. We just multiply by (1/den). \n    // If den < 0, it flips phase naturally.\n\n    const maxVisualScale = 150;\n\n    for (let px = 0; px <= drawWidth; px++) {\n      const xPhysical = px / pxPerMeter;\n      let shape = 0;\n\n      if (mode === 'fixed-fixed') {\n        // Wave function satisfying y(L)=0\n        // y(x) = sin(k(L-x))\n        // Amplitude scaled to match y(0) = A_source\n        shape = Math.sin(kWave * (length - xPhysical));\n      } else {\n        // Wave function satisfying y'(L)=0 (Free End)\n        // y(x) = cos(k(L-x))\n        shape = Math.cos(kWave * (length - xPhysical));\n      }\n\n      // Resulting Wave\n      const envelope = amplitude * gain * shape;\n      const yPhysical = envelope * Math.cos(omega * time);\n\n      // Actually, just scale by fixed constant, let it grow.\n      // But limit screen space.\n\n      const yDrawFinal = centerY - yPhysical * 60; // 60 is view scale\n\n      ctx.lineTo(padding + px, yDrawFinal);\n      if (px === drawWidth) endPointY = yDrawFinal;\n    }\n\n    // Helper to draw fixed end correctly visually\n    // With sin(k(L-x)), at x_phys = length, sin(0) = 0. So yDraw = centerY.\n    // So B is Fixed. Correct.\n\n    // Neon Style Wave\n    ctx.strokeStyle = colorWave;\n    ctx.lineWidth = 3;\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    ctx.shadowBlur = 15;\n    ctx.shadowColor = colorWave;\n    ctx.stroke();\n    ctx.shadowBlur = 0;\n\n    // 4. Draw Nodes/Ends\n    // Point A (Source)\n    ctx.fillStyle = colorNode;\n    ctx.beginPath();\n    ctx.arc(padding, centerY, 6, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.fillStyle = colorText;\n    ctx.font = '600 14px \"Courier New\", monospace';\n    ctx.fillText('A (Nguồn)', padding - 30, centerY - 20);\n\n    // Point B (End)\n    // If Fixed: Clamp. If Free: Ring.\n    // We draw the clamp at the PHYSICAL location L. \n    // If the wave node doesn't match, it visually \"passes through\" or looks disconnected?\n    // Let's draw the clamp rigidly.\n\n    if (mode === 'fixed-fixed') {\n      ctx.fillStyle = colorNode;\n      ctx.beginPath();\n      ctx.arc(width - padding, centerY, 6, 0, Math.PI * 2); // Clamp is always at 0 displacement\n      ctx.fill();\n      ctx.fillStyle = colorText;\n      ctx.fillText('B (Cố định)', width - padding - 40, centerY - 20);\n\n      // Visual feedback: If EndPointY is far from CenterY -> \"Vibration at Clamp\" (Bad)\n      if (Math.abs(endPointY - centerY) > 5) {\n        ctx.strokeStyle = \"red\";\n        ctx.lineWidth = 1;\n        ctx.beginPath();\n        ctx.moveTo(width - padding, centerY);\n        ctx.lineTo(width - padding, endPointY);\n        ctx.stroke();\n      }\n\n    } else {\n      // Fixed-Free: B is a ring on a pole\n      ctx.strokeStyle = colorNode;\n      ctx.lineWidth = 3;\n      ctx.fillStyle = '#0f172a';\n      ctx.beginPath();\n      ctx.arc(width - padding, endPointY, 6, 0, Math.PI * 2); // Ring moves with wave\n      ctx.fill();\n      ctx.stroke();\n\n      // Pole\n      ctx.strokeStyle = 'rgba(255,255,255,0.2)';\n      ctx.lineWidth = 4;\n      ctx.beginPath();\n      ctx.moveTo(width - padding, centerY - 100);\n      ctx.lineTo(width - padding, centerY + 100);\n      ctx.stroke();\n\n      ctx.fillStyle = colorText;\n      ctx.fillText('B (Tự do)', width - padding - 40, endPointY - 30);\n    }\n\n    // Draw Time\n    ctx.fillStyle = '#fff';\n    ctx.font = '16px \"Courier New\", monospace';\n    ctx.fillText(`t = ${time.toFixed(3)}s`, 20, 30);\n\n    // Update time\n    const timeStep = 0.005;\n    if (isPlaying) {\n      setTime(prev => prev + timeStep);\n    }\n\n    animationRef.current = requestAnimationFrame(animate);\n  }, [length, amplitude, kWave, omega, time, isPlaying, mode]);\n\n  useEffect(() => {\n    animationRef.current = requestAnimationFrame(animate);\n    return () => {\n      if (animationRef.current) cancelAnimationFrame(animationRef.current);\n    };\n  }, [animate]);\n\n  const handleReset = () => {\n    setTime(0);\n    setIsPlaying(true);\n  };\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-[#020617] font-sans text-slate-200 selection:bg-cyan-500/30\">\n\n      <main className=\"flex-grow p-4 md:p-8 max-w-7xl mx-auto w-full grid grid-cols-1 lg:grid-cols-12 gap-8\">\n\n        {/* LEFT COLUMN: VISUALIZATION (8 cols) */}\n        <div className=\"lg:col-span-8 flex flex-col gap-6\">\n\n          {/* Canvas Card */}\n          <div className=\"bg-[#0f172a] rounded-2xl shadow-2xl border border-slate-800 overflow-hidden relative group\">\n            <div className=\"absolute top-4 right-4 z-10 flex gap-2\">\n              <div className={`px-3 py-1 rounded-full text-xs font-bold border ${mode === 'fixed-fixed' ? 'border-cyan-500/50 text-cyan-400 bg-cyan-950/30' : 'border-slate-700 text-slate-400 bg-slate-900/50'}`}>\n                2 ĐẦU CỐ ĐỊNH\n              </div>\n              <div className={`px-3 py-1 rounded-full text-xs font-bold border ${mode === 'fixed-free' ? 'border-pink-500/50 text-pink-400 bg-pink-950/30' : 'border-slate-700 text-slate-400 bg-slate-900/50'}`}>\n                1 ĐẦU TỰ DO\n              </div>\n            </div>\n\n            <canvas\n              ref={canvasRef}\n              width={900}\n              height={500}\n              className=\"w-full h-auto bg-[#0f172a]\"\n            />\n          </div>\n\n          {/* Playback Control Bar */}\n          <div className=\"bg-[#0f172a] rounded-2xl border border-slate-800 p-4 flex items-center justify-between shadow-lg\">\n            <div className=\"flex items-center gap-4\">\n              <button\n                onClick={handleReset}\n                className=\"w-10 h-10 flex items-center justify-center rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-300 transition-colors\"\n                title=\"Reset\"\n              >\n                <RefreshCw size={18} />\n              </button>\n              <div className=\"h-8 w-[1px] bg-slate-700 mx-2\"></div>\n              <button\n                onClick={() => setIsPlaying(!isPlaying)}\n                className={`w-14 h-14 flex items-center justify-center rounded-full shadow-lg transition-all active:scale-95 ${isPlaying ? 'bg-cyan-500/20 text-cyan-400 ring-2 ring-cyan-500/50' : 'bg-cyan-500 text-slate-900 hover:bg-cyan-400'}`}\n              >\n                {isPlaying ? <Pause size={28} fill=\"currentColor\" /> : <Play size={28} fill=\"currentColor\" className=\"ml-1\" />}\n              </button>\n            </div>\n\n            {/* Live Data Display (Mini) */}\n            <div className=\"hidden sm:flex gap-8 text-right font-mono text-sm\">\n              <div title=\"Số bó sóng thực tế (k)\">\n                <div className=\"text-slate-500 text-xs uppercase mb-1\">Harmonics (k)</div>\n                <div className={`font-bold text-lg ${Math.abs(currentK - Math.round(currentK)) < 0.1 ? 'text-green-400' : 'text-slate-400'}`}>\n                  {currentK.toFixed(2)}\n                </div>\n              </div>\n              <div>\n                <div className=\"text-slate-500 text-xs uppercase mb-1\">Wavelength</div>\n                <div className=\"text-pink-400 font-bold text-lg\">{wavelength.toFixed(2)} <span className=\"text-xs text-slate-500\">m</span></div>\n              </div>\n            </div>\n          </div>\n\n          {/* Theory / Formulas Card */}\n          <div className=\"bg-[#0f172a] rounded-2xl border border-slate-800 p-6 shadow-lg\">\n            <h3 className=\"text-cyan-400 font-bold mb-4 flex items-center gap-2\">\n              <Type size={18} /> Công thức Sóng Dừng\n            </h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-slate-300 font-mono leading-relaxed\">\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between border-b border-slate-800 pb-2\">\n                  <span>Vận tốc (v):</span>\n                  <span className=\"text-emerald-400\">√(T/μ) = {waveSpeed.toFixed(1)} m/s</span>\n                </div>\n                <div className=\"flex justify-between border-b border-slate-800 pb-2\">\n                  <span>Bước sóng (λ):</span>\n                  <span className=\"text-emerald-400\">v/f = {wavelength.toFixed(2)} m</span>\n                </div>\n                <div className=\"flex justify-between border-b border-slate-800 pb-2\">\n                  <span>Số bó sóng (k):</span>\n                  <span className=\"text-emerald-400\">2L/λ = {currentK.toFixed(2)}</span>\n                </div>\n              </div>\n              <div className=\"bg-slate-900/50 p-4 rounded-lg border border-slate-800\">\n                <p className=\"text-slate-400 text-xs mb-2 uppercase tracking-wider\">Điều kiện biên ({mode === 'fixed-fixed' ? '2 Đầu Cố Định' : '1 Đầu Tự Do'})</p>\n                <div className=\"text-lg text-pink-300\">\n                  {mode === 'fixed-fixed' ? 'L = k(λ/2)' : 'L = (2k-1)(λ/4)'}\n                </div>\n                <p className={`mt-2 text-xs italic ${Math.abs(currentK - Math.round(currentK)) < 0.1 ? 'text-green-400' : 'text-slate-500'}`}>\n                  {Math.abs(currentK - Math.round(currentK)) < 0.1 ? '✓ Đang cộng hưởng!' : '• Chưa cộng hưởng'}\n                </p>\n              </div>\n            </div>\n          </div>\n\n        </div>\n\n        {/* RIGHT COLUMN: CONTROLS (4 cols) */}\n        <div className=\"lg:col-span-4 flex flex-col gap-6\">\n\n          {/* Main Parameters Panel */}\n          <div className=\"bg-[#0f172a] rounded-2xl border border-slate-800 p-6 shadow-lg\">\n            <h2 className=\"text-lg font-bold mb-6 text-white flex items-center gap-2\">\n              <Settings size={20} className=\"text-cyan-400\" /> Thông số dao động\n            </h2>\n\n            {/* Mode Toggle */}\n            <div className=\"mb-8 p-1 bg-slate-900 rounded-lg flex border border-slate-800\">\n              <button\n                onClick={() => setMode('fixed-fixed')}\n                className={`flex-1 py-2 text-xs font-bold rounded-md transition-all uppercase tracking-wide ${mode === 'fixed-fixed'\n                  ? 'bg-cyan-500 text-slate-900 shadow-lg shadow-cyan-500/20'\n                  : 'text-slate-500 hover:text-slate-300'\n                  }`}\n              >\n                2 Đầu Cố Định\n              </button>\n              <button\n                onClick={() => setMode('fixed-free')}\n                className={`flex-1 py-2 text-xs font-bold rounded-md transition-all uppercase tracking-wide ${mode === 'fixed-free'\n                  ? 'bg-pink-500 text-slate-900 shadow-lg shadow-pink-500/20'\n                  : 'text-slate-500 hover:text-slate-300'\n                  }`}\n              >\n                1 Đầu Tự Do\n              </button>\n            </div>\n\n            {/* Sliders */}\n            <div className=\"space-y-8\">\n\n              {/* Frequency (Replaced K) */}\n              <div className=\"group\">\n                <div className=\"flex justify-between text-sm mb-2 font-medium\">\n                  <span className=\"text-slate-400 group-hover:text-cyan-400 transition-colors\">Tần số (Hz)</span>\n                  <span className=\"text-cyan-400 font-mono\">{frequency} Hz</span>\n                </div>\n                <input\n                  type=\"range\" min=\"10\" max=\"100\" step=\"1\"\n                  value={frequency}\n                  onChange={(e) => setFrequency(parseInt(e.target.value))}\n                  className=\"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-500 hover:accent-cyan-400\"\n                />\n              </div>\n\n              {/* Length */}\n              <div className=\"group\">\n                <div className=\"flex justify-between text-sm mb-2 font-medium\">\n                  <span className=\"text-slate-400 group-hover:text-cyan-400 transition-colors\">Chiều dài dây (L)</span>\n                  <span className=\"text-cyan-400 font-mono\">{length.toFixed(1)} m</span>\n                </div>\n                <input\n                  type=\"range\" min=\"0.5\" max=\"5.0\" step=\"0.1\"\n                  value={length}\n                  onChange={(e) => setLength(Number(e.target.value))}\n                  className=\"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-500 hover:accent-cyan-400\"\n                />\n              </div>\n\n              {/* Tension */}\n              <div className=\"group\">\n                <div className=\"flex justify-between text-sm mb-2 font-medium\">\n                  <span className=\"text-slate-400 group-hover:text-cyan-400 transition-colors\">Lực căng (T)</span>\n                  <span className=\"text-cyan-400 font-mono\">{tension} N</span>\n                </div>\n                <input\n                  type=\"range\" min=\"10\" max=\"200\" step=\"1\"\n                  value={tension}\n                  onChange={(e) => setTension(Number(e.target.value))}\n                  className=\"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-500 hover:accent-cyan-400\"\n                />\n              </div>\n\n              {/* Amplitude */}\n              <div className=\"group\">\n                <div className=\"flex justify-between text-sm mb-2 font-medium\">\n                  <span className=\"text-slate-400 group-hover:text-cyan-400 transition-colors\">Biên độ nguồn (A)</span>\n                  <span className=\"text-cyan-400 font-mono\">{(amplitude * 2).toFixed(1)} cm</span>\n                </div>\n                <input\n                  type=\"range\" min=\"0.1\" max=\"1.0\" step=\"0.1\"\n                  value={amplitude}\n                  onChange={(e) => setAmplitude(Number(e.target.value))}\n                  className=\"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-500 hover:accent-cyan-400\"\n                />\n              </div>\n\n              {/* Density */}\n              <div className=\"group\">\n                <div className=\"flex justify-between text-sm mb-2 font-medium\">\n                  <span className=\"text-slate-400 group-hover:text-cyan-400 transition-colors\">Mật độ dây (μ)</span>\n                  <span className=\"text-cyan-400 font-mono\">{linearDensity.toFixed(3)} kg/m</span>\n                </div>\n                <input\n                  type=\"range\" min=\"0.001\" max=\"0.05\" step=\"0.001\"\n                  value={linearDensity}\n                  onChange={(e) => setLinearDensity(Number(e.target.value))}\n                  className=\"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-500 hover:accent-cyan-400\"\n                />\n              </div>\n\n            </div>\n          </div>\n\n          {/* Energy / Stats Panel */}\n          <div className=\"bg-[#0f172a] rounded-2xl border border-slate-800 p-6 shadow-lg\">\n            <h3 className=\"text-yellow-400 font-bold mb-4 flex items-center gap-2\">\n              <Zap size={18} /> Năng lượng sóng\n            </h3>\n\n            <div className=\"space-y-4\">\n              <div>\n                <div className=\"flex justify-between text-xs text-slate-400 mb-1\">\n                  <span>Tốc độ truyền sóng (v)</span>\n                  <span className=\"text-emerald-400 font-mono\">{waveSpeed.toFixed(1)} m/s</span>\n                </div>\n                <div className=\"h-1.5 w-full bg-slate-800 rounded-full overflow-hidden\">\n                  <div\n                    className=\"h-full bg-emerald-500 rounded-full transition-all duration-300\"\n                    style={{ width: `${Math.min((waveSpeed / 200) * 100, 100)}%` }}\n                  ></div>\n                </div>\n              </div>\n\n              <div>\n                <div className=\"flex justify-between text-xs text-slate-400 mb-1\">\n                  <span>Ước lượng năng lượng (E)</span>\n                  <span className=\"text-yellow-400 font-mono\">{energy.toFixed(3)} J</span>\n                </div>\n                <div className=\"h-1.5 w-full bg-slate-800 rounded-full overflow-hidden\">\n                  <div\n                    className=\"h-full bg-yellow-500 rounded-full transition-all duration-300\"\n                    style={{ width: `${Math.min((energy * 50), 100)}%` }}\n                  ></div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mt-6 pt-4 border-t border-slate-800\">\n              <div className=\"flex items-start gap-2 text-xs text-slate-500\">\n                <Circle size={12} className=\"mt-0.5 text-cyan-400 fill-cyan-400 animate-pulse\" />\n                <span>Điều chỉnh Tần số, Chiều dài, hoặc Lực căng để tìm điểm cộng hưởng (k nguyên).</span>\n              </div>\n            </div>\n          </div>\n\n        </div>\n      </main>\n    </div>\n  );\n};\nexport default StandingWaveSim;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9996, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/experiments/sound-speed.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Play, Pause, RefreshCw, Volume2, Mic, Settings, Info, Zap } from 'lucide-react';\r\n\r\nconst SoundSpeedExperiment = () => {\r\n    // --- State ---\r\n    // Length of air column L (m)\r\n    // We control the Water Level. Tube Length is fixed (say 1.2m).\r\n    // waterLevel is distance from bottom. L = TubeHeight - waterLevel.\r\n    // Actually simpler: Input is \"Air Column Length L\" directly (simulating moving reservoir).\r\n    const [airLength, setAirLength] = useState(0.5); // meters\r\n    const [frequency, setFrequency] = useState(440); // Hz\r\n    const [temperature, setTemperature] = useState(20); // Celsius (affects V)\r\n    const [isPlaying, setIsPlaying] = useState(true);\r\n    const [volume, setVolume] = useState(0.5); // Simulation Volume\r\n\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const animationRef = useRef<number>();\r\n    const timeRef = useRef(0);\r\n\r\n    // --- Physics ---\r\n    // v = 331.5 + 0.6 * T\r\n    const speedOfSound = 331.5 + 0.6 * temperature;\r\n    const wavelength = speedOfSound / frequency;\r\n\r\n    // Resonance condition for Closed Tube (water closed one end):\r\n    // Resonance starts at L = lambda/4, 3lambda/4, 5lambda/4 ...\r\n    // L_resonance = (2k + 1) * lambda / 4\r\n\r\n    // Calculate resonance \"intensity\" (0 to 1) based on how close L is to resonance\r\n    // A simple Lorentzian or Gaussian peak around resonance points.\r\n    const calculateResonanceIntensity = (L: number, lambda: number) => {\r\n        // Find closest resonance mode\r\n        // L = n * lambda/4 where n is odd integer\r\n        const n_float = (4 * L) / lambda;\r\n        // We want n close to 1, 3, 5, 7...\r\n        // Distance to closest odd integer:\r\n        const n_round = Math.round(n_float);\r\n        const isOdd = n_round % 2 !== 0;\r\n\r\n        // If rounded is even, we are far from odd resonance? Be careful.\r\n        // e.g. 2.0 -> Resonances at 1.0, 3.0.  2.0 is anti-resonance.\r\n        // Distance to closest ODD integer:\r\n        // math trick: distance(x, odd) = abs( (x-1)/2 - round((x-1)/2) ) * 2 ?? No.\r\n        // Simpler: find closest k for (2k+1). \r\n        // Target = (2k+1). Closest match.\r\n\r\n        // Scan typical modes (1, 3, 5, 7, 9)\r\n        let minDiff = 1000;\r\n        for (let k = 0; k < 10; k++) {\r\n            const targetN = 2 * k + 1;\r\n            const diff = Math.abs(n_float - targetN);\r\n            if (diff < minDiff) minDiff = diff;\r\n        }\r\n\r\n        // Width of resonance peak (Q factor simulation)\r\n        const width = 0.15; // Tuning sharpness\r\n        // Resonance shape: 1 / (1 + (diff/width)^2)\r\n        return 1 / (1 + (minDiff / width) ** 2);\r\n    };\r\n\r\n    const resonanceIntensity = calculateResonanceIntensity(airLength, wavelength);\r\n\r\n    // --- Audio Engine ---\r\n    const [isMuted, setIsMuted] = useState(false);\r\n    const audioContextRef = useRef<AudioContext | null>(null);\r\n    const oscillatorRef = useRef<OscillatorNode | null>(null);\r\n    const gainNodeRef = useRef<GainNode | null>(null);\r\n\r\n    // Initialize Audio Context on first play interact (or effect, but suspended)\r\n    useEffect(() => {\r\n        if (!audioContextRef.current) {\r\n            const AudioContextClass = window.AudioContext || (window as any).webkitAudioContext;\r\n            audioContextRef.current = new AudioContextClass();\r\n\r\n            // Master Gain\r\n            const gainNode = audioContextRef.current.createGain();\r\n            gainNode.connect(audioContextRef.current.destination);\r\n            gainNodeRef.current = gainNode;\r\n        }\r\n        return () => {\r\n            if (audioContextRef.current) {\r\n                audioContextRef.current.close();\r\n                audioContextRef.current = null;\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    // Handle Oscillator & Playback\r\n    useEffect(() => {\r\n        const ctx = audioContextRef.current;\r\n        if (!ctx) return;\r\n\r\n        if (isPlaying && !isMuted) {\r\n            // Resume if suspended (browser policy)\r\n            if (ctx.state === 'suspended') ctx.resume();\r\n\r\n            // Create Osc if needed\r\n            if (!oscillatorRef.current) {\r\n                const osc = ctx.createOscillator();\r\n                osc.type = 'sine';\r\n                osc.frequency.setValueAtTime(frequency, ctx.currentTime);\r\n                osc.connect(gainNodeRef.current!);\r\n                osc.start();\r\n                oscillatorRef.current = osc;\r\n            } else {\r\n                // Update freq smoothly\r\n                oscillatorRef.current.frequency.setTargetAtTime(frequency, ctx.currentTime, 0.1);\r\n            }\r\n        } else {\r\n            // Stop\r\n            if (oscillatorRef.current) {\r\n                oscillatorRef.current.stop();\r\n                oscillatorRef.current.disconnect();\r\n                oscillatorRef.current = null;\r\n            }\r\n        }\r\n    }, [isPlaying, isMuted, frequency]);\r\n\r\n    // Handle Volume / Resonance\r\n    useEffect(() => {\r\n        const ctx = audioContextRef.current;\r\n        const gainNode = gainNodeRef.current;\r\n\r\n        if (ctx && gainNode) {\r\n            if (!isPlaying || isMuted) {\r\n                gainNode.gain.setTargetAtTime(0, ctx.currentTime, 0.1);\r\n            } else {\r\n                // Base volume (0.01) + Resonance Boost (up to 0.3)\r\n                // When resonant -> Loud. When not -> Quiet hum.\r\n                const targetGain = 0.01 + (resonanceIntensity * 0.4);\r\n                gainNode.gain.setTargetAtTime(targetGain, ctx.currentTime, 0.1);\r\n            }\r\n        }\r\n    }, [resonanceIntensity, isPlaying, isMuted]);\r\n\r\n    // --- Animation ---\r\n    const animate = useCallback(() => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return;\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) return;\r\n\r\n        const width = canvas.width;\r\n        const height = canvas.height;\r\n        const centerX = width / 2;\r\n\r\n        // Time update\r\n        if (isPlaying) {\r\n            timeRef.current += 0.01; // dt\r\n        }\r\n        const t = timeRef.current;\r\n\r\n        // --- Draw ---\r\n        ctx.clearRect(0, 0, width, height);\r\n\r\n        // Background\r\n        ctx.fillStyle = \"#0f172a\";\r\n        ctx.fillRect(0, 0, width, height);\r\n\r\n        // 1. Draw Tube system\r\n        const tubeWidth = 60;\r\n        const tubeHeight = 400; // pixels\r\n        const tubeBottomY = height - 50;\r\n        const tubeTopY = tubeBottomY - tubeHeight;\r\n        const tubeX = centerX;\r\n\r\n        // Scale: 1.2m = tubeHeight (400px) => 1m = 333px\r\n        const pxPerM = tubeHeight / 1.2;\r\n        const airHeightPx = airLength * pxPerM;\r\n        const waterLevelY = tubeTopY + airHeightPx;\r\n\r\n        // Draw Water (Blue)\r\n        ctx.fillStyle = \"rgba(6, 182, 212, 0.6)\"; // Cyan-500\r\n        ctx.fillRect(tubeX - tubeWidth / 2, waterLevelY, tubeWidth, tubeBottomY - waterLevelY);\r\n\r\n        // Draw Glass Tube Walls\r\n        ctx.strokeStyle = \"rgba(255, 255, 255, 0.4)\";\r\n        ctx.lineWidth = 4;\r\n        ctx.beginPath();\r\n        ctx.moveTo(tubeX - tubeWidth / 2, tubeTopY - 20); // Top flare\r\n        ctx.lineTo(tubeX - tubeWidth / 2, tubeBottomY);\r\n        ctx.lineTo(tubeX + tubeWidth / 2, tubeBottomY);\r\n        ctx.lineTo(tubeX + tubeWidth / 2, tubeTopY - 20);\r\n        ctx.stroke();\r\n\r\n        // 2. Tuning Fork (Above Tube)\r\n        const forkY = tubeTopY - 40;\r\n        const forkAmp = isPlaying ? 3 : 0;\r\n        const vib = Math.sin(t * frequency * 0.5) * forkAmp; // Fake visual freq\r\n\r\n        // Stem\r\n        ctx.strokeStyle = \"#94a3b8\"; // Slate-400\r\n        ctx.lineWidth = 6;\r\n        ctx.beginPath();\r\n        ctx.moveTo(centerX, forkY);\r\n        ctx.lineTo(centerX, forkY - 40);\r\n        ctx.stroke();\r\n\r\n        // Prongs (Vibrating)\r\n        ctx.lineWidth = 4;\r\n        ctx.beginPath();\r\n        // Left Prong\r\n        ctx.moveTo(centerX, forkY);\r\n        ctx.quadraticCurveTo(centerX - 15 + vib, forkY + 30, centerX - 15 + vib, forkY + 60);\r\n        // Right Prong\r\n        ctx.moveTo(centerX, forkY);\r\n        ctx.quadraticCurveTo(centerX + 15 - vib, forkY + 30, centerX + 15 - vib, forkY + 60);\r\n        ctx.stroke();\r\n\r\n        // 3. Sound Waves (Visualizing Resonance)\r\n        // Standing Wave inside air column\r\n        // Node at water (Closed end), Antinode at open top (approx).\r\n        if (isPlaying) {\r\n            ctx.strokeStyle = `rgba(244, 114, 182, ${0.3 + resonanceIntensity * 0.7})`; // Pink, brighter if resonant\r\n            ctx.lineWidth = 2;\r\n            ctx.beginPath();\r\n\r\n            // Draw sine wave envelope vertical\r\n            // y from tubeTopY to waterLevelY (0 to L)\r\n            // Amplitude = Envelope\r\n            const steps = 50;\r\n            for (let i = 0; i <= steps; i++) {\r\n                const yRel = (i / steps) * airHeightPx; // 0 (top) to H (bottom)\r\n                const yDraw = tubeTopY + yRel;\r\n\r\n                // Physics: Closed End at Bottom (Node), Open at Top (Antinode)\r\n                // WAIT! Standing wave shape:\r\n                // Bottom (Water): Displacement Node -> Amp = 0.\r\n                // Top (Open): Displacement Antinode -> Amp = Max.\r\n                // Function: sin(k * distance_from_bottom)\r\n                // distance_from_bottom = airHeightPx - yRel\r\n\r\n                const xPhys = airLength - (yRel / pxPerM); // x=0 at bottom\r\n                // k * xPhys\r\n                // k = 2pi / lambda\r\n                const k = (2 * Math.PI) / wavelength;\r\n                // Standing wave term: sin(kx) * cos(wt)\r\n                // Scale amplitude by resonanceIntensity!\r\n                const standingAmp = 15 * resonanceIntensity * Math.sin(k * xPhys);\r\n\r\n                // Visualize instantaneous\r\n                const displace = standingAmp * Math.cos(t * frequency * 0.2); // Slow visual freq\r\n\r\n                if (i === 0) ctx.moveTo(centerX + displace, yDraw);\r\n                else ctx.lineTo(centerX + displace, yDraw);\r\n            }\r\n            ctx.stroke();\r\n\r\n            // Emit Sound Waves OUTSIDE (Arcs)\r\n            // Intensity depends on Resonance\r\n            if (resonanceIntensity > 0.1) {\r\n                ctx.strokeStyle = `rgba(255, 255, 255, ${resonanceIntensity - (t % 1)})`;\r\n                ctx.lineWidth = 2;\r\n                const rBase = (t * 50) % 100;\r\n                for (let r = rBase; r < 200; r += 40) {\r\n                    const alpha = Math.max(0, 1 - r / 200) * resonanceIntensity;\r\n                    ctx.strokeStyle = `rgba(255,255,255,${alpha})`;\r\n                    ctx.beginPath();\r\n                    ctx.arc(centerX, forkY, r, Math.PI, 0); // Top semi-circles\r\n                    ctx.stroke();\r\n                }\r\n            }\r\n        }\r\n\r\n        // 4. Ruler / Measurement\r\n        ctx.fillStyle = \"#64748b\";\r\n        ctx.font = \"12px monospace\";\r\n        ctx.textAlign = \"right\";\r\n        for (let m = 0; m <= 1.2; m += 0.1) {\r\n            const yMark = tubeTopY + (m * pxPerM);\r\n            if (yMark > tubeBottomY) break;\r\n            ctx.fillRect(tubeX - tubeWidth / 2 - 10, yMark, 8, 1);\r\n            ctx.fillText(`${m.toFixed(1)}m`, tubeX - tubeWidth / 2 - 14, yMark + 4);\r\n        }\r\n\r\n        // Current Level Indicator\r\n        ctx.strokeStyle = \"#ef4444\"; // Red\r\n        ctx.setLineDash([4, 4]);\r\n        ctx.beginPath();\r\n        ctx.moveTo(tubeX - tubeWidth - 20, waterLevelY);\r\n        ctx.lineTo(tubeX + tubeWidth + 20, waterLevelY);\r\n        ctx.stroke();\r\n        ctx.setLineDash([]);\r\n        ctx.fillStyle = \"#ef4444\";\r\n        ctx.fillText(`L = ${airLength.toFixed(3)}m`, tubeX - tubeWidth - 25, waterLevelY + 4);\r\n\r\n\r\n        animationRef.current = requestAnimationFrame(animate);\r\n    }, [airLength, frequency, isPlaying, resonanceIntensity, wavelength]);\r\n\r\n    useEffect(() => {\r\n        animationRef.current = requestAnimationFrame(animate);\r\n        return () => {\r\n            if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n        };\r\n    }, [animate]);\r\n\r\n    return (\r\n        <div className=\"flex flex-col min-h-screen bg-[#020617] font-sans text-slate-200\">\r\n            <main className=\"flex-grow p-4 md:p-8 max-w-6xl mx-auto w-full grid grid-cols-1 lg:grid-cols-12 gap-8\">\r\n\r\n                {/* Sim Canvas */}\r\n                <div className=\"lg:col-span-7 bg-[#0f172a] rounded-2xl border border-slate-800 shadow-xl overflow-hidden relative\">\r\n                    <canvas ref={canvasRef} width={600} height={600} className=\"w-full h-full object-contain\" />\r\n\r\n                    {/* Loudness Meter Overlay */}\r\n                    <div className=\"absolute top-4 left-4 bg-slate-900/80 p-3 rounded-lg border border-slate-700 backdrop-blur-sm\">\r\n                        <div className=\"flex items-center gap-2 mb-2 text-pink-400 font-bold text-sm\">\r\n                            <Mic size={16} /> Cường độ âm (dB)\r\n                        </div>\r\n                        <div className=\"w-4 h-32 bg-slate-800 rounded-full overflow-hidden flex flex-col justify-end border border-slate-700 mx-auto\">\r\n                            <div\r\n                                className=\"w-full bg-gradient-to-t from-green-500 via-yellow-500 to-red-500 transition-all duration-100\"\r\n                                style={{ height: `${resonanceIntensity * 100}%` }}\r\n                            ></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Controls */}\r\n                <div className=\"lg:col-span-5 flex flex-col gap-6\">\r\n                    <div className=\"bg-[#1e293b] rounded-2xl p-6 border border-slate-700 shadow-lg\">\r\n                        <h2 className=\"text-xl font-bold text-cyan-400 mb-6 flex items-center gap-2\">\r\n                            <Settings size={20} /> Thiết lập thí nghiệm\r\n                        </h2>\r\n\r\n                        {/* Frequency Slider */}\r\n                        <div className=\"mb-6\">\r\n                            <div className=\"flex justify-between items-center mb-2\">\r\n                                <span className=\"text-slate-400 text-sm\">Tần số âm thoa (f)</span>\r\n                                <button \r\n                                    onClick={() => setIsMuted(!isMuted)}\r\n                                    className={`p-2 rounded-full transition-colors flex items-center gap-2 text-xs font-bold ${!isMuted ? 'bg-cyan-500/20 text-cyan-400 border border-cyan-500/50' : 'bg-slate-800 text-slate-400 border border-slate-700'}`}\r\n                                >\r\n                                    {!isMuted ? <Volume2 size={16} /> : <Volume2 size={16} className=\"opacity-50\" />}\r\n                                    {!isMuted ? \"ON\" : \"OFF\"}\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"flex justify-between text-sm mb-2\">\r\n                                <span className=\"text-cyan-400 font-mono\">{frequency} Hz</span>\r\n                            </div>\r\n                            <input\r\n                                type=\"range\" min=\"200\" max=\"1000\" step=\"10\"\r\n                                value={frequency}\r\n                                onChange={(e) => setFrequency(Number(e.target.value))}\r\n                                className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Length Slider */}\r\n                        <div className=\"mb-6\">\r\n                            <div className=\"flex justify-between text-sm mb-2\">\r\n                                <span className=\"text-slate-400\">Chiều dài cột khí (L)</span>\r\n                                <span className=\"text-cyan-400 font-mono\">{(airLength * 100).toFixed(1)} cm</span>\r\n                            </div>\r\n                            <input\r\n                                type=\"range\" min=\"0.1\" max=\"1.0\" step=\"0.001\"\r\n                                value={airLength}\r\n                                onChange={(e) => setAirLength(Number(e.target.value))}\r\n                                className=\"w-full accent-cyan-500 h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\r\n                            />\r\n                            <div className=\"text-xs text-slate-500 mt-1 flex justify-between\">\r\n                                <button className=\"text-cyan-600 hover:text-cyan-400\" onClick={() => setAirLength(Math.max(0.1, airLength - 0.005))}>- Fine</button>\r\n                                <button className=\"text-cyan-600 hover:text-cyan-400\" onClick={() => setAirLength(Math.min(1.0, airLength + 0.005))}>+ Fine</button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Readout */}\r\n                        <div className=\"bg-slate-900/50 p-4 rounded-lg border border-slate-800 space-y-2\">\r\n                            <div className=\"flex justify-between text-sm\">\r\n                                <span className=\"text-slate-400\">Tốc độ âm (lý thuyết):</span>\r\n                                <span className=\"text-emerald-400 font-mono\">{speedOfSound.toFixed(1)} m/s</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between text-sm\">\r\n                                <span className=\"text-slate-400\">Bước sóng (λ):</span>\r\n                                <span className=\"text-pink-400 font-mono\">{wavelength.toFixed(3)} m</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between text-sm font-bold pt-2 border-t border-slate-800\">\r\n                                <span className=\"text-slate-300\">Cộng hưởng?</span>\r\n                                <span className={resonanceIntensity > 0.8 ? \"text-green-400 animate-pulse\" : \"text-slate-600\"}>\r\n                                    {resonanceIntensity > 0.8 ? \"MAX (Nghe to nhất)\" : \"---\"}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Guide */}\r\n                    <div className=\"bg-[#1e293b] rounded-2xl p-6 border border-slate-700 shadow-lg flex-grow\">\r\n                        <h3 className=\"text-lg font-bold text-yellow-400 mb-4 flex items-center gap-2\">\r\n                            <Info size={18} /> Hướng dẫn\r\n                        </h3>\r\n                        <ul className=\"text-sm text-slate-300 space-y-2 list-disc pl-4\">\r\n                            <li>Điều chỉnh độ cao cột khí (mực nước) bằng thanh trượt L.</li>\r\n                            <li>Lắng nghe hoặc quan sát thanh đo cường độ âm.</li>\r\n                            <li>Khi cột khí có độ dài thích hợp ($L = (2k+1)\\lambda/4$), hiện tượng <strong>cộng hưởng</strong> xảy ra, âm thanh sẽ nghe to nhất.</li>\r\n                            <li>Sử dụng các giá trị L cộng hưởng liên tiếp để tính bước sóng và tốc độ âm.</li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n\r\n            </main>\r\n        </div>\r\n    );\r\n};\r\nexport default SoundSpeedExperiment;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10722, "column": 0}, "map": {"version":3,"sources":["file:///E:/test_python/vat-ly-11-lab/test/components/physics-lab.tsx"],"sourcesContent":["\"use client\"\n\nimport React, { useState, useEffect, useRef } from \"react\"\nimport Link from \"next/link\"\nimport {\n  FlaskConical,\n  Menu,\n  X,\n  Activity,\n  Waves,\n  Zap,\n  Anchor,\n  TrendingDown,\n  Mic,\n  Aperture,\n  Infinity,\n  Box,\n  PlusCircle,\n  Trash2,\n  Atom,\n  Terminal,\n  FileCode\n} from \"lucide-react\"\n\n// Import UI Library\nimport { LabLayout, NeonButton } from \"./ui/sci-fi-lab\"\n\n// Imports Experiments\nimport PhysicsIntro from \"./experiments/physics-intro\"\nimport SpringOscillator from \"./experiments/spring-oscillator\"\nimport SimplePendulum from \"./experiments/simple-pendulum\"\nimport DampedOscillation from \"./experiments/damped-oscillation\"\nimport HarmonicOscillation from \"./experiments/harmonic-oscillation\"\nimport MechanicalWaves from \"./experiments/mechanical-waves\"\nimport SoundWaves from \"./experiments/sound-waves\"\nimport WaveInterference from \"./experiments/wave-interference\"\nimport StandingWaves from \"./experiments/standing-waves\"\nimport SoundSpeedExperiment from \"./experiments/sound-speed\"\n// Tách mục Intro ra riêng để xử lý hiển thị đặc biệt\nconst INTRO_ITEM = { id: \"intro\", label: \"Giới thiệu chung\", icon: FlaskConical }\n\n// Danh sách các bài thí nghiệm (Không bao gồm Intro)\nconst EXPERIMENTS = [\n  { id: \"harmonic-oscillation\", label: \"Dao động điều hòa\", icon: Zap },\n  { id: \"spring-oscillator\", label: \"Con lắc lò xo\", icon: Activity },\n  { id: \"simple-pendulum\", label: \"Con lắc đơn\", icon: Anchor },\n  { id: \"damped-oscillation\", label: \"Dao động tắt dần\", icon: TrendingDown },\n  { id: \"mechanical-waves\", label: \"Sóng cơ\", icon: Waves },\n  { id: \"sound-waves\", label: \"Sóng âm\", icon: Mic },\n  { id: \"wave-interference\", label: \"Giao thoa sóng\", icon: Aperture },\n  { id: \"sound-speed\", label: \"Đo tốc độ truyền âm\", icon: Mic },\n  { id: \"standing-waves\", label: \"Sóng dừng\", icon: Infinity },\n]\n\nexport default function PhysicsLab() {\n  const [activeTab, setActiveTab] = useState(\"intro\")\n  const [isSidebarOpen, setIsSidebarOpen] = useState(false)\n  const [customModules, setCustomModules] = useState<any[]>([])\n  const mainContentRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    // Scroll handling\n    if (mainContentRef.current) {\n      mainContentRef.current.scrollTo({ top: 0, behavior: 'auto' })\n    }\n  }, [activeTab])\n\n  useEffect(() => {\n    // Fetch user modules\n    fetch('/api/modules')\n      .then(res => res.json())\n      .then(data => setCustomModules(data))\n      .catch(err => console.error(\"Failed to load modules\", err))\n  }, [])\n\n  const handleDeleteModule = async (e: React.MouseEvent, id: string) => {\n    e.stopPropagation()\n    if (!confirm(\"Bạn có chắc muốn xóa module này không?\")) return\n\n    try {\n      const res = await fetch('/api/modules', {\n        method: 'DELETE',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ id })\n      })\n      if (res.ok) {\n        setCustomModules(prev => prev.filter(m => m.id !== id))\n        if (activeTab === id) setActiveTab('intro')\n      } else {\n        alert(\"Xóa thất bại\")\n      }\n    } catch (err) {\n      console.error(\"Failed to delete\", err)\n      alert(\"Có lỗi xảy ra\")\n    }\n  }\n\n  const currentItem = activeTab === 'intro'\n    ? INTRO_ITEM\n    : EXPERIMENTS.find(e => e.id === activeTab) || customModules.find(m => m.id === activeTab)\n\n  const ActiveIcon = currentItem?.icon || (currentItem?.type === 'iframe' ? Box : FlaskConical)\n\n  const renderContent = () => {\n    // Check built-in experiments\n    switch (activeTab) {\n      case \"intro\": return <PhysicsIntro onSelectExperiment={setActiveTab} />\n      case \"spring-oscillator\": return <SpringOscillator />\n      case \"simple-pendulum\": return <SimplePendulum />\n      case \"damped-oscillation\": return <DampedOscillation />\n      case \"harmonic-oscillation\": return <HarmonicOscillation />\n      case \"mechanical-waves\": return <MechanicalWaves />\n      case \"sound-waves\": return <SoundWaves />\n      case \"wave-interference\": return <WaveInterference />\n      case \"standing-waves\": return <StandingWaves />\n      case \"sound-speed\": return <SoundSpeedExperiment />\n    }\n\n    // Check custom modules\n    const custom = customModules.find(m => m.id === activeTab)\n    if (custom) {\n      return (\n        <div className=\"w-full h-full bg-[#1e293b] rounded-xl overflow-hidden border border-slate-700 relative\">\n          <iframe\n            src={custom.path}\n            className=\"w-full h-full border-0\"\n            title={custom.label}\n            sandbox=\"allow-scripts allow-same-origin\"\n          />\n        </div>\n      )\n    }\n\n    return <PhysicsIntro onSelectExperiment={setActiveTab} />\n  }\n\n  return (\n    <LabLayout>\n      {/* HEADER BAR */}\n      <header className=\"flex items-center justify-between mb-6 pb-4 border-b border-slate-800/60 shrink-0\">\n        <div className=\"flex items-center gap-4\">\n          <NeonButton\n            onClick={() => setIsSidebarOpen(!isSidebarOpen)}\n            className=\"!px-3 !py-2\"\n          >\n            {isSidebarOpen ? <X size={20} /> : <Menu size={20} />}\n          </NeonButton>\n\n          <div className=\"flex flex-col\">\n            <h1 className=\"text-2xl md:text-3xl font-bold font-sans tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-600 uppercase\">\n              PHYSICS.LAB <span className=\"text-xs align-top opacity-50 text-slate-400\">v2.1</span>\n            </h1>\n            <div className=\"flex items-center gap-2 text-[10px] text-slate-500 font-ans font-bold uppercase tracking-widest\">\n              <span className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\"></span>\n              System Online\n            </div>\n          </div>\n        </div>\n\n        <div className=\"hidden md:flex items-center gap-6\">\n          <div className=\"text-right\">\n            <div className=\"text-cyan-400 font-sans font-bold flex items-center justify-end gap-2\">\n              {currentItem?.label || \"Unknown\"} <ActiveIcon size={16} />\n            </div>\n          </div>\n          <div className=\"w-[1px] h-8 bg-slate-800\"></div>\n          <div className=\"text-right\">\n            <div className=\"text-[10px] text-slate-500 uppercase font-bold\">Chủ dự án</div>\n            <div className=\"text-slate-300 font-sans font-bold text-cyan-500\">Hồ Hoàng Anh</div>\n          </div>\n        </div>\n      </header>\n\n      {/* MAIN BODY */}\n      <div className=\"flex flex-1 overflow-hidden gap-6 relative\">\n\n        {/* SIDEBAR NAVIGATION */}\n        <aside\n          className={`\n            fixed md:static inset-y-0 left-0 z-50 w-64 bg-[#02040a]/95 md:bg-transparent backdrop-blur-xl md:backdrop-blur-none border-r border-slate-800/50 md:border-none\n            transform transition-transform duration-300 ease-out flex flex-col gap-2 p-4 md:p-0\n            ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full md:hidden'}\n          `}\n        >\n          <div className=\"md:hidden flex justify-end mb-4\">\n            <button onClick={() => setIsSidebarOpen(false)} className=\"text-slate-500\"><X /></button>\n          </div>\n\n          {/* SECTION 1: GIỚI THIỆU CHUNG */}\n          <div className=\"mb-6 px-0\">\n            <button\n              onClick={() => {\n                setActiveTab(INTRO_ITEM.id);\n                if (window.innerWidth < 768) setIsSidebarOpen(false);\n              }}\n              className={`\n                  w-full text-left px-4 py-3 rounded border font-sans text-xs font-bold uppercase tracking-wide flex items-center gap-3 transition-all\n                  ${activeTab === INTRO_ITEM.id\n                  ? 'bg-cyan-950/40 border-cyan-500/50 text-cyan-400 shadow-[0_0_10px_rgba(6,182,212,0.1)]'\n                  : 'bg-transparent border-transparent text-slate-500 hover:bg-slate-900 hover:text-slate-300'}\n                `}\n            >\n              <INTRO_ITEM.icon size={16} className={activeTab === INTRO_ITEM.id ? \"animate-pulse\" : \"\"} />\n              {INTRO_ITEM.label}\n            </button>\n          </div>\n\n          {/* SECTION 2: DANH MỤC CƠ BẢN */}\n          <div className=\"text-xs font-bold text-slate-600 uppercase tracking-widest mb-2 px-2\">Danh mục thí nghiệm</div>\n          <div className=\"space-y-1 overflow-y-auto scrollbar-hide mb-4\">\n            {EXPERIMENTS.map((item) => (\n              <button\n                key={item.id}\n                onClick={() => {\n                  setActiveTab(item.id);\n                  if (window.innerWidth < 768) setIsSidebarOpen(false);\n                }}\n                className={`\n                  w-full text-left px-4 py-3 rounded border font-sans text-xs font-bold uppercase tracking-wide flex items-center gap-3 transition-all\n                  ${activeTab === item.id\n                    ? 'bg-cyan-950/40 border-cyan-500/50 text-cyan-400 shadow-[0_0_10px_rgba(6,182,212,0.1)]'\n                    : 'bg-transparent border-transparent text-slate-500 hover:bg-slate-900 hover:text-slate-300'}\n                `}\n              >\n                <item.icon size={16} className={activeTab === item.id ? \"animate-pulse\" : \"\"} />\n                {item.label}\n              </button>\n            ))}\n          </div>\n\n          {/* SECTION 3: USER MODULES */}\n\n\n          {/* CREATE NEW BUTTON */}\n          <div className=\"mt-auto pt-4 border-t border-slate-800/50 flex flex-col gap-3\">\n\n\n            <div className=\"p-3 rounded-lg bg-slate-900/40 border border-slate-800/60 text-center backdrop-blur-sm group hover:border-cyan-500/30 transition-colors\">\n              <div className=\"text-xs text-slate-400 font-medium mb-1 font-sans\">\n                Dev & Designer by : <span className=\"text-slate-200 font-bold\">Hồ Hoàng Anh</span>\n              </div>\n              <div className=\"text-[10px] text-cyan-400 font-sans font-bold mt-0.5\">Class: A1 - K50</div>\n            </div>\n\n            <div className=\"text-[10px] text-slate-600 text-center font-medium pb-2\">\n              2025 © <span className=\"text-slate-500 hover:text-cyan-500 cursor-pointer transition-colors\">Metronic Physics Theme</span>\n            </div>\n          </div>\n        </aside>\n\n        {/* CONTENT AREA */}\n        <main\n          ref={mainContentRef}\n          className=\"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-800 scrollbar-track-transparent pr-2 pb-10\"\n        >\n          {isSidebarOpen && <div className=\"fixed inset-0 bg-black/50 z-40 md:hidden\" onClick={() => setIsSidebarOpen(false)}></div>}\n\n          <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500 h-full\">\n            {renderContent()}\n          </div>\n        </main>\n      </div>\n    </LabLayout>\n  )\n}"],"names":[],"mappings":";;;;;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBA,oBAAoB;AACpB;AAEA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;;;;;;;;;;;;;;;AAsCA,qDAAqD;AACrD,MAAM,aAAa;IAAE,IAAI;IAAS,OAAO;IAAoB,MAAM,sOAAY;AAAC;AAEhF,qDAAqD;AACrD,MAAM,cAAc;IAClB;QAAE,IAAI;QAAwB,OAAO;QAAqB,MAAM,uMAAG;IAAC;IACpE;QAAE,IAAI;QAAqB,OAAO;QAAiB,MAAM,sNAAQ;IAAC;IAClE;QAAE,IAAI;QAAmB,OAAO;QAAe,MAAM,gNAAM;IAAC;IAC5D;QAAE,IAAI;QAAsB,OAAO;QAAoB,MAAM,sOAAY;IAAC;IAC1E;QAAE,IAAI;QAAoB,OAAO;QAAW,MAAM,6MAAK;IAAC;IACxD;QAAE,IAAI;QAAe,OAAO;QAAW,MAAM,uMAAG;IAAC;IACjD;QAAE,IAAI;QAAqB,OAAO;QAAkB,MAAM,sNAAQ;IAAC;IACnE;QAAE,IAAI;QAAe,OAAO;QAAuB,MAAM,uMAAG;IAAC;IAC7D;QAAE,IAAI;QAAkB,OAAO;QAAa,MAAM,sNAAQ;IAAC;CAC5D;AAEc,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IACnD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAQ,EAAE;IAC5D,MAAM,iBAAiB,IAAA,+MAAM,EAAiB;IAE9C,IAAA,kNAAS,EAAC;QACR,kBAAkB;QAClB,IAAI,eAAe,OAAO,EAAE;YAC1B,eAAe,OAAO,CAAC,QAAQ,CAAC;gBAAE,KAAK;gBAAG,UAAU;YAAO;QAC7D;IACF,GAAG;QAAC;KAAU;IAEd,IAAA,kNAAS,EAAC;QACR,qBAAqB;QACrB,MAAM,gBACH,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI,IACpB,IAAI,CAAC,CAAA,OAAQ,iBAAiB,OAC9B,KAAK,CAAC,CAAA,MAAO,QAAQ,KAAK,CAAC,0BAA0B;IAC1D,GAAG,EAAE;IAEL,MAAM,qBAAqB,OAAO,GAAqB;QACrD,EAAE,eAAe;QACjB,IAAI,CAAC,QAAQ,2CAA2C;QAExD,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,gBAAgB;gBACtC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAG;YAC5B;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,iBAAiB,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;gBACnD,IAAI,cAAc,IAAI,aAAa;YACrC,OAAO;gBACL,MAAM;YACR;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,oBAAoB;YAClC,MAAM;QACR;IACF;IAEA,MAAM,cAAc,cAAc,UAC9B,aACA,YAAY,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,cAAc,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IAElF,MAAM,aAAa,aAAa,QAAQ,CAAC,aAAa,SAAS,WAAW,uMAAG,GAAG,sOAAY;IAE5F,MAAM,gBAAgB;QACpB,6BAA6B;QAC7B,OAAQ;YACN,KAAK;gBAAS,qBAAO,8OAAC,yJAAY;oBAAC,oBAAoB;;;;;;YACvD,KAAK;gBAAqB,qBAAO,8OAAC,6JAAgB;;;;;YAClD,KAAK;gBAAmB,qBAAO,8OAAC,2JAAc;;;;;YAC9C,KAAK;gBAAsB,qBAAO,8OAAC,8JAAiB;;;;;YACpD,KAAK;gBAAwB,qBAAO,8OAAC,gKAAmB;;;;;YACxD,KAAK;gBAAoB,qBAAO,8OAAC,4JAAe;;;;;YAChD,KAAK;gBAAe,qBAAO,8OAAC,uJAAU;;;;;YACtC,KAAK;gBAAqB,qBAAO,8OAAC,6JAAgB;;;;;YAClD,KAAK;gBAAkB,qBAAO,8OAAC,0JAAa;;;;;YAC5C,KAAK;gBAAe,qBAAO,8OAAC,uJAAoB;;;;;QAClD;QAEA,uBAAuB;QACvB,MAAM,SAAS,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAChD,IAAI,QAAQ;YACV,qBACE,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBACC,KAAK,OAAO,IAAI;oBAChB,WAAU;oBACV,OAAO,OAAO,KAAK;oBACnB,SAAQ;;;;;;;;;;;QAIhB;QAEA,qBAAO,8OAAC,yJAAY;YAAC,oBAAoB;;;;;;IAC3C;IAEA,qBACE,8OAAC,kJAAS;;0BAER,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,mJAAU;gCACT,SAAS,IAAM,iBAAiB,CAAC;gCACjC,WAAU;0CAET,8BAAgB,8OAAC,iMAAC;oCAAC,MAAM;;;;;yDAAS,8OAAC,0MAAI;oCAAC,MAAM;;;;;;;;;;;0CAGjD,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;;4CAA+I;0DAC/I,8OAAC;gDAAK,WAAU;0DAA8C;;;;;;;;;;;;kDAE5E,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAK,WAAU;;;;;;4CAAyD;;;;;;;;;;;;;;;;;;;kCAM/E,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;;wCACZ,aAAa,SAAS;wCAAU;sDAAC,8OAAC;4CAAW,MAAM;;;;;;;;;;;;;;;;;0CAGxD,8OAAC;gCAAI,WAAU;;;;;;0CACf,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;kDAAiD;;;;;;kDAChE,8OAAC;wCAAI,WAAU;kDAAmD;;;;;;;;;;;;;;;;;;;;;;;;0BAMxE,8OAAC;gBAAI,WAAU;;kCAGb,8OAAC;wBACC,WAAW,CAAC;;;YAGV,EAAE,gBAAgB,kBAAkB,8BAA8B;UACpE,CAAC;;0CAED,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAO,SAAS,IAAM,iBAAiB;oCAAQ,WAAU;8CAAiB,cAAA,8OAAC,iMAAC;;;;;;;;;;;;;;;0CAI/E,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCACC,SAAS;wCACP,aAAa,WAAW,EAAE;wCAC1B,IAAI,OAAO,UAAU,GAAG,KAAK,iBAAiB;oCAChD;oCACA,WAAW,CAAC;;kBAER,EAAE,cAAc,WAAW,EAAE,GAC3B,0FACA,2FAA2F;gBAC/F,CAAC;;sDAEH,8OAAC,WAAW,IAAI;4CAAC,MAAM;4CAAI,WAAW,cAAc,WAAW,EAAE,GAAG,kBAAkB;;;;;;wCACrF,WAAW,KAAK;;;;;;;;;;;;0CAKrB,8OAAC;gCAAI,WAAU;0CAAuE;;;;;;0CACtF,8OAAC;gCAAI,WAAU;0CACZ,YAAY,GAAG,CAAC,CAAC,qBAChB,8OAAC;wCAEC,SAAS;4CACP,aAAa,KAAK,EAAE;4CACpB,IAAI,OAAO,UAAU,GAAG,KAAK,iBAAiB;wCAChD;wCACA,WAAW,CAAC;;kBAEV,EAAE,cAAc,KAAK,EAAE,GACnB,0FACA,2FAA2F;gBACjG,CAAC;;0DAED,8OAAC,KAAK,IAAI;gDAAC,MAAM;gDAAI,WAAW,cAAc,KAAK,EAAE,GAAG,kBAAkB;;;;;;4CACzE,KAAK,KAAK;;uCAbN,KAAK,EAAE;;;;;;;;;;0CAsBlB,8OAAC;gCAAI,WAAU;;kDAGb,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAI,WAAU;;oDAAoD;kEAC7C,8OAAC;wDAAK,WAAU;kEAA2B;;;;;;;;;;;;0DAEjE,8OAAC;gDAAI,WAAU;0DAAuD;;;;;;;;;;;;kDAGxE,8OAAC;wCAAI,WAAU;;4CAA0D;0DAChE,8OAAC;gDAAK,WAAU;0DAAsE;;;;;;;;;;;;;;;;;;;;;;;;kCAMnG,8OAAC;wBACC,KAAK;wBACL,WAAU;;4BAET,+BAAiB,8OAAC;gCAAI,WAAU;gCAA2C,SAAS,IAAM,iBAAiB;;;;;;0CAE5G,8OAAC;gCAAI,WAAU;0CACZ;;;;;;;;;;;;;;;;;;;;;;;;AAMb"}}]
}